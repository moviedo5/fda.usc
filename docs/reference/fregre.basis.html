<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Functional Regression with scalar response using basis representation. — fregre.basis • fda.usc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functional Regression with scalar response using basis representation. — fregre.basis"><meta name="description" content="Computes functional regression between functional explanatory variable
\(X(t)\) and scalar response \(Y\) using basis representation."><meta property="og:description" content="Computes functional regression between functional explanatory variable
\(X(t)\) and scalar response \(Y\) using basis representation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fda.usc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/moviedo5/fda.usc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Functional Regression with scalar response using basis representation.</h1>
      <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/fregre.basis.R" class="external-link"><code>R/fregre.basis.R</code></a></small>
      <div class="d-none name"><code>fregre.basis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes functional regression between functional explanatory variable
\(X(t)\) and scalar response \(Y\) using basis representation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fregre.basis</span><span class="op">(</span></span>
<span>  <span class="va">fdataobj</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  basis.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basis.b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Lfdobj <span class="op">=</span> <span class="fu">vec2Lfd</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">rtt</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fdataobj">fdataobj<a class="anchor" aria-label="anchor" href="#arg-fdataobj"></a></dt>
<dd><p><code><a href="fdata.html">fdata</a></code> class object.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Scalar response with length <code>n</code>.</p></dd>


<dt id="arg-basis-x">basis.x<a class="anchor" aria-label="anchor" href="#arg-basis-x"></a></dt>
<dd><p>Basis for functional explanatory data <code>fdataobj</code>.</p></dd>


<dt id="arg-basis-b">basis.b<a class="anchor" aria-label="anchor" href="#arg-basis-b"></a></dt>
<dd><p>Basis for functional beta parameter.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A roughness penalty. By default, no penalty <code>lambda=0</code>.</p></dd>


<dt id="arg-lfdobj">Lfdobj<a class="anchor" aria-label="anchor" href="#arg-lfdobj"></a></dt>
<dd><p>See <a href="https://rdrr.io/pkg/fda/man/eval.penalty.html" class="external-link">eval.penalty</a>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>weights</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Return:</p><ul><li><p><code>call</code>: The matched call.</p></li>
<li><p><code>coefficients</code>: A named vector of coefficients.</p></li>
<li><p><code>residuals</code>: <code>y</code> minus <code>fitted values</code>.</p></li>
<li><p><code>fitted.values</code>: Estimated scalar response.</p></li>
<li><p><code>beta.est</code>: Estimated beta parameter of class <code>fd</code>.</p></li>
<li><p><code>weights</code>: (only for weighted fits) the specified weights.</p></li>
<li><p><code>df.residual</code>: The residual degrees of freedom.</p></li>
<li><p><code>r2</code>: Coefficient of determination.</p></li>
<li><p><code>sr2</code>: Residual variance.</p></li>
<li><p><code>Vp</code>: Estimated covariance matrix for the parameters.</p></li>
<li><p><code>H</code>: Hat matrix.</p></li>
<li><p><code>y</code>: Response.</p></li>
<li><p><code>fdataobj</code>: Functional explanatory data of class <code>fdata</code>.</p></li>
<li><p><code>a.est</code>: Intercept parameter estimated.</p></li>
<li><p><code>x.fd</code>: Centered functional explanatory data of class <code>fd</code>.</p></li>
<li><p><code>basis.b</code>: Basis used for beta parameter estimation.</p></li>
<li><p><code>lambda.opt</code>: A roughness penalty.</p></li>
<li><p><code>Lfdobj</code>: Order of a derivative or a linear differential operator.</p></li>
<li><p><code>P</code>: Penalty matrix.</p></li>
<li><p><code>lm</code>: Return <code>lm</code> object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>$$Y=\big&lt;X,\beta\big&gt;+\epsilon=\int_{T}{X(t)\beta(t)dt+\epsilon}$$
where \( \big&lt; \cdot , \cdot \big&gt;\) denotes the inner product on
\(L_2\) and \(\epsilon\) are random errors with mean zero, finite
variance \(\sigma^2\) and \(E[X(t)\epsilon]=0\).</p>
<p>The function uses the basis representation proposed by Ramsay and Silverman (2005) to model the
relationship between the scalar response and the functional covariate by
basis representation of the observed functional data
\(X(t)\approx\sum_{k=1}^{k_{n1}} c_k \xi_k(t)\) and the unknown
functional parameter \(\beta(t)\approx\sum_{k=1}^{k_{n2}} b_k
\phi_k(t)\). <br></p>
<p>The functional linear models estimated by the expression: $$\hat{y}=
\big&lt; X,\hat{\beta} \big&gt; =
C^{T}\psi(t)\phi^{T}(t)\hat{b}=\tilde{X}\hat{b}$$ where
\(\tilde{X}(t)=C^{T}\psi(t)\phi^{T}(t)\), and
\(\hat{b}=(\tilde{X}^{T}\tilde{X})^{-1}\tilde{X}^{T}y\)
and so,
\(\hat{y}=\tilde{X}\hat{b}=\tilde{X}(\tilde{X}^{T}\tilde{X})^{-1}\tilde{X}^{T}y=Hy\)
where \(H\) is the hat matrix with degrees of freedom: \(df=tr(H)\).<br></p>
<p>If \(\lambda&gt;0\) then <code>fregre.basis</code> incorporates a
roughness penalty: <br>
\(\hat{y}=\tilde{X}\hat{b}=\tilde{X}(\tilde{X}^{T}\tilde{X}+\lambda
R_0)^{-1}\tilde{X}^{T}y= H_{\lambda}y\) where \(R_0\) is the penalty matrix.<br></p>
<p>This function allows covariates of class <code>fdata</code>, <code>matrix</code>,
<code>data.frame</code> or directly covariates of class <code>fd</code>.  The function
also gives default values to arguments <code>basis.x</code> and <code>basis.b</code> for
representation on the basis of functional data \(X(t)\) and the functional
parameter \(\beta(t)\), respectively.</p>
<p>If <code>basis=</code><code>NULL</code> creates the <code>bspline</code> basis by
<a href="https://rdrr.io/pkg/fda/man/create.bspline.basis.html" class="external-link">create.bspline.basis</a>. <br> If the functional covariate
<code>fdataobj</code> is a matrix or data.frame, it creates an object of class
"fdata" with default attributes, see <code><a href="fdata.html">fdata</a></code>.<br> If
<code>basis.x$type=``fourier''</code> and <code>basis.b$type=``fourier''</code>, the
basis are orthonormal and the function decreases the number of fourier basis
elements on the \(min(k_{n1},k_{n2})\), where
\(k_{n1}\) and \(k_{n2}\) are the number of basis element of
<code>basis.x</code> and <code>basis.b</code> respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>
Functional Data Analysis</em>, 2nd ed., Springer, New York.</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/" class="external-link">https://www.jstatsoft.org/v51/i04/</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See Also as: <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code>,
<code><a href="summary.fregre.fd.html">summary.fregre.fd</a></code> and <code><a href="predict.fregre.fd.html">predict.fregre.fd</a></code>.<br>
Alternative method: <code><a href="fregre.pc.html">fregre.pc</a></code> and <code><a href="fregre.np.html">fregre.np</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># fregre.basis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">absorp</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">129</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">=</span><span class="va">absorp</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tt</span><span class="op">=</span><span class="va">absorp</span><span class="op">[[</span><span class="st">"argvals"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">basis1</span><span class="op">=</span><span class="fu">create.bspline.basis</span><span class="op">(</span>rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>,nbasis<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">basis2</span><span class="op">=</span><span class="fu">create.bspline.basis</span><span class="op">(</span>rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>,nbasis<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res5</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">basis1</span>,<span class="va">basis2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.d2</span><span class="op">=</span><span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span>,nbasis<span class="op">=</span><span class="fl">19</span>,nderiv<span class="op">=</span><span class="fl">1</span>,method<span class="op">=</span><span class="st">"bspline"</span>,class.out<span class="op">=</span><span class="st">"fdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res7</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x.d2</span>,<span class="va">y</span>,<span class="va">basis1</span>,<span class="va">basis2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

