<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test • fda.usc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test"><meta name="description" content="The function flm.test tests the composite null hypothesis of
a Functional Linear Model with scalar response (FLM),
$$H_0:\,Y=\big&amp;lt;X,\beta\big&amp;gt;+\epsilon,$$  versus
a general alternative. If \(\beta=\beta_0\) is provided, then the
simple hypothesis \(H_0:\,Y=\big&amp;lt;X,\beta_0\big&amp;gt;+\epsilon\) is tested.
The testing of the null hypothesis is done by a Projected Cramer-von Mises statistic (see Details)."><meta property="og:description" content="The function flm.test tests the composite null hypothesis of
a Functional Linear Model with scalar response (FLM),
$$H_0:\,Y=\big&amp;lt;X,\beta\big&amp;gt;+\epsilon,$$  versus
a general alternative. If \(\beta=\beta_0\) is provided, then the
simple hypothesis \(H_0:\,Y=\big&amp;lt;X,\beta_0\big&amp;gt;+\epsilon\) is tested.
The testing of the null hypothesis is done by a Projected Cramer-von Mises statistic (see Details)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fda.usc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/moviedo5/fda.usc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Goodness-of-fit test for the Functional Linear Model with scalar response</h1>
      <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/flm.test.R" class="external-link"><code>R/flm.test.R</code></a></small>
      <div class="d-none name"><code>flm.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>flm.test</code> tests the composite null hypothesis of
a Functional Linear Model with scalar response (FLM),
$$H_0:\,Y=\big&lt;X,\beta\big&gt;+\epsilon,$$  versus
a general alternative. If \(\beta=\beta_0\) is provided, then the
simple hypothesis \(H_0:\,Y=\big&lt;X,\beta_0\big&gt;+\epsilon\) is tested.
The testing of the null hypothesis is done by a Projected Cramer-von Mises statistic (see Details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flm.test</span><span class="op">(</span></span>
<span>  <span class="va">X.fdata</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  beta0.fdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  est.method <span class="op">=</span> <span class="st">"pls"</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.basis <span class="op">=</span> <span class="st">"bspline"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.it <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B.plot <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  G <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-fdata">X.fdata<a class="anchor" aria-label="anchor" href="#arg-x-fdata"></a></dt>
<dd><p>Functional covariate for the FLM. The object must be in the class
<code><a href="fdata.html">fdata</a></code>.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Scalar response for the FLM. Must be a vector with the same number of elements
as functions are in <code>X.fdata</code>.</p></dd>


<dt id="arg-beta-fdata">beta0.fdata<a class="anchor" aria-label="anchor" href="#arg-beta-fdata"></a></dt>
<dd><p>Functional parameter for the simple null hypothesis, in the <code><a href="fdata.html">fdata</a></code> class.
Recall that the <code>argvals</code> and <code>rangeval</code> arguments of <code>beta0.fdata</code> must be the same
of <code>X.fdata</code>. A possibility to do this is to consider, for example for \(\beta_0=0\)
(the simple null hypothesis of no interaction),
 <code>beta0.fdata=fdata(mdata=rep(0,length(X.fdata$argvals)),</code><code>argvals=X.fdata$argvals,rangeval=X.fdata$rangeval)</code>.
 If <code>beta0.fdata=NULL</code> (default), the function will test for the composite null hypothesis.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Number of bootstrap replicates to calibrate the distribution of the test statistic.
<code>B=5000</code> replicates are the recommended for carry out the test, although for exploratory analysis
 (<b>not inferential</b>), an acceptable less time-consuming option is <code>B=500</code>.</p></dd>


<dt id="arg-est-method">est.method<a class="anchor" aria-label="anchor" href="#arg-est-method"></a></dt>
<dd><p>Estimation method for the unknown parameter \(\beta\),
only used in the composite case. Mainly, there are two options: specify the number of basis
elements for the estimated \(\beta\) by <code>p</code> or optimally select <code>p</code> by a
data-driven criteria (see Details section for discussion). Then, it must be one of the following
methods:</p><ul><li><p><code>"pc"</code>: If <code>p</code>, the number of basis elements, is given, then \(\beta\) is estimated by <code><a href="fregre.pc.html">fregre.pc</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code> and the <code>"SICc"</code> criteria.</p></li>
<li><p><code>"pls"</code>: If <code>p</code> is given, \(\beta\) is estimated by <code><a href="fregre.pls.html">fregre.pls</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code> and the <code>"SICc"</code> criteria.
 This is the default argument as it has been checked empirically that provides a good balance between the performance of the test and the estimation of \(\beta\).</p></li>
<li><p><code>"basis"</code>: If <code>p</code> is given, \(\beta\) is estimated by <code><a href="fregre.basis.html">fregre.basis</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code> and the <code>"GCV.S"</code> criteria. In these functions, the same basis for the arguments <code>basis.x</code> and <code>basis.b</code> is considered.
 The type of basis used will be the given by the argument <code>type.basis</code> and must be one of the class of <code>create.basis</code>. Further arguments passed to <code>create.basis</code> (not <code>rangeval</code> that is taken as the <code>rangeval</code> of <code>X.fdata</code>), can be passed throughout <code>...</code>.</p></li>
</ul></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Number of elements of the basis considered. If it is not given, an optimal <code>p</code> will be chosen using a specific criteria (see <code>est.method</code> and <code>type.basis</code> arguments).</p></dd>


<dt id="arg-type-basis">type.basis<a class="anchor" aria-label="anchor" href="#arg-type-basis"></a></dt>
<dd><p>Type of basis used to represent the functional process. Depending on the hypothesis, it will have a different interpretation:</p><ul><li><p>Simple hypothesis. One of these options:</p><ul><li><p><code>"bspline"</code>: If <code>p</code> is given, the functional process is expressed in a basis of <code>p</code> B-splines. If not, an optimal <code>p</code> will be chosen by <code><a href="optim.basis.html">optim.basis</a></code>, using the <code>"GCV.S"</code> criteria.</p></li>
<li><p><code>"fourier"</code>: If <code>p</code> is given, the functional process is expressed in a basis of <code>p</code> Fourier functions. If not, an optimal <code>p</code> will be chosen by <code><a href="optim.basis.html">optim.basis</a></code>, using the <code>"GCV.S"</code> criteria.</p></li>
<li><p><code>"pc"</code>: <code>p</code> must be given. Expresses the functional process in a basis of <code>p</code> principal components.</p></li>
<li><p><code>"pls"</code>: <code>p</code> must be given. Expresses the functional process in a basis of <code>p</code> partial least squares.</p></li>
</ul><p>Although other basis types supported by <code>create.basis</code> are possible,<br><code>"bspline"</code> and <code>"fourier"</code> are recommended. Other basis types may cause incompatibilities.</p></li>
<li><p>Composite hypothesis. This argument is only used when <code>est.method="basis"</code> and, in this case, it specifies the type of basis used in the basis estimation method of the functional parameter. Again, basis
 <code>"bspline"</code> and <code>"fourier"</code> are recommended, as other basis types may cause incompatibilities.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Either to show or not information about computing progress.</p></dd>


<dt id="arg-plot-it">plot.it<a class="anchor" aria-label="anchor" href="#arg-plot-it"></a></dt>
<dd><p>Either to show or not a graph of the observed trajectory,
and the bootstrap trajectories under the null composite hypothesis, of the
process \(R_n(\cdot)\) (see Details). Note that if <code>plot.it=TRUE</code>,
the function takes more time to run.</p></dd>


<dt id="arg-b-plot">B.plot<a class="anchor" aria-label="anchor" href="#arg-b-plot"></a></dt>
<dd><p>Number of bootstrap trajectories to show in the resulting plot of the test.
As the trajectories shown are the first <code>B.plot</code> of <code>B</code>, <code>B.plot</code> must be
lower or equal to <code>B</code>.</p></dd>


<dt id="arg-g">G<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>Number of projections used to compute the trajectories of the process
\(R_n(\cdot)\) by Monte Carlo.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to <code>create.basis</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object with class <code>"htest"</code> whose underlying structure is a list containing
the following components:</p><ul><li><p><code>statistic</code>: The value of the test statistic.</p></li>
<li><p><code>boot.statistics</code>: A vector of length <code>B</code> with the values of the bootstrap test statistics.</p></li>
<li><p><code>p.value</code>: The p-value of the test.</p></li>
<li><p><code>method</code>: The method used.</p></li>
<li><p><code>B</code>: The number of bootstrap replicates used.</p></li>
<li><p><code>type.basis</code>: The type of basis used.</p></li>
<li><p><code>beta.est</code>: The estimated functional parameter \(\beta\) in the composite
 hypothesis. For the simple hypothesis, the given <code>beta0.fdata</code>.</p></li>
<li><p><code>p</code>: The number of basis elements passed or automatically chosen.</p></li>
<li><p><code>ord</code>: The optimal order for PC and PLS given by <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code> and  <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code>. For other methods, it is set to <code>1:p</code>.</p></li>
<li><p><code>data.name</code>: The character string "Y=&lt;X,b&gt;+e".</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Functional Linear Model with scalar response (FLM), is defined as
\(Y=\big&lt;X,\beta\big&gt;+\epsilon\), for a functional process
\(X\) such that \(E[X(t)]=0\), \(E[X(t)\epsilon]=0\)
 for all \(t\) and for a scalar variable \(Y\) such that \(E[Y]=0\).
 Then, the test assumes that <code>Y</code> and <code>X.fdata</code> are <b>centred</b> and will automatically
 center them. So, bear in mind that when you apply the test for <code>Y</code> and <code>X.fdata</code>,
 actually,  you are applying it to <code>Y-mean(Y)</code> and <code>fdata.cen(X.fdata)$Xcen</code>.
 The test statistic corresponds to the Cramer-von Mises norm of the <em>Residual Marked
 empirical Process based on Projections</em> \(R_n(u,\gamma)\) defined in
 Garcia-Portugues <em>et al.</em> (2014).
 The expression of this process in a \(p\)-truncated basis of the space \(L^2[0,T]\)
 leads to the \(p\)-multivariate process \(R_{n,p}\big(u,\gamma^{(p)}\big)\),
 whose Cramer-von Mises norm is computed.
 The choice of an appropriate \(p\) to represent the functional process \(X\),
 in case that is not provided, is done via the estimation of \(\beta\) for the composite
 hypothesis. For the simple hypothesis, as no estimation of \(\beta\) is done, the choice
 of \(p\) depends only on the functional process \(X\). As the result of the test may
 change for different \(p\)'s, we recommend to use an automatic criterion to select \(p\)
 instead of provide a fixed one.
 The distribution of the test statistic is approximated by a wild bootstrap resampling on the
 residuals, using the <em>golden section bootstrap</em>.
 Finally, the graph shown if <code>plot.it=TRUE</code> represents the observed trajectory, and the
 bootstrap trajectories under the null, of the process RMPP <em>integrated on the projections</em>:
 $$R_n(u)\approx\frac{1}{G}\sum_{g=1}^G R_n(u,\gamma_g),$$
  where \(\gamma_g\) are simulated as Gaussians processes. This gives a graphical idea of
   how <em>distant</em> is the observed trajectory from the null hypothesis.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>No NA's are allowed neither in the functional covariate nor in the scalar response.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Escanciano, J. C. (2006). A consistent diagnostic test for regression models using projections. Econometric Theory, 22, 1030-1051. <a href="https://doi.org/10.1017/S0266466606060506" class="external-link">doi:10.1017/S0266466606060506</a></p>
<p>Garcia-Portugues, E., Gonzalez-Manteiga, W. and Febrero-Bande, M. (2014). A goodness–of–fit test for the functional linear model with scalar response. Journal of Computational and Graphical Statistics, 23(3), 761-778. <a href="https://doi.org/10.1080/10618600.2013.812519" class="external-link">doi:10.1080/10618600.2013.812519</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PCvM.statistic.html">Adot</a></code>, <code><a href="PCvM.statistic.html">PCvM.statistic</a></code>, <code><a href="rwild.html">rwild</a></code>,
 <code><a href="flm.Ftest.html">flm.Ftest</a></code>, <code><a href="dfv.test.html">dfv.test</a></code>,
 <code><a href="fregre.pc.html">fregre.pc</a></code>, <code><a href="fregre.pls.html">fregre.pls</a></code>, <code><a href="fregre.basis.html">fregre.basis</a></code>,
 <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code>, <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code>,
 <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code>, <code><a href="optim.basis.html">optim.basis</a></code>,
 <a href="https://rdrr.io/pkg/fda/man/create.basis.html" class="external-link">create.basis</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eduardo Garcia-Portugues. Please, report bugs and suggestions to
 <a href="mailto:edgarcia@est-econ.uc3m.es">edgarcia@est-econ.uc3m.es</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulated example #</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">=</span><span class="fu"><a href="rproc2fdata.html">rproc2fdata</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span>,sigma<span class="op">=</span><span class="st">"OU"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta0</span><span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">101</span>,sd<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>,argvals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span>,rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="inprod.fdata.html">inprod.fdata</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">beta0</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">21</span>,height<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>,main<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta0</span>,main<span class="op">=</span><span class="st">"beta0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Density of Y"</span>,xlab<span class="op">=</span><span class="st">"Y"</span>,ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Composite hypothesis: do not reject FLM</span></span></span>
<span class="r-in"><span><span class="va">pcvm.sim</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,B<span class="op">=</span><span class="fl">50</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span>,plot.it<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.sim</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Estimated beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcvm.sim</span><span class="op">$</span><span class="va">beta.est</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: do not reject beta=beta0</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,beta0.fdata<span class="op">=</span><span class="va">beta0</span>,B<span class="op">=</span><span class="fl">50</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,beta0.fdata<span class="op">=</span><span class="va">beta0</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AEMET dataset #</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Remove the 5\</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.FM</span><span class="op">=</span><span class="fu"><a href="depth.fdata.html">depth.FM</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span>,draw<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qu</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">res.FM</span><span class="op">$</span><span class="va">dep</span>,prob<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">res.FM</span><span class="op">$</span><span class="va">dep</span><span class="op">&lt;=</span><span class="va">qu</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aemet</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data without outliers </span></span></span>
<span class="r-in"><span><span class="va">wind.speed</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">wind.speed</span><span class="op">$</span><span class="va">data</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">temp</span><span class="op">=</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span><span class="op">[</span><span class="op">-</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Exploratory analysis: accept the FLM</span></span></span>
<span class="r-in"><span><span class="va">pcvm.aemet</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>,est.method<span class="op">=</span><span class="st">"pls"</span>,B<span class="op">=</span><span class="fl">100</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.aemet</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimated beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcvm.aemet</span><span class="op">$</span><span class="va">beta.est</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># B=5000 for more precision on calibration of the test: also accept the FLM</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>,est.method<span class="op">=</span><span class="st">"pls"</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: rejection of beta0=0? Limiting p-value...</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>, beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                                            rangeval<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>, beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                                            rangeval<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                                            </span></span>
<span class="r-in"><span><span class="co"># Tecator dataset #</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">absorp</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">129</span> <span class="co"># or ind=1:215</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">=</span><span class="va">absorp</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tt</span><span class="op">=</span><span class="va">absorp</span><span class="op">[[</span><span class="st">"argvals"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exploratory analysis for composite hypothesis with automatic choose of p</span></span></span>
<span class="r-in"><span><span class="va">pcvm.tecat</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,B<span class="op">=</span><span class="fl">100</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.tecat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># B=5000 for more precision on calibration of the test: also reject the FLM</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Distribution of the PCvM statistic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">boot.statistics</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              main<span class="op">=</span><span class="st">"PCvM distribution"</span>, xlab<span class="op">=</span><span class="st">"PCvM*"</span>,ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">boot.statistics</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">statistic</span>,col<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"top"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCvM observed"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: fixed p</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span>,p<span class="op">=</span><span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span>                               </span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis, automatic choose of p</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

