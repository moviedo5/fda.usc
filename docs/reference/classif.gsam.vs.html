<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Variable Selection in Functional Data Classification — classif.gsam.vs • fda.usc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variable Selection in Functional Data Classification — classif.gsam.vs"><meta name="description" content="Computes classification by selecting the functional (and non functional)
explanatory variables."><meta property="og:description" content="Computes classification by selecting the functional (and non functional)
explanatory variables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fda.usc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/moviedo5/fda.usc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Variable Selection in Functional Data Classification</h1>
      <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/classif.gsam.vs.R" class="external-link"><code>R/classif.gsam.vs.R</code></a></small>
      <div class="d-none name"><code>classif.gsam.vs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes classification by selecting the functional (and non functional)
explanatory variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">classif.gsam.vs</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"equal"</span>,</span>
<span>  basis.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basis.b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"1vsall"</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  dcor.min <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  measure <span class="op">=</span> <span class="st">"accuracy"</span>,</span>
<span>  <span class="va">xydist</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>List that containing the variables in the model.  "df" element
is a  <code>data.frame</code> with the response and scalar covariates (numeric and factors
variables are allowed). Functional covariates of class <code>fdata</code> or
<code>fd</code> are introduced in the following items in the <code>data</code> list.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code>caracter</code> string with the name of the scalar response variable</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>caracter</code> string vector with the name of the scalar and functional
potential covariates.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details of family functions.)</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Weights:</p><ul><li><p>if <code>character</code> string <code>='equal'</code> same weights for each observation (by default) and
<code>='inverse'</code> for inverse-probability of weighting.</p></li>
<li><p>if <code>numeric</code> vector of length <code>n</code>, Weight values of each observation.</p></li>
</ul></dd>


<dt id="arg-basis-x">basis.x<a class="anchor" aria-label="anchor" href="#arg-basis-x"></a></dt>
<dd><p>List of basis for functional explanatory data estimation.</p></dd>


<dt id="arg-basis-b">basis.b<a class="anchor" aria-label="anchor" href="#arg-basis-b"></a></dt>
<dd><p>List of basis for functional beta parameter estimation.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>character</code>, type of scheme classification. <code>'1vsall'</code>  (by default)
strategy involves training a single classifier per class, with the samples of that class
as positive samples and all other samples as negatives. Other posibility for K-way multiclass problem
is the <code>'majority'</code> voting scheme (also called one vs one).
The procedure  trains the \(K (K - 1) / 2\)  binary classifiers and predicts the final class label as the class
label that has been predicted most frequently.</p></dd>


<dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd><p>probability value used for binary discriminant.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>alpha value to test the null hypothesis for the test of
independence among covariate X and residual e. By default is <code>0.05</code>.</p></dd>


<dt id="arg-dcor-min">dcor.min<a class="anchor" aria-label="anchor" href="#arg-dcor-min"></a></dt>
<dd><p>lower threshold for the variable X to be considered. X is
discarded if the distance correlation \(R(X,e)&lt; dcor.min\) (e is the
residual).</p></dd>


<dt id="arg-smooth">smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p>if <code>TRUE</code>, a smooth estimate is made for all covariates included
in the model (less for factors). The model is adjusted with the estimated
variable linearly or smoothly. If the models are equivalent, the model is
adjusted with the linearly estimated variable.</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>measure related with correct classification (by default accuracy).</p></dd>


<dt id="arg-xydist">xydist<a class="anchor" aria-label="anchor" href="#arg-xydist"></a></dt>
<dd><p>list with the matrices of distances of each variable (all
potential covariates and the response) with itself.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Return the final fitted model (same result of the classsification method) plus:<br></p><ul><li><p><code>dcor</code>, <code>matrix</code> with the values of distance correlation for each
pontential covariate  (by column) and the residual of the model in each step (by row).</p></li>
<li><p><code>i.predictor</code>, <code>vector</code> with 1 if the variable is selected, 0 otherwise.</p></li>
<li><p><code>ipredictor</code>, <code>vector</code> with the name of selected variables (in order of selection)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Adapted version from the original method in repression: <code><a href="fregre.gsam.vs.html">fregre.gsam.vs</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Febrero-Bande, M., Gonz\'alez-Manteiga, W. and Oviedo de la
Fuente, M. Variable selection in functional additive regression models,
(2018).  Computational Statistics, 1-19. DOI:
<a href="https://doi.org/10.1007/s00180-018-0844-5" class="external-link">doi:10.1007/s00180-018-0844-5</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See Also as:  <code><a href="classif.gsam.html">classif.gsam</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Febrero-Bande, M. and Oviedo de la Fuente, M.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span>,nderiv<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">&lt;</span><span class="fl">12</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Protein</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Water</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">129</span></span></span>
<span class="r-in"><span><span class="va">dat</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Fat"</span><span class="op">=</span><span class="va">y</span>, <span class="va">x1</span><span class="op">$</span><span class="va">data</span>, <span class="va">xcat1</span>, <span class="va">xcat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="ldata.html">ldata</a></span><span class="op">(</span><span class="st">"df"</span><span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x"</span><span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x1"</span><span class="op">=</span><span class="va">x1</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x2"</span><span class="op">=</span><span class="va">x2</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 3 functionals (x,x1,x2), 3 factors (xcat0, xcat1, xcat2)</span></span></span>
<span class="r-in"><span><span class="co"># and 100 scalars (impact poitns of x1) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="classif.gsam.html">classif.gsam</a></span><span class="op">(</span><span class="va">Fat</span><span class="op">~</span><span class="fu">s</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,data<span class="op">=</span><span class="va">ldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.gam</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Time consuming</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span> <span class="op">&lt;-</span> <span class="fu">classif.gsam.vs</span><span class="op">(</span><span class="st">"Fat"</span>,data<span class="op">=</span><span class="va">ldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.gam.vs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span><span class="op">$</span><span class="va">i.predictor</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span><span class="op">$</span><span class="va">ipredictor</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prediction </span></span></span>
<span class="r-in"><span><span class="va">newldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="ldata.html">ldata</a></span><span class="op">(</span><span class="st">"df"</span><span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x"</span><span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>                <span class="st">"x1"</span><span class="op">=</span><span class="va">x1</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x2"</span><span class="op">=</span><span class="va">x2</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.gam</span>,<span class="va">newldat</span><span class="op">)</span>                </span></span>
<span class="r-in"><span><span class="va">pred.gam.vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.gam.vs</span>,<span class="va">newldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="accuracy.html">cat2meas</a></span><span class="op">(</span><span class="va">newldat</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">Fat</span>, <span class="va">pred.gam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="accuracy.html">cat2meas</a></span><span class="op">(</span><span class="va">newldat</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">Fat</span>, <span class="va">pred.gam.vs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

