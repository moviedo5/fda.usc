<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Proximities between functional data (semi-metrics) — semimetric.NPFDA • fda.usc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Proximities between functional data (semi-metrics) — semimetric.NPFDA"><meta name="description" content="Computes semi-metric distances of functional data based on Ferraty F and
Vieu, P. (2006)."><meta property="og:description" content="Computes semi-metric distances of functional data based on Ferraty F and
Vieu, P. (2006)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fda.usc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/moviedo5/fda.usc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Proximities between functional data (semi-metrics)</h1>
      <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/semimetric.NPFDA.r" class="external-link"><code>R/semimetric.NPFDA.r</code></a></small>
      <div class="d-none name"><code>semimetric.NPFDA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes semi-metric distances of functional data based on Ferraty F and
Vieu, P. (2006).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">semimetric.deriv</span><span class="op">(</span></span>
<span>  <span class="va">fdata1</span>,</span>
<span>  fdata2 <span class="op">=</span> <span class="va">fdata1</span>,</span>
<span>  nderiv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nknot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.fourier</span><span class="op">(</span></span>
<span>  <span class="va">fdata1</span>,</span>
<span>  fdata2 <span class="op">=</span> <span class="va">fdata1</span>,</span>
<span>  nderiv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  nbasis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.hshift</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.mplsr</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, q <span class="op">=</span> <span class="fl">2</span>, <span class="va">class1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, q <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p><a href="https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/" class="external-link">https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/</a></p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fdata-">fdata1<a class="anchor" aria-label="anchor" href="#arg-fdata-"></a></dt>
<dd><p>Functional data 1 or curve 1. <code>DATA1</code> with dimension
(<code>n1</code> x <code>m</code>), where <code>n1</code> is the number of curves and <code>m</code>
are the points observed in each curve.</p></dd>


<dt id="arg-fdata-">fdata2<a class="anchor" aria-label="anchor" href="#arg-fdata-"></a></dt>
<dd><p>Functional data 2 or curve 2. <code>DATA1</code> with dimension
(<code>n2</code> x <code>m</code>), where <code>n2</code> is the number of curves and <code>m</code>
are the points observed in each curve.</p></dd>


<dt id="arg-nderiv">nderiv<a class="anchor" aria-label="anchor" href="#arg-nderiv"></a></dt>
<dd><p>Order of derivation, used in <code>semimetric.deriv</code> and <br><code>semimetric.fourier</code></p></dd>


<dt id="arg-nknot">nknot<a class="anchor" aria-label="anchor" href="#arg-nknot"></a></dt>
<dd><p>semimetric.deriv argument: number of interior knots (needed for
defining the B-spline basis).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt id="arg-nbasis">nbasis<a class="anchor" aria-label="anchor" href="#arg-nbasis"></a></dt>
<dd><p><code>semimetric.fourier</code>: size of the basis.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p><code>semimetric.fourier</code>:allows to select the period for the
fourier expansion.</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p><code>semimetric.hshift</code>: vector which defines <code>t</code> (one can
choose <code>1,2,...,nbt</code> where <code>nbt</code> is the number of points of the
discretization)</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>If <code>semimetric.pca</code>: the retained number of principal
components.<br> If <code>semimetric.mplsr</code>: the retained number of factors.</p></dd>


<dt id="arg-class-">class1<a class="anchor" aria-label="anchor" href="#arg-class-"></a></dt>
<dd><p><code>semimetric.mplsr</code>: vector containing a categorical
response which corresponds to class number for units stored in <code>DATA1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a proximities matrix between two functional datasets.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>semimetric.deriv</code>: approximates \(L_2\) metric
between derivatives of the curves based on ther B-spline representation. The
derivatives set with the argument <code>nderiv</code>.<br><code>semimetric.fourier</code>: approximates \(L_2\) metric between the curves
based on ther B-spline representation. The derivatives set with the argument
<code>nderiv</code>.<br><code>semimetric.hshift</code>: computes distance between curves
taking into account an horizontal shift effect.<br><code>semimetric.mplsr</code>:
computes distance between curves based on the partial least squares
method.<br><code>semimetric.pca</code>: computes distance between curves based on
the functional principal components analysis method.</p>
<p>In the next semi-metric functions the functional data \(X\) is
approximated by \(k_n\) elements of the Fourier, B–spline, PC or PLS basis
using, \(\hat{X_i} =\sum_{k=1}^{k_n}\nu_{k,i}\xi_k\), where \(\nu_k\)
are the coefficient of the expansion on the basis function
\(\left\{\xi_k\right\}_{k=1}^{\infty}\).<br> The distances between the q-order derivatives of two curves \(X_{1}\) and
\(X_2\) is,
$$d_{2}^{(q)}\left(X_1,X_2\right)_{k_n}=\sqrt{\frac{1}{T}\int_{T}\left(X_{1}^{(q)}(t)-X_{2}^{(q)}(t)\right)^2
dt}$$ where \(X_{i}^{(q)}\left(t\right)\) denot the \(q\) derivative of
\(X_i\).</p>
<p><code>semimetric.deriv</code> and <code>semimetric.fourier</code> function use a
B-spline and Fourier approximation respectively for each curve and the
derivatives are directly computed by differentiating several times their
analytic form, by default <code>q=1</code> and <code>q=0</code> respectively.
<code>semimetric.pca</code> and <code>semimetric.mprls</code> function compute
proximities between curves based on the functional principal components
analysis (FPCA) and the functional partial least square analysis (FPLS),
respectively. The FPC and FPLS reduce the functional data in a reduced
dimensional space (q components). <code>semimetric.mprls</code> function requires
a scalar response.</p>
<p>$$d_{2}^{(q)}\left(X_1,X_2\right)_{k_n}\approx\sqrt{\sum_{k=1}^{k_n}\left(\nu_{k,1}-\nu_{k,2}\right)^2\left\|\xi_k^{(q)}\right\|dt}$$
<code>semimetric.hshift</code> computes proximities between curves taking into
account an horizontal shift effect.</p>
<p>$$d_{hshift}\left(X_1,X_2\right)=\min_{h\in\left[-mh,mh\right]}d_2(X_1(t),X_2(t+h))$$
where \(mh\) is the maximum horizontal shifted allowed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ferraty, F. and Vieu, P. (2006). <em>Nonparametric functional
data analysis.</em> Springer Series in Statistics, New York.</p>
<p>Ferraty, F. and Vieu, P. (2006). <em>NPFDA in practice</em>.  Free access on
line at <a href="https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/" class="external-link">https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See also <code><a href="metric.lp.html">metric.lp</a></code> and <code><a href="semimetric.basis.html">semimetric.basis</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{ </span></span></span>
<span class="r-in"><span><span class="co">#  INFERENCE PHONDAT</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">phoneme</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span> <span class="co"># 2 groups</span></span></span>
<span class="r-in"><span><span class="va">mlearn</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">learn</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mtest</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">test</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mlearn</span><span class="op">[[</span><span class="st">"data"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">np</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mlearn</span><span class="op">[[</span><span class="st">"data"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist1</span><span class="op">=</span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist2</span><span class="op">=</span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,q<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist3</span><span class="op">=</span><span class="fu">semimetric.deriv</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,nderiv<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist4</span><span class="op">=</span><span class="fu">semimetric.fourier</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,nderiv<span class="op">=</span><span class="fl">2</span>,nbasis<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#uses hshift function</span></span></span>
<span class="r-in"><span><span class="co">#mdist5=semimetric.hshift(mlearn,mtest) #takes a lot</span></span></span>
<span class="r-in"><span><span class="va">glearn</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">classlearn</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">#uses mplsr function</span></span></span>
<span class="r-in"><span><span class="va">mdist6</span><span class="op">=</span><span class="fu">semimetric.mplsr</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,<span class="fl">5</span>,<span class="va">glearn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist0</span><span class="op">=</span><span class="fu"><a href="metric.lp.html">metric.lp</a></span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">mdist6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">c2</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">memb</span>,<span class="va">phoneme</span><span class="op">$</span><span class="va">classlearn</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="co"># } </span></span></span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

