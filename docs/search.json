[{"path":"https://moviedo5.github.io/fda.usc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Manuel Febrero Bande. Author. Manuel Oviedo de la Fuente. Author, maintainer. Pedro Galeano. Contributor. Alicia Nieto. Contributor. Eduardo Garcia-Portugues. Contributor.","code":""},{"path":"https://moviedo5.github.io/fda.usc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. URL https://www.jstatsoft.org/v51/i04/.","code":"@Article{,   title = {Statistical Computing in Functional Data Analysis: The {R} Package {fda.usc}},   author = {Manuel Febrero-Bande and Manuel {Oviedo de la Fuente}},   journal = {Journal of Statistical Software},   year = {2012},   volume = {51},   number = {4},   pages = {1--28},   url = {https://www.jstatsoft.org/v51/i04/}, }"},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/index.html","id":"package-overview","dir":"","previous_headings":"","what":"Package overview","title":"Functional Data Analysis and Utilities for Statistical Computing","text":"fda.usc package carries exploratory descriptive analysis functional data exploring important features depth measurements functional outliers detection, among others. also helps explain model relationship dependent variable independent (regression models) make predictions. Methods supervised unsupervised classification set functional data regarding feature data also included. can perform functional ANOVA, hypothesis testing, functional response models many others.","code":""},{"path":"https://moviedo5.github.io/fda.usc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Functional Data Analysis and Utilities for Statistical Computing","text":"can install current fda.usc version CRAN : latest patched version Github :","code":"install.packages(\"fda.usc\") library(devtools) devtools::install_github(\"moviedo5/fda.usc\")"},{"path":"https://moviedo5.github.io/fda.usc/index.html","id":"issues--feature-requests","dir":"","previous_headings":"","what":"Issues & Feature Requests","title":"Functional Data Analysis and Utilities for Statistical Computing","text":"issues, bugs, feature requests etc. please use Github Issues. Input always welcome.","code":""},{"path":"https://moviedo5.github.io/fda.usc/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Functional Data Analysis and Utilities for Statistical Computing","text":"hands introduction can found reference vignette. Details specific functions reference manual. Cheatsheet fda.usc reference card.","code":""},{"path":"https://moviedo5.github.io/fda.usc/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Functional Data Analysis and Utilities for Statistical Computing","text":"Febrero-Bande, M. Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4):1-28. https://dx.doi.org/10.18637/jss.v051.i04","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/accuracy.html","id":null,"dir":"Reference","previous_headings":"","what":"Performance measures for regression and classification models — accuracy","title":"Performance measures for regression and classification models — accuracy","text":"cat2meas tab2meas calculate measures multiclass classification model.pred2meas calculates measures regression model.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/accuracy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performance measures for regression and classification models — accuracy","text":"","code":"cat2meas(yobs, ypred, measure = \"accuracy\", cost = rep(1, nlevels(yobs)))  tab2meas(tab, measure = \"accuracy\", cost = rep(1, nrow(tab)))  pred.MSE(yobs, ypred)  pred.RMSE(yobs, ypred)  pred.MAE(yobs, ypred)  pred2meas(yobs, ypred, measure = \"RMSE\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/accuracy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performance measures for regression and classification models — accuracy","text":"yobs vector labels, true class observed response. Can numeric, character, factor. ypred vector predicted labels, predicted class predicted response. Can numeric, character, factor. measure Type measure, see details section. cost Cost value class (input factors). tab Confusion matrix (Contingency table: observed class rows, predicted class columns).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/accuracy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Performance measures for regression and classification models — accuracy","text":"cat2meas compute \\(tab=table(yobs,ypred)\\) calls tab2meas function. tab2meas function computes following measures (see measure argument) binary classification model: accuracy: Proportion correct predictions.   \\(\\frac{TP + TN}{TP + TN + FP + FN}\\) sensitivity, TPrate, recall: True Positive Rate recall.   \\(\\frac{TP}{TP + FN}\\) precision: Positive Predictive Value.   \\(\\frac{TP}{TP + FP}\\) specificity, TNrate: True Negative Rate.   \\(\\frac{TN}{TN + FP}\\) FPrate: False Positive Rate.   \\(\\frac{FP}{TN + FP}\\) FNrate: False Negative Rate.   \\(\\frac{FN}{TP + FN}\\) Fmeasure: Harmonic mean precision recall.   \\(\\frac{2}{\\frac{1}{\\text{recall}} + \\frac{1}{\\text{precision}}}\\) Gmean: Geometric Mean recall specificity.   \\(\\sqrt{\\left(\\frac{TP}{TP + FN}\\right) \\cdot \\left(\\frac{TN}{TN + FP}\\right)}\\) kappa: Cohen's Kappa index.   \\(Kappa = \\frac{P_o - P_e}{1 - P_e}\\) \\(P_o\\) proportion observed agreement,   \\(\\frac{TP + TN}{TP + TN + FP + FN}\\), \\(P_e\\) proportion agreement expected chance,   \\(\\frac{(TP + FP)(TP + FN) + (TN + FN)(TN + FP)}{(TP + TN + FP + FN)^2}\\). cost: Weighted accuracy, calculated   \\(\\frac{\\sum (\\text{diag(tab)} / \\text{rowSums(tab)} \\cdot \\text{cost})}{\\sum(\\text{cost})}\\) IOU: Mean Intersection Union.   \\(\\frac{TP}{TP + FN + FP}\\) IOU4class: Intersection Union class level.   \\(\\frac{TP}{TP + FN + FP}\\)#' pred2meas function computes following  measures error, usign measure argument, observed predicted vectors: MSE: Mean squared error, \\(\\frac{\\sum{(ypred- yobs)^2}}{n} \\). RMSE: Root mean squared error \\(\\sqrt{\\frac{\\sum{(ypred- yobs)^2}}{n} }\\). MAE: Mean Absolute Error, \\(\\frac{\\sum |yobs - ypred|}{n}\\).","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":null,"dir":"Reference","previous_headings":"","what":"aemet data — aemet","title":"aemet data — aemet","text":"Series daily summaries 73 spanish weather stations selected period 1980-2009.  dataset contains geographic information station average period 1980-2009 daily temperature, daily precipitation daily wind speed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"aemet data — aemet","text":"Elements aemet:..$df: Data frame information wheather station: ind: Indicated weather station. name: Station Name.  36 marked UTF-8 strings. province:Province (region) Spain. 36 marked UTF-8 strings altitude: Altitude station (meters). year.ini: Start year. year.end: End year. longitude: x geographic coordinate station (decimal degrees). latitude: y geographic coordinate station (decimal degrees). functional variables: ...$temp: mean curve average daily temperature period 1980-2009 (degrees Celsius, marked UTF-8 string). leap years temperatures February 28 29 averaged. ...$wind.speed: mean curve average daily wind speed period 1980-2009 (m/s). ...$logprec: mean curve log precipitation period 1980-2009 (log mm). Negligible precipitation (less 1 tenth mm) replaced 0.05 precipitation (0.0 mm) replaced 0.01.  logarithm applied.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"aemet data — aemet","text":"data obtained FTP AEMET 2009.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"aemet data — aemet","text":"Meteorological State Agency Spain (AEMET), https://www.aemet.es/es/portada. Government Spain. marks 36 UTF-8 string names stations 3 UTF-8 string names provinces function iconv.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"aemet data — aemet","text":"Manuel Febrero Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/aemet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"aemet data — aemet","text":"","code":"if (FALSE) { # \\dontrun{ data(aemet) names(aemet) names(aemet$df) lat <- ifelse(aemet$df$latitude<31,\"red\",\"blue\") plot(aemet,col=lat) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":null,"dir":"Reference","previous_headings":"","what":"DD-Classifier Based on DD-plot — classif.DD","title":"DD-Classifier Based on DD-plot — classif.DD","text":"Fits Nonparametric Classification Procedure Based DD–plot (depth-versus-depth plot) G dimensions (\\(G=g\\times h\\), g levels p data depth).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DD-Classifier Based on DD-plot — classif.DD","text":"","code":"classif.DD(   group,   fdataobj,   depth = \"FM\",   classif = \"glm\",   w,   par.classif = list(),   par.depth = list(),   control = list(verbose = FALSE, draw = TRUE, col = NULL, alpha = 0.25) )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DD-Classifier Based on DD-plot — classif.DD","text":"group Factor length n g levels. fdataobj data.frame, fdata list multivariate, functional covariates respectively. depth Character vector specifying type depth functions use, see Details. classif Character vector specifying type classifier method use, see Details. w Optional case weights, weights value depth argument, see Details. par.classif List parameters classif procedure. par.depth List parameters depth function. control List parameters controlling process. verbose=TRUE, report extra information progress. draw=TRUE print DD-plot two samples based data depth. col, colors points DD–plot. alpha, alpha transparency used background DD–plot, number [0,1].","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DD-Classifier Based on DD-plot — classif.DD","text":"group.est: Estimated vector groups classified method selected. misclassification:  Probability misclassification. prob.classification:  Probability correct classification group level. dep:  Data frame depth curves functional data (points multivariate data) fdataobj w.r.t. group level. depth:  Character vector specifying type depth functions used. par.depth:  List parameters depth function. classif:  Type classifier used. par.classif:  List parameters classif procedure. w:  Optional case weights. fit: Fitted object classif method using depth covariate.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"DD-Classifier Based on DD-plot — classif.DD","text":"Make group classification training dataset using DD-classifier estimation following steps. function computes selected depth measure points fdataobj w.r.t. subsample g level group p data dimension (\\(G=g \\times p\\)).  user can specify parameters depth function par.depth. () Type depth function functional data, see Depth: \"FM\": Fraiman Muniz depth. \"mode\": h-modal depth. \"RT\": Random Tukey depth. \"RP\": Random projection depth. \"RPD\": Double random projection depth. (ii) Type depth function multivariate functional data, see depth.mfdata: \"FMp\": Fraiman Muniz depth common support. Suppose p-fdata objects support (rangevals); see depth.FMp. \"modep\": h-modal depth using p-dimensional metric; see depth.modep. \"RPp\": Random projection depth using p-variate depth projections, depth.RPp. procedure requires compute distance \"knn\" \"np\" classifier \"mode\" depth, user must use proper distance function: metric.lp functional data metric.dist multivariate data. (iii) Type depth function multivariate data, see Depth.Multivariate: \"SD\": Simplicial depth (bivariate data). \"HS\": Half-space depth. \"MhD\": Mahalanobis depth. \"RD\": Random projections depth. \"LD\": Likelihood depth. function calculates misclassification rate based data depth computed step (1) using following classifiers. \"MaxD\": Maximum depth. \"DD1\": Search best separating polynomial degree 1. \"DD2\": Search best separating polynomial degree 2. \"DD3\": Search best separating polynomial degree 3. \"glm\": Logistic regression computed using Generalized Linear Models; see classif.glm. \"gam\": Logistic regression computed using GAM models; see classif.gsam. \"lda\": Linear Discriminant Analysis computed using lda. \"qda\": Quadratic Discriminant Analysis computed using qda. \"knn\": k-Nearest Neighbour classification computed using classif.knn. \"np\": Non-parametric Kernel classifier computed using classif.np. user can specify parameters classifier function par.classif smoothing parameter par.classif[[\"h\"]], classif=\"np\" k-Nearest Neighbour par.classif[[\"knn\"]], classif=\"knn\". case polynomial classifier (\"DD1\", \"DD2\" \"DD3\") uses original procedure proposed Li et al. (2012), defalut rotating DD-plot (exchange abscise ordinate) using par.classif argument rotate=TRUE. Notice maximum depth classifier can considered particular case DD1, fixing slope value 1 (par.classif=list(pol=1)). number possible different polynomials depends sample size n increases polynomially order \\(k\\). case \\(g\\) groups, procedure applies multiple-start optimization scheme save time: Generate combinations elements \\( n \\) taken \\( k \\) time: \\(g \\times combn(N,k)\\) candidate solutions. number exceeds nmax=10000, random sample 10000 combinations selected. Smooth empirical loss logistic function: \\(1/(1+e^{-tx})\\). classification rule constructed optimizing best noptim combinations random sample (default, noptim=1 tt=50/range(depth values)). Note Li et al. found optimization results become stable \\(t \\[50, 200]\\) depth standardized upper bound 1. original procedure (Li et al. (2012)) need try many initial polynomials (nmax=1000) procedure optimize best (noptim=1), recommended repeat last step different solutions, example nmax=250 noptim=25. User can change parameters pol, rotate, nmax, noptim tt argument par.classif. classif.DD procedure extends multi-class problems incorporating method majority voting case polynomial classifier method One vs Rest logistic case (\"glm\" \"gam\").","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DD-Classifier Based on DD-plot — classif.DD","text":"Cuesta-Albertos, J.., Febrero-Bande, M. Oviedo de la Fuente, M. DDG-classifier functional setting, (2017). Test, 26(1), 119-142. DOI: doi:10.1007/s11749-016-0502-6 .","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DD-Classifier Based on DD-plot — classif.DD","text":"version created Manuel Oviedo de la Fuente Manuel Febrero Bande includes original version polynomial classifier created Jun Li, Juan . Cuesta-Albertos Regina Y. Liu.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.DD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DD-Classifier Based on DD-plot — classif.DD","text":"","code":"if (FALSE) { # \\dontrun{ # DD-classif for functional data data(tecator) ab <- tecator$absorp.fdata ab1 <- fdata.deriv(ab, nderiv = 1) ab2 <- fdata.deriv(ab, nderiv = 2) gfat <- factor(as.numeric(tecator$y$Fat>=15))  # DD-classif for p=1 functional  data set out01 <- classif.DD(gfat,ab,depth=\"mode\",classif=\"np\") out02 <- classif.DD(gfat,ab2,depth=\"mode\",classif=\"np\") # DD-plot in gray scale ctrl <- list(draw=T,col=gray(c(0,.5)),alpha=.2) out02bis <- classif.DD(gfat,ab2,depth=\"mode\",classif=\"np\",control=ctrl)  # 2 depth functions (same curves)  ldat <- mfdata(\"ab\" = ab, \"ab2\" = ab2) out03 <- classif.DD(gfat,list(ab2,ab2),depth=c(\"RP\",\"mode\"),classif=\"np\") # DD-classif for p=2 functional data set # Weighted version  out04 <- classif.DD(gfat, ldat, depth=\"mode\",                     classif=\"np\", w=c(0.5,0.5)) # Model version out05 <- classif.DD(gfat,ldat,depth=\"mode\",classif=\"np\") # Integrated version (for multivariate functional data) out06 <- classif.DD(gfat,ldat,depth=\"modep\",classif=\"np\")  # DD-classif for multivariate data data(iris) group <- iris[,5] x <- iris[,1:4] out07 <- classif.DD(group,x,depth=\"LD\",classif=\"lda\") summary(out07) out08 <- classif.DD(group, list(x,x), depth=c(\"MhD\",\"LD\"),                     classif=\"lda\") summary(out08)  # DD-classif for functional data: g levels  data(phoneme) mlearn <- phoneme[[\"learn\"]] glearn <- as.numeric(phoneme[[\"classlearn\"]])-1 out09 <- classif.DD(glearn,mlearn,depth=\"FM\",classif=\"glm\") out10 <- classif.DD(glearn,list(mlearn,mlearn),depth=c(\"FM\",\"RP\"),classif=\"glm\") summary(out09) summary(out10) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":null,"dir":"Reference","previous_headings":"","what":"Classifier from Functional Data — classif.depth","title":"Classifier from Functional Data — classif.depth","text":"Classification functional data using maximum depth.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classifier from Functional Data — classif.depth","text":"","code":"classif.depth(   group,   fdataobj,   newfdataobj,   depth = \"RP\",   par.depth = list(),   CV = \"none\" )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classifier from Functional Data — classif.depth","text":"group Factor length n fdataobj fdata, matrix data.frame class object train data. newfdataobj fdata, matrix data.frame class object test data. depth Type depth function functional data: FM: Fraiman Muniz depth. mode: Modal depth. RT: Random Tukey depth. RP: Random project depth. RPD: Double random project depth. par.depth List parameters depth. CV =“none” group.est=group.pred, =TRUE group.est estimated cross-validation, =FALSE group.est estimated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classifier from Functional Data — classif.depth","text":"group.est: Vector classes train sample data. group.pred: Vector classes test sample data. prob.classification: Probability correct classification group. max.prob: Highest probability correct classification. fdataobj: fdata class object. group: Factor length n.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Classifier from Functional Data — classif.depth","text":"Cuevas, ., Febrero-Bande, M. Fraiman, R. (2007). Robust estimation classification functional data via projection-based depth notions. Computational Statistics 22, 3, 481-496.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Classifier from Functional Data — classif.depth","text":"Febrero-Bande, M. Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.depth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classifier from Functional Data — classif.depth","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme[[\"learn\"]] mtest<-phoneme[[\"test\"]] glearn<-phoneme[[\"classlearn\"]] gtest<-phoneme[[\"classtest\"]]  a1<-classif.depth(glearn,mlearn,depth=\"RP\") table(a1$group.est,glearn) a2<-classif.depth(glearn,mlearn,depth=\"RP\",CV=TRUE) a3<-classif.depth(glearn,mlearn,depth=\"RP\",CV=FALSE) a4<-classif.depth(glearn,mlearn,mtest,\"RP\") a5<-classif.depth(glearn,mlearn,mtest,\"RP\",CV=TRUE)      table(a5$group.est,glearn) a6<-classif.depth(glearn,mlearn,mtest,\"RP\",CV=FALSE) table(a6$group.est,glearn) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":null,"dir":"Reference","previous_headings":"","what":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"Computes functional classification using functional explanatory variables using backfitting algorithm.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"","code":"classif.gkam(   formula,   data,   weights = \"equal\",   family = binomial(),   par.metric = NULL,   par.np = NULL,   offset = NULL,   prob = 0.5,   type = \"1vsall\",   control = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"formula object class formula (one can coerced class): symbolic description model fitted. procedure considers functional covariates (implemented non-functional covariates). details model specification given Details. data List containing variables model. weights Weights: character string ='equal' weights observation (default) ='inverse' inverse-probability weighting. numeric vector length n, Weight values observation. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) par.metric List arguments covariable pass metric function covariable. par.np List arguments pass fregre.np.cv function offset can used specify priori known component included linear predictor fitting. prob probability value used binary discriminant. type type \"1vsall\"  (default) maximum probability scheme applied: requires G binary classifiers. type \"majority\"  (multicalss classification G > 2) voting scheme applied: requires  G (G - 1) / 2 binary classifiers. control list parameters controlling fitting process, default: maxit, epsilon, trace inverse. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"Return gam object plus: formula: formula. data: List containing variables model. group: Factor length n. group.est: Estimated vector groups. prob.classification: Probability correct classification group. prob.group: Matrix predicted class probabilities. functional point shows probability possible group membership. max.prob: Highest probability correct classification.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"first item data list called \"df\" data frame response, glm. Functional covariates class fdata introduced following items data list.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"Febrero-Bande M. Gonzalez-Manteiga W. (2012). Generalized Additive Models Functional Data. TEST. Springer-Velag.  doi:10.1007/s11749-012-0308-0 McCullagh Nelder (1989), Generalized Linear Models 2nd ed. Chapman Hall. Opsomer J.D. Ruppert D.(1997). Fitting bivariate additive model local polynomial regression.Annals Statistics, 25, 186-211.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gkam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classification Fitting Functional Generalized Kernel Additive Models — classif.gkam","text":"","code":"if (FALSE) { # \\dontrun{  ## Time-consuming: selection of 2 levels  data(phoneme) mlearn<-phoneme[[\"learn\"]][1:150] glearn<-factor(phoneme[[\"classlearn\"]][1:150]) dataf<-data.frame(glearn) dat=list(\"df\"=dataf,\"x\"=mlearn) a1<-classif.gkam(glearn~x,data=dat) summary(a1) mtest<-phoneme[[\"test\"]][1:150] gtest<-factor(phoneme[[\"classtest\"]][1:150]) newdat<-list(\"x\"=mtest) p1<-predict(a1,newdat) table(gtest,p1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Classification Fitting Functional Generalized Linear Models — classif.glm","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"Computes functional classification using functional (non functional) explanatory variables basis representation. first item data list called \"df\" data frame response non functional explanatory variables, glm. Functional covariates class fdata fd introduced following items data list.basis.x list basis represent functional covariate. basis object can created function: create.pc.basis, pca.fd create.pc.basis, create.fdata.basis o create.basis.basis.b list basis represent functional beta parameter. basis.x list functional principal components basis (see create.pc.basis pca.fd) argument basis.b ignored.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"","code":"classif.glm(   formula,   data,   family = binomial(),   weights = \"equal\",   basis.x = NULL,   basis.b = NULL,   type = \"1vsall\",   prob = 0.5,   CV = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. data List containing variables model. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions). weights Weights: character string ='equal' weights observation (default) ='inverse' inverse-probability weighting. numeric vector length n, Weight values observation. basis.x List basis functional explanatory data estimation. basis.b List basis functional beta parameter estimation. type type \"1vsall\"  (default) maximum probability scheme applied: requires G binary classifiers. type \"majority\"  (multicalss classification G > 2) voting scheme applied: requires  G (G - 1) / 2 binary classifiers. prob probability value used binari discriminant. CV =TRUE, Cross-validation (CV) done. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"Return glm object plus: formula: formula. data: List containing variables model. group: Factor length n. group.est: Estimated vector groups. prob.classification: Probability correct classification group. prob.group: Matrix predicted class probabilities. functional point shows probability possible group membership. max.prob: Highest probability correct classification.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"formula contains non functional explanatory variables (multivariate covariates), function compute standard glm procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. McCullagh Nelder (1989), Generalized Linear Models 2nd ed. Chapman Hall. Venables, W. N. Ripley, B. D. (2002) Modern Applied Statistics S, New York: Springer.   Regression R. R News 1(2):20-25","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classification Fitting Functional Generalized Linear Models — classif.glm","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) ldat <- ldata(\"df\" = data.frame(y = phoneme[[\"classlearn\"]]),              \"x\" = phoneme[[\"learn\"]]) a1 <- classif.glm(y ~ x, data = ldat) summary(a1) newldat <- ldata(\"df\" = data.frame(y = phoneme[[\"classtest\"]]),                 \"x\" = phoneme[[\"test\"]]) p1 <- predict(a1,newldat) table(newldat$df$y,p1) sum(p1==newldat$df$y)/250 } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":null,"dir":"Reference","previous_headings":"","what":"Classification Fitting Functional Generalized Additive Models — classif.gsam","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"Computes functional classification using functional (non functional) explanatory variables basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"","code":"classif.gsam(   formula,   data,   family = binomial(),   weights = \"equal\",   basis.x = NULL,   CV = FALSE,   prob = 0.5,   type = \"1vsall\",   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. data List containing variables model. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) weights Weights: character string ='equal' weights observation (default) ='inverse' inverse-probability weighting. numeric vector length n, Weight values observation. basis.x List basis functional explanatory data estimation. CV =TRUE, Cross-validation (CV) done. prob probability value used binari discriminant. type type \"1vsall\"  (default) maximum probability scheme applied: requires G binary classifiers. type \"majority\"  (multicalss classification G > 2) voting scheme applied: requires  G (G - 1) / 2 binary classifiers. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"Return gam object plus: formula: formula. data: List containing variables model. group: Factor length n. group.est: Estimated vector groups prob.classification: Probability correct classification group. prob.group: Matrix predicted class probabilities. functional point shows probability possible group membership. max.prob: Highest probability correct classification. type: Type classification scheme: 1 vs  majority voting.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"first item data list called \"df\" data frame response non functional explanatory variables, glm. Functional covariates class fdata fd introduced following items data list.basis.x list basis represent functional covariate. basis object can created function: create.pc.basis, pca.fd create.pc.basis, create.fdata.basis o create.basis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"formula contains non functional explanatory variables (multivariate covariates), function compute standard glm procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. McCullagh Nelder (1989), Generalized Linear Models 2nd ed. Chapman Hall. Venables, W. N. Ripley, B. D. (2002) Modern Applied Statistics S, New York: Springer.   Regression R. R News 1(2):20-25","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classification Fitting Functional Generalized Additive Models — classif.gsam","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) ldat <- ldata(\"df\" = data.frame(y = phoneme[[\"classlearn\"]]),               \"x\" = phoneme[[\"learn\"]])               classifKgroups <- fda.usc:::classifKgroups a1 <- classif.gsam( y ~ s(x,k=3),data=ldat) summary(a1) newldat <- ldata(\"df\" = data.frame(y = phoneme[[\"classtest\"]]),               \"x\" = phoneme[[\"test\"]]) p1 <- predict(a1,newldat) table(newldat$df$y,p1) sum(p1==newldat$df$y)/250 } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":null,"dir":"Reference","previous_headings":"","what":"Variable Selection in Functional Data Classification — classif.gsam.vs","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"Computes classification selecting functional (non functional) explanatory variables.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"","code":"classif.gsam.vs(   data = list(),   y,   x,   family = binomial(),   weights = \"equal\",   basis.x = NULL,   basis.b = NULL,   type = \"1vsall\",   prob = 0.5,   alpha = 0.05,   dcor.min = 0.01,   smooth = TRUE,   measure = \"accuracy\",   xydist,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"data List containing variables model.  \"df\" element  data.frame response scalar covariates (numeric factors variables allowed). Functional covariates class fdata fd introduced following items data list. y caracter string name scalar response variable x caracter string vector name scalar functional potential covariates. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) weights Weights: character string ='equal' weights observation (default) ='inverse' inverse-probability weighting. numeric vector length n, Weight values observation. basis.x List basis functional explanatory data estimation. basis.b List basis functional beta parameter estimation. type character, type scheme classification. '1vsall'  (default) strategy involves training single classifier per class, samples class positive samples samples negatives. posibility K-way multiclass problem 'majority' voting scheme (also called one vs one). procedure  trains \\(K (K - 1) / 2\\)  binary classifiers predicts final class label class label predicted frequently. prob probability value used binary discriminant. alpha alpha value test null hypothesis test independence among covariate X residual e. default 0.05. dcor.min lower threshold variable X considered. X discarded distance correlation \\(R(X,e)< dcor.min\\) (e residual). smooth TRUE, smooth estimate made covariates included model (less factors). model adjusted estimated variable linearly smoothly. models equivalent, model adjusted linearly estimated variable. measure measure related correct classification (default accuracy). xydist list matrices distances variable (potential covariates response) . ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"Return final fitted model (result classsification method) plus: dcor, matrix values distance correlation pontential covariate  (column) residual model step (row). .predictor, vector 1 variable selected, 0 otherwise. ipredictor, vector name selected variables (order selection)","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"Adapted version original method repression: fregre.gsam.vs.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"Febrero-Bande, M., Gonz\\'alez-Manteiga, W. Oviedo de la Fuente, M. Variable selection functional additive regression models, (2018).  Computational Statistics, 1-19. DOI: doi:10.1007/s00180-018-0844-5","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"Febrero-Bande, M. Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.gsam.vs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variable Selection in Functional Data Classification — classif.gsam.vs","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x <- tecator$absorp.fdata x1 <- fdata.deriv(x) x2 <- fdata.deriv(x,nderiv=2) y <- factor(ifelse(tecator$y$Fat<12,0,1)) xcat0 <- cut(rnorm(length(y)),4) xcat1 <- cut(tecator$y$Protein,4) xcat2 <- cut(tecator$y$Water,4) ind <- 1:129 dat    <- data.frame(\"Fat\"=y, x1$data, xcat1, xcat2) ldat <- ldata(\"df\"=dat[ind,],\"x\"=x[ind,],\"x1\"=x1[ind,],\"x2\"=x2[ind,]) # 3 functionals (x,x1,x2), 3 factors (xcat0, xcat1, xcat2) # and 100 scalars (impact poitns of x1)   res.gam <- classif.gsam(Fat~s(x),data=ldat) summary(res.gam)  # Time consuming res.gam.vs <- classif.gsam.vs(\"Fat\",data=ldat) summary(res.gam.vs) res.gam.vs$i.predictor res.gam.vs$ipredictor  # Prediction  newldat <- ldata(\"df\"=dat[-ind,],\"x\"=x[-ind,],                 \"x1\"=x1[-ind,],\"x2\"=x2[-ind,]) pred.gam <- predict(res.gam,newldat)                 pred.gam.vs <- predict(res.gam.vs,newldat) cat2meas(newldat$df$Fat, pred.gam) cat2meas(newldat$df$Fat, pred.gam.vs) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Classification usign k-fold CV — classif.kfold","title":"Functional Classification usign k-fold CV — classif.kfold","text":"Computes Functional Classification using k-fold cross-validation","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Classification usign k-fold CV — classif.kfold","text":"","code":"classif.kfold(   formula,   data,   classif = \"classif.glm\",   par.classif,   kfold = 10,   param.kfold = NULL,   measure = \"accuracy\",   cost,   models = FALSE,   verbose = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Classification usign k-fold CV — classif.kfold","text":"formula object class formula (one can coerced class): symbolic description model fitted. procedure considers functional covariates (implemented non-functional covariates). data list, contains variables model. classif character,  name classification method used fitting model, see Details section. par.classif list arguments used classification method. kfold integer, number k-fold. param.kfold list,  arguments related number k-folds covariate, see Details section. measure character, type measure accuracy used, see cat2meas function. cost numeric, see cat2meas function. models logical. TRUE, return list fitted models used,  (k-fold -1) X (number parameters) verbose logical. TRUE, print internal results.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Classification usign k-fold CV — classif.kfold","text":"Best fitted model computed k-fold CV  using method indicated classif argument also returns: param.min, value parameter (parameters) selected k-fold CV. params.error, k-fold CV error parameter combination. pred.kfold, predicted response computed k-fold CV. model, TRUE, list models parameter combination.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Classification usign k-fold CV — classif.kfold","text":"Parameters k-fold cross validation: Number basis elements: Data-driven basis Functional Principal Componetns (PC). implemented PLS basis yet. Fixed basis (bspline, fourier, etc.). Option used classifiers classif.glm, classif.gsam, classif.svm, etc. Bandwidth parameter.  Option used  non-parametric classificiation models classif.np classif.gkam.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Classification usign k-fold CV — classif.kfold","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.kfold.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Classification usign k-fold CV — classif.kfold","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator)     cutpoint <- 18 tecator$y$class <- factor(ifelse(tecator$y$Fat<cutpoint,0,1)) table(tecator$y$class ) x <- tecator[[1]] x2 <- fdata.deriv(tecator[[1]],2) data  <-   list(\"df\"=tecator$y,x=x,x2=x2) formula  <-   formula(class~x+x2)  # ex: default excution of classifier (no k-fold CV) classif=\"classif.glm\" out.default <- classif.kfold(formula, data, classif = classif) out.default out.default$param.min out.default$params.error summary(out.default)  # ex: Number of PC basis elements selected by 10-fold CV # Logistic classifier kfold = 10 param.kfold   <-   list(\"x\"=list(\"pc\"=c(1:8)),\"x2\"=list(\"pc\"=c(1:8))) out.kfold1   <-   classif.kfold(formula, data, classif = classif,                             kfold = kfold,param.kfold = param.kfold) out.kfold1$param.min min(out.kfold1$params.error) summary(out.kfold1)  # ex: Number of PC basis elements selected by 10-fold CV # Logistic classifier with inverse weighting out.kfold2 <- classif.kfold(formula, data, classif = classif,                             par.classif=list(\"weights\"=\"inverse\"),                             kfold = kfold,param.kfold = param.kfold) out.kfold2$param.min min(out.kfold2$params.error) summary(out.kfold2)  # ex: Number of fourier  basis elements selected by 10-fold CV # Logistic classifier  ibase = seq(5,15,by=2) param.kfold <- list(\"x\"=list(\"fourier\"=ibase),                     \"x2\"=list(\"fourier\"=ibase)) out.kfold3 <- classif.kfold(formula, data, classif = classif,                             kfold = kfold,param.kfold = param.kfold) out.kfold3$param.min min(out.kfold3$params.error) summary(out.kfold3)  # ex: Number of k-nearest neighbors selected by 10-fold CV # non-parametric classifier  (only for a functional covariate)  output <- classif.kfold( class ~ x, data, classif = \"classif.knn\",                        param.kfold= list(\"x\"=list(\"knn\"=c(3,5,9,13)))) output$param.min output$params.error  output <- classif.kfold( class ~ x2, data, classif = \"classif.knn\",                        param.kfold= list(\"x2\"=list(\"knn\"=c(3,5,9,13)))) output$param.min output$params.error  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional classification using ML algotithms — classif.ML","title":"Functional classification using ML algotithms — classif.ML","text":"Computes functional classification using functional (non functional) explanatory variables rpart, nnet, svm random forest model","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional classification using ML algotithms — classif.ML","text":"","code":"classif.nnet(formula, data, basis.x = NULL, weights = \"equal\", size, ...)  classif.rpart(   formula,   data,   basis.x = NULL,   weights = \"equal\",   type = \"1vsall\",   ... )  classif.svm(   formula,   data,   basis.x = NULL,   weights = \"equal\",   type = \"1vsall\",   ... )  classif.ksvm(formula, data, basis.x = NULL, weights = \"equal\", ...)  classif.randomForest(   formula,   data,   basis.x = NULL,   weights = \"equal\",   type = \"1vsall\",   ... )  classif.lda(   formula,   data,   basis.x = NULL,   weights = \"equal\",   type = \"1vsall\",   ... )  classif.qda(   formula,   data,   basis.x = NULL,   weights = \"equal\",   type = \"1vsall\",   ... )  classif.naiveBayes(formula, data, basis.x = NULL, laplace = 0, ...)  classif.cv.glmnet(formula, data, basis.x = NULL, weights = \"equal\", ...)  classif.gbm(formula, data, basis.x = NULL, weights = \"equal\", ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional classification using ML algotithms — classif.ML","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. data List containing variables model. basis.x List basis functional explanatory data estimation. weights Weights: character string ='equal' weights observation (default) ='inverse' inverse-probability weighting. numeric vector length n, Weight values observation. size number units hidden layer. Can zero skip-layer units. ... arguments passed methods. type type \"1vsall\"  (default) maximum probability scheme applied: requires G binary classifiers. type \"majority\"  (multicalss classification G > 2) voting scheme applied: requires  G (G - 1) / 2 binary classifiers. laplace value used Laplace smoothing (additive smoothing). Defaults 0 (Laplace smoothing).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional classification using ML algotithms — classif.ML","text":"Return classif object plus: formula: formula. data: List containing variables model. group: Factor length n. group.est: Estimated vector groups. prob.classification: Probability correct classification group. prob.group: Matrix predicted class probabilities. functional point shows probability possible group membership. max.prob: Highest probability correct classification. type:  Type classification scheme: 1 vs  majority voting. fit: list binary classification fitted models.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional classification using ML algotithms — classif.ML","text":"first item data list called \"df\" data frame response non functional explanatory variables, glm. Functional covariates class fdata fd introduced following items data list.basis.x list basis represent functional covariate. b object can created function: create.pc.basis, pca.fd create.pc.basis, create.fdata.basis o create.basis.basis.b list basis represent functional beta parameter. basis.x list functional principal components basis (see create.pc.basis pca.fd) argument basis.b ignored.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Functional classification using ML algotithms — classif.ML","text":"Wrapper versions multivariate functional classification: classif.lda,classif.qda: uses lda  qda functions requires MASS package. classif.nnet: uses nnet function requires nnet package. classif.rpart: uses nnet function requires rpart package. classif.svm, classif.naiveBayes: uses svm  naiveBayes functions requires e1071 package. classif.ksvm: uses weighted.ksvm  function requires personalized package. classif.randomForest: uses randomForest function requires randomForest package. classif.cv.glmnet: uses cv.glmnet function requires glmnet package. classif.gbm: uses gbm function requires gbm package.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional classification using ML algotithms — classif.ML","text":"Ramsay, James O., Silverman, Bernard W. (2006), Functional Data Analysis, 2nd ed., Springer, New York. McCullagh Nelder (1989), Generalized Linear Models 2nd ed. Chapman Hall. Venables, W. N. Ripley, B. D. (2002) Modern Applied Statistics S, New York: Springer.   Regression R. R News 1(2):20-25","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional classification using ML algotithms — classif.ML","text":"Febrero-Bande, M. Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional classification using ML algotithms — classif.ML","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme[[\"learn\"]] glearn<-phoneme[[\"classlearn\"]] mtest<-phoneme[[\"test\"]] gtest<-phoneme[[\"classtest\"]] dataf<-data.frame(glearn) dat=ldata(\"df\"=dataf,\"x\"=mlearn) a1<-classif.rpart(glearn~x,data=dat) a2<-classif.nnet(glearn~x,data=dat) a3<-classif.gbm(glearn~x,data=dat) a4<-classif.randomForest(glearn~x,data=dat) a5<-classif.cv.glmnet(glearn~x,data=dat) newdat<-list(\"x\"=mtest) p1<-predict(a1,newdat,type=\"class\") p2<-predict(a2,newdat,type=\"class\") p3<-predict(a3,newdat,type=\"class\") p4<-predict(a4,newdat,type=\"class\") p5<-predict(a5,newdat,type=\"class\") mean(p1==gtest);mean(p2==gtest);mean(p3==gtest) mean(p4==gtest);mean(p5==gtest) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":null,"dir":"Reference","previous_headings":"","what":"Kernel Classifier from Functional Data — classif.np","title":"Kernel Classifier from Functional Data — classif.np","text":"Fits Nonparametric Supervised Classification Functional Data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kernel Classifier from Functional Data — classif.np","text":"","code":"classif.np(   group,   fdataobj,   h = NULL,   Ker = AKer.norm,   metric,   weights = \"equal\",   type.S = S.NW,   par.S = list(),   ... )  classif.knn(   group,   fdataobj,   knn = NULL,   metric,   weights = \"equal\",   par.S = list(),   ... )  classif.kernel(   group,   fdataobj,   h = NULL,   Ker = AKer.norm,   metric,   weights = \"equal\",   par.S = list(),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kernel Classifier from Functional Data — classif.np","text":"group Factor length n fdataobj fdata class object. h Vector smoothing parameter bandwidth. Ker Type kernel used. metric Metric function, default metric.lp. weights weights. type.S Type smothing matrix S. default S calculated Nadaraya-Watson kernel estimator (S.NW). par.S List parameters type.S: w, weights. ... Arguments passed metric.lp o metric function Kernel function. knn Vector number nearest neighbors considered.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kernel Classifier from Functional Data — classif.np","text":"fdataobj: fdata class object. group: Factor length n. group.est: Estimated vector groups. prob.group: Matrix predicted class probabilities. functional point shows probability possible group membership. max.prob: Highest probability correct classification. h.opt: Optimal smoothing parameter bandwidht estimated. D: Matrix distances optimal quantile distance hh.opt. prob.classification: Probability correct classification group. misclassification: Vector probability misclassification number neighbors knn. h: Vector smoothing parameter bandwidht. C: call function classif.kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Kernel Classifier from Functional Data — classif.np","text":"Make group classification training dataset using kernel KNN estimation: Kernel. Different types metric funtions can used.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Kernel Classifier from Functional Data — classif.np","text":"fdataobj data.frame function considers case multivariate covariates. metric.dist function used compute distances rows data matrix (dist function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Kernel Classifier from Functional Data — classif.np","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Ferraty, F. Vieu, P. (2006). NPFDA practice. Free access line https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Kernel Classifier from Functional Data — classif.np","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/classif.np.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Kernel Classifier from Functional Data — classif.np","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn <- phoneme[[\"learn\"]] glearn <- phoneme[[\"classlearn\"]] h <- 9:19 out <- classif.np(glearn,mlearn,h=h) summary(out) head(round(out$prob.group,4)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional Distribution Function — cond.F","title":"Conditional Distribution Function — cond.F","text":"Calculate conditional distribution function scalar response functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional Distribution Function — cond.F","text":"","code":"cond.F(   fdata0,   y0,   fdataobj,   y,   h = 0.15,   g = 0.15,   metric = metric.lp,   Ker = list(AKer = AKer.epa, IKer = IKer.epa),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional Distribution Function — cond.F","text":"fdata0 Conditional explanatory functional data fdata class. y0 Vector conditional response length n. fdataobj fdata class object. y Vector scalar response length nn. h Smoothing parameter bandwidth response y. g Smoothing parameter bandwidth explanatory functional data fdataobj. metric Metric function, default metric.lp. Ker List 2 arguments. fist argument character string determines type asymetric kernel (see Kernel.asymmetric). Asymmetric Epanechnikov kernel selected default. second argumentis string determines type integrated kernel(see Kernel.integrate). Integrate Epanechnikov kernel selected default.. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional Distribution Function — cond.F","text":"Fc: Conditional distribution function. y0: Vector conditional response. g: Smoothing parameter bandwidth explanatory functional data (fdataobj). h: Smoothing parameter bandwidth respone, y. x.dist: Distance matrix curves fdataobj object. xy.dist: Distance matrix cuves fdataobj fdata0 objects.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Conditional Distribution Function — cond.F","text":"x.dist=NULL distance matrix fdata objects calculated function passed metric argument.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Conditional Distribution Function — cond.F","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Conditional Distribution Function — cond.F","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.F.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conditional Distribution Function — cond.F","text":"","code":"if (FALSE) { # \\dontrun{ # Read data n= 500 t= seq(0,1,len=101) beta = t*sin(2*pi*t)^2 x = matrix(NA, ncol=101, nrow=n) y=numeric(n) x0<-rproc2fdata(n,seq(0,1,len=101),sigma=\"wiener\") x1<-rproc2fdata(n,seq(0,1,len=101),sigma=0.1) x<-x0*3+x1 fbeta = fdata(beta,t) y<-inprod.fdata(x,fbeta)+rnorm(n,sd=0.1)  prx=x[1:100];pry=y[1:100] ind=101;ind2=102:110 pr0=x[ind];pr10=x[ind2,] ndist=61 gridy=seq(-1.598069,1.598069, len=ndist)  # Conditional Function res1 = cond.F(pr10, gridy, prx, pry,p=1) res2 = cond.F(pr10, gridy, prx, pry,h=0.3) res3 = cond.F(pr10, gridy, prx, pry,g=0.25,h=0.3)  plot(res1$Fc[,1],type=\"l\",ylim=c(0,1)) lines(res2$Fc[,1],type=\"l\",col=2) lines(res3$Fc[,1],type=\"l\",col=3) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional mode — cond.mode","title":"Conditional mode — cond.mode","text":"Computes mode conditional distribution function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional mode — cond.mode","text":"","code":"cond.mode(Fc, method = \"monoH.FC\", draw = TRUE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional mode — cond.mode","text":"Fc Object estimated cond.F function. method Specifies type spline used. Possible values \"diff\", \"fmm\", \"natural\", \"periodic\" \"monoH.FC\". draw =TRUE, plots conditional distribution density function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional mode — cond.mode","text":"Return mode conditional distribution function. mode.cond: Conditional mode. x: grid length n conditional density function evaluated. f: conditional density function evaluated x.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Conditional mode — cond.mode","text":"conditional mode calculated maximum argument derivative conditional distribution function (density function f).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Conditional mode — cond.mode","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Conditional mode — cond.mode","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.mode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conditional mode — cond.mode","text":"","code":"if (FALSE) { # \\dontrun{ n= 500 t= seq(0,1,len=101) beta = t*sin(2*pi*t)^2 x = matrix(NA, ncol=101, nrow=n) y=numeric(n) x0<-rproc2fdata(n,seq(0,1,len=101),sigma=\"wiener\") x1<-rproc2fdata(n,seq(0,1,len=101),sigma=0.1) x<-x0*3+x1 fbeta = fdata(beta,t) y<-inprod.fdata(x,fbeta)+rnorm(n,sd=0.1) prx=x[1:100];pry=y[1:100] ind=101;ind2=101:110 pr0=x[ind];pr10=x[ind2] ndist=161 gridy=seq(-1.598069,1.598069, len=ndist) # Conditional Function I=5 # Time consuming res = cond.F(pr10[I], gridy, prx, pry, h=1) mcond=cond.mode(res) mcond2=cond.mode(res,method=\"diff\") } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional quantile — cond.quantile","title":"Conditional quantile — cond.quantile","text":"Computes quantile conditional distribution function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional quantile — cond.quantile","text":"","code":"cond.quantile(   qua = 0.5,   fdata0,   fdataobj,   y,   fn,   a = min(y),   b = max(y),   tol = 10^floor(log10(max(y) - min(y)) - 3),   iter.max = 100,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional quantile — cond.quantile","text":"qua Quantile value, default median (qua=0.5). fdata0 Conditional functional explanatory data fdata class object. fdataobj Functional explanatory data fdata class object. y Scalar Response. fn Conditional distribution function. Lower limit. b Upper limit. tol Tolerance. iter.max Maximum iterations allowed, default 100. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional quantile — cond.quantile","text":"Return quantile conditional distribution function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Conditional quantile — cond.quantile","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Conditional quantile — cond.quantile","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/cond.quantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conditional quantile — cond.quantile","text":"","code":"if (FALSE) { # \\dontrun{ n= 100 t= seq(0,1,len=101) beta = t*sin(2*pi*t)^2 x = matrix(NA, ncol=101, nrow=n) y=numeric(n) x0<-rproc2fdata(n,seq(0,1,len=101),sigma=\"wiener\") x1<-rproc2fdata(n,seq(0,1,len=101),sigma=0.1) x<-x0*3+x1 fbeta = fdata(beta,t) y<-inprod.fdata(x,fbeta)+rnorm(n,sd=0.1)  prx=x[1:50];pry=y[1:50] ind=50+1;ind2=51:60 pr0=x[ind];pr10=x[ind2] ndist=161 gridy=seq(-1.598069,1.598069, len=ndist) ind4=5 y0 = gridy[ind4]  # Conditional median med=cond.quantile(qua=0.5,fdata0=pr0,fdataobj=prx,y=pry,fn=cond.F,h=1)  # Conditional CI 95% conditional lo=cond.quantile(qua=0.025,fdata0=pr0,fdataobj=prx,y=pry,fn=cond.F,h=1) up=cond.quantile(qua=0.975,fdata0=pr0,fdataobj=prx,y=pry,fn=cond.F,h=1) print(c(lo,med,up)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"Compute basis functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"","code":"create.fdata.basis(   fdataobj,   l = 1:5,   maxl = max(l),   type.basis = \"bspline\",   rangeval = fdataobj$rangeval,   class.out = \"fd\" )  create.pc.basis(   fdataobj,   l = 1:5,   norm = TRUE,   basis = NULL,   lambda = 0,   P = c(0, 0, 1),   ... )  create.pls.basis(   fdataobj,   y,   l = 1:5,   norm = TRUE,   lambda = 0,   P = c(0, 0, 1),   ... )  create.raw.fdata(fdataobj, l = 1:nrow(fdataobj))"},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"fdataobj fdata class object. l Vector basis index. maxl maximum number basis type.basis Type basis (see create.basis function). rangeval vector length 2 giving lower upper limits range permissible values function argument. class.==\"fd\" basisfd class, ==\"fdata\" fdata class. norm TRUE norm eigenvectors basis 1. basis \"fd\" basis object. lambda Amount penalization. Default value 0, .e. penalization used. P P vector: coefficients define penalty matrix object. default P=c(0,0,1) penalize second derivative (curvature) acceleration.  P matrix: penalty matrix object. ... arguments passed methods. y Vector response (scalar).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"basis: basis object. x: TRUE value rotated data (centred data multiplied basis matrix) returned. mean: functional mean fdataobj. df: degree freedom. type: type basis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"Ramsay, James O. Silverman, Bernard W. (2006), Functional Data Analysis, 2nd ed., Springer, New York. N. Kraemer, .-L. Boulsteix, G. Tutz (2008). Penalized Partial Least Squares Applications B-Spline Transformations Functional Data. Chemometrics Intelligent Laboratory Systems, 94, 60 - 69. doi:10.1016/j.chemolab.2008.06.009","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/create.fdata.basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Basis Set for Functional Data of fdata class — create.fdata.basis","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) basis.pc<-create.pc.basis(tecator$absorp.fdata,c(1,4,5)) plot(basis.pc$basis,col=1) summary(basis.pc) basis.pls<-create.pls.basis(tecator$absorp.fdata,y=tecator$y[,1],c(1,4,5)) summary(basis.pls) plot(basis.pls$basis,col=2) summary(basis.pls)  basis.fd<-create.fdata.basis(tecator$absorp.fdata,c(1,4,5), type.basis=\"fourier\") plot(basis.pc$basis) basis.fdata<-create.fdata.basis(tecator$absorp.fdata,c(1,4,5), type.basis=\"fourier\",class.out=\"fdata\") plot(basis.fd,col=2,lty=1) lines(basis.fdata,col=3,lty=1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":null,"dir":"Reference","previous_headings":"","what":"The cross-validation (CV) score — CV.S","title":"The cross-validation (CV) score — CV.S","text":"Compute leave-one-cross-validation score.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The cross-validation (CV) score — CV.S","text":"","code":"CV.S(y, S, W = NULL, trim = 0, draw = FALSE, metric = metric.lp, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The cross-validation (CV) score — CV.S","text":"y Matrix set cases dimension (n x m), n number curves m points observed curve. S Smoothing matrix, see S.NW, S.LLR \\(S.KNN\\). W Matrix weights. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. metric Metric function, default metric.lp. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The cross-validation (CV) score — CV.S","text":"Returns CV score calculated input parameters.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The cross-validation (CV) score — CV.S","text":".-trim=0: $$CV(h)=\\frac{1}{n} \\sum_{=1}^{n}{\\Bigg(\\frac{y_i-r_{}(x_i)}{(1-S_{ii})}\\Bigg)^{2}w(x_{})}$$ \\(S_{ii}\\) ith diagonal element smoothing matrix \\(S\\). B.-trim>0: $$CV(h)=\\frac{1}{l} \\sum_{=1}^{l}{\\Bigg(\\frac{y_i-r_{}(x_i)}{(1-S_{ii})}\\Bigg)^{2}w(x_{})}$$ \\(S_{ii}\\) ith diagonal element smoothing matrix \\(S\\) l index (1-trim) curves less error.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The cross-validation (CV) score — CV.S","text":"Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The cross-validation (CV) score — CV.S","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/CV.S.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The cross-validation (CV) score — CV.S","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x<-tecator$absorp.fdata np<-ncol(x) tt<-1:np S1 <- S.NW(tt,3,Ker.epa) S2 <- S.LLR(tt,3,Ker.epa) S3 <- S.NW(tt,5,Ker.epa) S4 <- S.LLR(tt,5,Ker.epa) cv1 <- CV.S(x, S1) cv2 <- CV.S(x, S2) cv3 <- CV.S(x, S3) cv4 <- CV.S(x, S4) cv5 <- CV.S(x, S4,trim=0.1,draw=TRUE) cv1;cv2;cv3;cv4;cv5 S6 <- S.KNN(tt,1,Ker.unif,cv=TRUE) S7 <- S.KNN(tt,5,Ker.unif,cv=TRUE) cv6 <- CV.S(x, S6) cv7 <- CV.S(x, S7) cv6;cv7 } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance Correlation Statistic and t-Test — dcor.xy","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"Distance correlation t-test multivariate functional independence (wrapper functions energy package).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"","code":"dcor.xy(x, y, test = TRUE, metric.x, metric.y, par.metric.x, par.metric.y, n)  dcor.dist(D1, D2)  bcdcor.dist(D1, D2, n)  dcor.test(D1, D2, n)"},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"x data (fdata, matrix data.frame class) first sample. y data (fdata, matrix data.frame class) second sample. test TRUE, compute bias corrected distance correlation statistic corresponding t-test, else compute distance correlation statistic. metric.x, metric.y Name metric semi-metric function used compute distances x y object respectively. default, metric.lp functional data metric.dist multivariate data. par.metric.x, par.metric.y List parameters corresponding metric function. n sample size used bias corrected version distance correlation, default number rows x. D1 Distances first sample (x data). D2 Distances second sample (y data).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"dcor.test returns list class htest containing method: description test. statistic: observed value test statistic. parameter: degrees freedom. estimate: bias corrected distance correlation bcdcor(x,y). p.value: p-value t-test. data.name: description data. dcor.xy returns previous list class htest D1: distance matrix x. D2: distance matrix y. dcor.dist returns distance correlation statistic. bcdcor.dist returns bias corrected distance correlation statistic.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"wrapper functions extend functions energy package multivariate data functional data.  Distance correlation measure dependence random vectors introduced Szekely, Rizzo, Bakirov (2007). dcor.xy performs nonparametric t-test multivariate functional independence high dimension. distribution test statistic approximately Student t \\(n(n-3)/2-1\\) degrees freedom \\(n \\geq 10\\) statistic approximately distributed standard normal.  Wrapper function energy:::dcor.ttest.  t statistic transformation bias corrected version distance correlation (see SR 2013 details). Large values (upper tail) t statistic significant.dcor.test similar dcor.xy distance matrix. dcor.dist compute distance correlation statistic.  Wrapper function energy::dcor distance matrix bcdcor.dist compute bias corrected distance correlation statistic. Wrapper function energy:::bcdcor distance matrix.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"Szekely, G.J. Rizzo, M.L. (2013). distance correlation t-test independence high dimension. Journal Multivariate Analysis, Volume 117, pp. 193-213. Szekely, G.J., Rizzo, M.L., Bakirov, N.K. (2007), Measuring Testing Dependence Correlation Distances, Annals Statistics, Vol. 35 . 6, pp. 2769-2794.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"Manuel Oviedo de la Fuente manuel.oviedo@udc.es Manuel Febrero Bande","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dcor.xy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance Correlation Statistic and t-Test — dcor.xy","text":"","code":"if (FALSE) { # \\dontrun{  x<-rproc2fdata(100,1:50) y<-rproc2fdata(100,1:50) dcor.xy(x, y,test=TRUE) dx <- metric.lp(x) dy <- metric.lp(y) dcor.test(dx, dy) bcdcor.dist(dx, dy) dcor.xy(x, y,test=FALSE) dcor.dist(dx, dy) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Computation of depth measures for functional data — depth.fdata","title":"Computation of depth measures for functional data — depth.fdata","text":"Several depth measures can computed functional data descriptive classification purposes.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computation of depth measures for functional data — depth.fdata","text":"","code":"depth.mode(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   metric = metric.lp,   h = NULL,   scale = FALSE,   draw = FALSE,   ... )  depth.RP(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   nproj = 50,   proj = \"vexponential\",   dfunc = \"TD1\",   par.dfunc = list(),   scale = FALSE,   draw = FALSE,   ... )  depth.RPD(   fdataobj,   fdataori = fdataobj,   nproj = 20,   proj = 1,   deriv = c(0, 1),   trim = 0.25,   dfunc2 = mdepth.LD,   method = \"fmm\",   draw = FALSE,   ... )  depth.RT(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   nproj = 10,   proj = 1,   xeps = 1e-07,   draw = FALSE,   ... )  depth.KFSD(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   h = NULL,   scale = FALSE,   draw = FALSE )  depth.FSD(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   scale = FALSE,   draw = FALSE )  depth.FM(   fdataobj,   fdataori = fdataobj,   trim = 0.25,   scale = FALSE,   dfunc = \"FM1\",   par.dfunc = list(scale = TRUE),   draw = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computation of depth measures for functional data — depth.fdata","text":"fdataobj set new curves evaluate depth. fdata class object. fdataori set reference curves respect depth computed.  fdata class object. trim alpha trimming. metric Metric function, default metric.lp. Distance matrix fdataobj fdataori. h Bandwidth, h>0. Default argument values provided 15%–quantile distance x xx. scale =TRUE, depth scaled respect depths fdataori. draw =TRUE, draw curves, sample median trimmed mean. ... arguments passed methods. depth.mode parameters metric. random projection depths, parameters included rproc2fdata included . nproj number projections. Ignored fdata class object provided proj proj fdata class, projections provided user. Otherwise, sigma parameter rproc2fdata function. dfunc type univariate depth function used inside depth function: \"FM1\" refers original Fraiman Muniz univariate depth (default), \"TD1\" Tukey (Halfspace),\"Liu1\" simplical depth, \"LD1\" Likelihood depth \"MhD1\" Mahalanobis 1D depth. Also, user function fulfilling following pattern FUN.USER(x,xx,...) returning dep component can included.f par.dfunc List parameters dfunc. deriv Number derivatives described integer vector deriv. =0 means derivative. dfunc2 Multivariate depth function (second step depth function) RPD depth, default mdepth.LD. user function pattern FUN.USER(x,xx,...) can employed. method Type derivative method. See fdata.deriv details. numeric: procedure considers argument value bandwidth. NULL: (default) bandwidth provided  15%–quantile distance among curves  fdataori. character:   string (like \"0.15\"), procedure reads numeric value consider quantile distance fdataori (second case). xeps Accuracy. left limit empirical distribution function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computation of depth measures for functional data — depth.fdata","text":"Return list : median: Deepest curve. lmed: Index deepest element median. mtrim: fdata class object average (1-trim)% deepest curves. ltrim: Indexes curves conform trimmed mean mtrim. dep: Depth curve fdataobj w.r.t. fdataori. dep.ori: Depth curve fdataori w.r.t. fdataori. proj: projection value point curves. dist: Distance matrix curves functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Computation of depth measures for functional data — depth.fdata","text":"Type depth functions: Fraiman Muniz (FM) depth, modal depth, random Tukey (RT), random projection (RP) depth double random projection depth (RPD). depth.FM: computes integration univariate depth along axis x (see Fraiman Muniz 2001). also known Integrated Depth. depth.mode: implements modal depth (see Cuevas et al 2007). depth.RT: implements Random Tukey depth (see Cuesta–Albertos Nieto–Reyes 2008). depth.RP: computes Random Projection depth (see Cuevas et al. 2007). depth.RPD: implements depth measure based random projections possibly using several derivatives (see Cuevas et al. 2007). depth.FSD: computes Functional Spatial Depth (see Sguera et al. 2014). depth.KFSD: implements Kernelized Functional Spatial Depth (see Sguera et al. 2014). depth.mode: calculates depth datum accounting number curves neighbourhood. default, distance calculated using metric.lp function although distance employed argument metric (general pattern USER.DIST(fdataobj,fdataori)). depth.RP: summarizes random projections averages whereas depth.RT function uses minimum projections. depth.RPD: involves original trajectories derivatives curve two steps. builds random projections function derivatives (indicated parameter deriv) applies depth function (default depth.mode) set random projections (default Tukey one). depth.FSD depth.KFSD: implementations default versions functional spatial depths proposed Sguera et al 2014. moment, possible change kernel second one.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Computation of depth measures for functional data — depth.fdata","text":"Cuevas, ., Febrero-Bande, M., Fraiman, R. (2007). Robust estimation classification functional data via projection-based depth notions. Computational Statistics 22, 3, 481-496. Fraiman R, Muniz G. (2001). Trimmed means functional data. Test 10: 419-440. Cuesta–Albertos, JA, Nieto–Reyes, . (2008) Random Tukey Depth. Computational Statistics Data Analysis Vol. 52, Issue 11, 4979-4988. Febrero-Bande, M, Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/ Sguera C, Galeano P, Lillo R (2014). Spatial depth based classification functional data. TEST 23(4):725–750.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computation of depth measures for functional data — depth.fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computation of depth measures for functional data — depth.fdata","text":"","code":"if (FALSE) { # \\dontrun{ #Ex: CanadianWeather data tt=1:365 fdataobj<-fdata(t(CanadianWeather$dailyAv[,,1]),tt) # Fraiman-Muniz Depth out.FM=depth.FM(fdataobj,trim=0.1,draw=TRUE) #Modal Depth out.mode=depth.mode(fdataobj,trim=0.1,draw=TRUE) out.RP=depth.RP(fdataobj,trim=0.1,draw=TRUE) out.RT=depth.RT(fdataobj,trim=0.1,draw=TRUE) out.FSD=depth.FSD(fdataobj,trim=0.1,draw=TRUE) out.KFSD=depth.KFSD(fdataobj,trim=0.1,draw=TRUE) ## Double Random Projections out.RPD=depth.RPD(fdataobj,deriv=c(0,1),dfunc2=mdepth.LD, trim=0.1,draw=TRUE) out<-c(out.FM$mtrim,out.mode$mtrim,out.RP$mtrim,out.RPD$mtrim) plot(fdataobj,col=\"grey\") lines(out) cdep<-cbind(out.FM$dep,out.mode$dep,out.RP$dep,out.RT$dep,out.FSD$dep,out.KFSD$dep) colnames(cdep)<-c(\"FM\",\"mode\",\"RP\",\"RT\",\"FSD\",\"KFSD\") pairs(cdep) round(cor(cdep),2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Provides the depth measure for multivariate data — depth.mdata","title":"Provides the depth measure for multivariate data — depth.mdata","text":"Compute measure centrality multivariate data. Type depth function: simplicial depth (SD), Mahalanobis depth (MhD), Random Half–Space depth (HS), random projection depth (RP) Likelihood Depth (LD).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provides the depth measure for multivariate data — depth.mdata","text":"","code":"mdepth.LD(x, xx = x, metric = metric.dist, h = NULL, scale = FALSE, ...)  mdepth.HS(x, xx = x, proj = 50, scale = FALSE, xeps = 1e-15, random = FALSE)  mdepth.RP(x, xx = x, proj = 50, scale = FALSE)  mdepth.MhD(x, xx = x, scale = FALSE)  mdepth.KFSD(x, xx = x, trim = 0.25, h = NULL, scale = FALSE, draw = FALSE)  mdepth.FSD(x, xx = x, trim = 0.25, scale = FALSE, draw = FALSE)  mdepth.FM(x, xx = x, scale = FALSE, dfunc = \"TD1\")  mdepth.TD(x, xx = x, xeps = 1e-15, scale = FALSE)  mdepth.SD(x, xx = NULL, scale = FALSE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provides the depth measure for multivariate data — depth.mdata","text":"x set points, d-column matrix. xx d-dimension multivariate reference sample (d-column matrix) x points evaluated. metric Metric function, default metric.dist. Distance matrix x xx computed. h Bandwidth, h>0. Default argument values provided 15%–quantile distance x xx. scale =TRUE, scale depth, see scale. ... arguments passed methods. proj directions random projections, default 500 random projections generated scaled runif(500,-1,1). xeps Accuracy. left limit empirical distribution function. random =TRUE random projections. =FALSE deterministic projections. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. dfunc type univariate depth function used inside depth function: \"FM1\" refers original Fraiman Muniz univariate depth (default), \"TD1\" Tukey (Halfspace),\"Liu1\" simplical depth, \"LD1\" Likelihood depth \"MhD1\" Mahalanobis 1D depth. Also, user function fulfilling following pattern FUN.USER(x,xx,...) returning dep component can included.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provides the depth measure for multivariate data — depth.mdata","text":"lmed: Index deepest element (median) xx. ltrim: Index set points x trimmed mean mtrim. dep: Depth point x respect xx. proj: projection value point onto set points. x: set points evaluated. xx: reference sample. name: Name depth method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Provides the depth measure for multivariate data — depth.mdata","text":"Type depth measures: mdepth.SD calculates simplicial depth (HD) points x w.r.t. xx (bivariate data). mdepth.HS function calculates random half–space depth (HS)  points x w.r.t. xx based random projections proj. mdepth.MhD function calculates Mahalanobis depth (MhD)  points x w.r.t. xx. mdepth.RP calculates random' projection depth (RP)  points x w.r.t. xx based random projections proj. mdepth.LD calculates Likelihood depth (LD) points x w.r.t. xx. mdepth.TD function provides Tukey depth measure multivariate data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Provides the depth measure for multivariate data — depth.mdata","text":"Liu, R. Y., Parelius, J. M., Singh, K. (1999). Multivariate analysis data depth: descriptive statistics, graphics inference,(discussion rejoinder Liu Singh). Annals Statistics, 27(3), 783-858.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Provides the depth measure for multivariate data — depth.mdata","text":"mdepth.RP, mdepth.MhD mdepth.HS versions created Manuel Febrero Bande Manuel Oviedo de la Fuente original version created Jun Li, Juan . Cuesta Albertos Regina Y. Liu polynomial classifier.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provides the depth measure for multivariate data — depth.mdata","text":"","code":"if (FALSE) { # \\dontrun{ data(iris) group<-iris[,5] x<-iris[,1:2]                                    MhD<-mdepth.MhD(x) PD<-mdepth.RP(x) HD<-mdepth.HS(x) SD<-mdepth.SD(x)  x.setosa<-x[group==\"setosa\",] x.versicolor<-x[group==\"versicolor\",]  x.virginica<-x[group==\"virginica\",] d1<-mdepth.SD(x,x.setosa)$dep d2<-mdepth.SD(x,x.versicolor)$dep d3<-mdepth.SD(x,x.virginica)$dep } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"function computes depth measure list p–functional data objects.  procedure extends Fraiman Muniz (FM), modal, random project depth functions 1 functional dataset p functional datasets.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"","code":"depth.modep(   mfdata,   mfdataref = mfdata,   h = NULL,   metric,   par.metric = list(),   method = \"euclidean\",   scale = FALSE,   trim = 0.25,   draw = FALSE,   ask = FALSE )  depth.RPp(   mfdata,   mfdataref = mfdata,   nproj = 50,   proj = \"vexponential\",   trim = 0.25,   dfunc = \"mdepth.TD\",   par.dfunc = list(scale = TRUE),   draw = FALSE,   ask = FALSE )  depth.FMp(   mfdata,   mfdataref = mfdata,   trim = 0.25,   dfunc = \"mdepth.MhD\",   par.dfunc = list(scale = FALSE),   draw = FALSE,   ask = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"mfdata list new curves (list fdata ojects) evaluate depth. mfdataref set reference curves (list fdata ojects) w.r.t. depth mfdata computed. h Bandwidth, h>0. Default argument values provided 15%–quantile distance fdataobj fdataori. metric Metric semi–metric function used compute distance element ldata w.r.t. ldataref, default metric.lp. par.metric list parameters metric function. method Type distance measure (default euclidean) compute metric p-distance matrix computed p functional data elements. scale =TRUE, scale depth. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. ask logical. TRUE (R session interactive) user asked input, new figure drawn. nproj number projection. proj character: create random projection using covariance matrix process indicated argument (default, proj=1, sigma=diag(ncol(fdataobj))), else matrix random projection provided user. dfunc Type multivariate depth (order p) function used Framiman Muniz depth, depth.FMp Random Projection depth,depth.FMp: : mdepth.SD function provides simplicial depth measure bivariate data. mdepth.LD function provides Likelihood depth measure based Nadaraya–Watson estimator empirical density function. mdepth.HS function implements half-space depth measure based random projections. mdepth.TD function implements Tukey depth measure. mdepth.MhDfunction implements Mahalanobis depth measure. mdepth.RP function provides depth measure using random projections multivariate data. par.dfunc list parameters dfunc depth function, see Depth.Multivariate. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"lmed: Index deepest element median. ltrim: Index curves trimmed mean mtrim. dep: Depth curve fdataobj w.r.t. fdataori. dfunc: Second depth function used multivariate depth, see details section. par.dfunc: List parameters dfunc depth function. proj: projection value point curves. dist: Distance matrix curves functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"depth.FMp, procedure suposes curve mfdataobj support [0,T] (argvals rangeval).  FMp depth defined : \\(FM_i^p =\\int_{0}^{T}Z_i^p(t)dt\\) \\(Z_i^p(t)\\) \\(p\\)–variate depth vector \\((x_i^1(t),\\ldots,x_i^p(t))\\) w.r.t. sample \\(t\\).  derivatives. case,note solo un dato funcional se reduce depth.FM=depth.FM1 depth.RPp function calculates depth two steps. builds random projections curve mfdata w.r.t. curve mfdataref object. applyes multivariate depth function specified dfunc argument set random projections.  procedure generalization Random Projection derivatives (RPD) implemented depth.RPD function. Now, procedure computes p-variate depth projections using \\(p\\) functional dataset. modal depth depth.modep function calculates depth three steps.  First, function calculates suitable metrics semi–metrics \\(m_1+\\cdots+m_p\\) curve mfdata w.r.t. curve mfdataref object using metric par.metric arguments, see metric.lp semimetric.NPFDA details.  Second, function uses \\(p\\)–dimensional metrics construct new metric, specified method argument, default method=\"euclidean\", .e. \\(m:=\\sqrt{m_1^2+\\cdots+m_p^2}\\). Finally, empirical h–depth computed : $$\\hat{f}_h(x_0)=N^{-1}\\sum_{=1}^{N}{K(m/h)}$$ \\(x\\) dataset p observed fucntional data, \\(m\\) suitable metric semi–metric, \\(K(t)\\) asymmetric kernel function h bandwidth parameter.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"Cuevas, ., Febrero-Bande, M. Fraiman, R. (2007). Robust estimation classification functional data via projection-based depth notions. Computational Statistics 22, 3, 481-496.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/depth.mfdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provides the depth measure for a list of p–functional data objects — depth.mfdata","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) xx<-tecator$absorp xx1<-fdata.deriv(xx,1) lx<-list(xx=xx,xx=xx1) # Fraiman-Muniz Depth par.df<-list(scale =TRUE) out.FM1p=depth.FMp(lx,trim=0.1,draw=TRUE, par.dfunc = par.df) out.FM2p=depth.FMp(lx,trim=0.1,dfunc=\"mdepth.LD\", par.dfunc = par.df, draw=TRUE)  # Random Project Depth out.RP1p=depth.RPp(lx,trim=0.1,dfunc=\"mdepth.TD\", draw=TRUE,par.dfunc = par.df) out.RP2p=depth.RPp(lx,trim=0.1,dfunc=\"mdepth.LD\", draw=TRUE,par.dfunc = par.df)  #Modal Depth out.mode1p=depth.modep(lx,trim=0.1,draw=T,scale=T) out.mode2p=depth.modep(lx,trim=0.1,method=\"manhattan\", draw=T,scale=T)  par(mfrow=c(2,3)) plot(out.FM1p$dep,out.FM2p$dep) plot(out.RP1p$dep,out.RP2p$dep) plot(out.mode1p$dep,out.mode2p$dep) plot(out.FM1p$dep,out.RP1p$dep) plot(out.RP1p$dep,out.mode1p$dep) plot(out.FM1p$dep,out.mode1p$dep) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":null,"dir":"Reference","previous_headings":"","what":"Descriptive measures for functional data. — Descriptive","title":"Descriptive measures for functional data. — Descriptive","text":"Central dispersion measures functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Descriptive measures for functional data. — Descriptive","text":"","code":"func.mean(x)  func.var(fdataobj)  func.trim.FM(fdataobj, ...)  func.trim.mode(fdataobj, ...)  func.trim.RP(fdataobj, ...)  func.trim.RT(fdataobj, ...)  func.trim.RPD(fdataobj, ...)  func.med.FM(fdataobj, ...)  func.med.mode(fdataobj, ...)  func.med.RP(fdataobj, ...)  func.med.RT(fdataobj, ...)  func.med.RPD(fdataobj, ...)  func.trimvar.FM(fdataobj, ...)  func.trimvar.mode(fdataobj, ...)  func.trimvar.RP(fdataobj, ...)  func.trimvar.RPD(fdataobj, ...)  func.trim.RT(fdataobj, ...)  func.med.RT(fdataobj, ...)  func.trimvar.RT(fdataobj, ...)  func.mean.formula(formula, data = NULL, ..., drop = FALSE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Descriptive measures for functional data. — Descriptive","text":"x fdata ldata  class object. fdataobj fdata class object. ... arguments passed methods.  argument p passed, used metric.lp function, default p=2. argument trim (alpha trimming) passed, used metric.lp function. argument deriv (number derivatives use) passed. parameter used depth.RPD function, default uses deriv =(0,1). formula formula, y ~ group, y fdata object split groups according grouping variable group (usually factor). data List containing variables formula. item called \"df\" data frame grouping variable. item called \"y\" fdata object. drop logical indicating levels occur dropped (f factor list).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Descriptive measures for functional data. — Descriptive","text":"func.mean.formula value returned split list fdata containing mean curves groups. components list named levels f (converting factor, already factor drop = TRUE, dropping unused levels).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Descriptive measures for functional data. — Descriptive","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Descriptive measures for functional data. — Descriptive","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Descriptive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Descriptive measures for functional data. — Descriptive","text":"","code":"if (FALSE) { # \\dontrun{ #' # Example with Montreal Daily Temperature (fda-package) fdataobj<-fdata(MontrealTemp)  # Measures of central tendency by group fac<-factor(c(rep(1,len=17),rep(2,len=17))) ldata=list(\"df\"=data.frame(fac),\"fdataobj\"=fdataobj) a1<-func.mean.formula(fdataobj~fac,data=ldata) plot(a1)  # Measures of central tendency a1<-func.mean(fdataobj) a2<-func.trim.FM(fdataobj) a3<-func.trim.mode(fdataobj) a4<-func.trim.RP(fdataobj) # a5<-func.trim.RPD(fdataobj,deriv=c(0,1)) # Time-consuming a6<-func.med.FM(fdataobj) a7<-func.med.mode(fdataobj) a8<-func.med.RP(fdataobj) # a9<-func.med.RPD(fdataobj,deriv=c(0,1)) # Time-consuming # a10<-func.med.RT(fdataobj)  par(mfrow=c(1,2)) plot(c(a1,a2,a3,a4),ylim=c(-26,29),main=\"Central tendency: trimmed mean\") plot(c(a1,a6,a7,a8),ylim=c(-26,29),main=\"Central tendency: median\")  ## Measures of dispersion b1<-func.var(fdataobj) b2<-func.trimvar.FM(fdataobj) b3<-func.trimvar.FM(fdataobj,trim=0.1) b4<-func.trimvar.mode(fdataobj) b5<-func.trimvar.mode(fdataobj,p=1) b6<-func.trimvar.RP(fdataobj) b7<-func.trimvar.RPD(fdataobj) b8<-func.trimvar.RPD(fdataobj) b9<-func.trimvar.RPD(fdataobj,deriv=c(0,1)) dev.new() par(mfrow=c(1,2)) plot(c(b1,b2,b3,b4,b5),ylim=c(0,79),main=\"Measures of dispersion I\") plot(c(b1,b6,b7,b8,b9),ylim=c(0,79),main=\"Measures of dispersion II\") } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":null,"dir":"Reference","previous_headings":"","what":"The deviance score — dev.S","title":"The deviance score — dev.S","text":"Returns deviance fitted model object GCV score.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The deviance score — dev.S","text":"","code":"dev.S(   y,   S,   obs,   family = gaussian(),   off,   offdf,   criteria = \"GCV\",   W = diag(1, ncol = ncol(S), nrow = nrow(S)),   trim = 0,   draw = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The deviance score — dev.S","text":"y Matrix set cases dimension (n x m), n number curves m points observed curve. S Smoothing matrix. obs observed response. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) offdf , degrees freedom criteria penalizing function. default \"Rice\" criteria. Possible values \"GCV\", \"AIC\", \"FPE\", \"Shibata\", \"Rice\". W Matrix weights. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The deviance score — dev.S","text":"Returns GCV score calculated input parameters.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The deviance score — dev.S","text":"constant, minus twice maximized log-likelihood. sensible, constant chosen saturated model deviance zero. $$GCV(h)=p(h) \\Xi(n^{-1}h^{-1})$$  $$p(h)=\\frac{1}{n} \\sum_{=1}^{n}{\\Big(y_i-r_{}(x_i)\\Big)^{2}w(x_i)}$$  penalty function $$\\Xi()$$ can selected following criteria: Generalized Cross-validation (GCV): $$\\Xi_{GCV}(n^{-1}h^{-1})=(1-n^{-1}S_{ii})^{-2}$$  Akaike's Information Criterion (AIC): $$\\Xi_{AIC}(n^{-1}h^{-1})=exp(2n^{-1}S_{ii})$$ Finite Prediction Error (FPE) $$\\Xi_{FPE}(n^{-1}h^{-1})=\\frac{(1+n^{-1}S_{ii})}{(1-n^{-1}S_{ii})}$$ Shibata's model selector (Shibata): $$\\Xi_{Shibata}(n^{-1}h^{-1})=(1+2n^{-1}S_{ii})$$ Rice's bandwidth selector (Rice): $$\\Xi_{Rice}(n^{-1}h^{-1})=(1-2n^{-1}S_{ii})^{-1}$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The deviance score — dev.S","text":"Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The deviance score — dev.S","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dev.S.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The deviance score — dev.S","text":"","code":"data(phoneme) mlearn<-phoneme$learn np<-ncol(mlearn) tt<-mlearn[[\"argvals\"]] S1 <- S.NW(tt,2.5) gcv1 <- dev.S(mlearn$data[1,],obs=(sample(150)),  S1,off=rep(1,150),offdf=3) gcv2 <- dev.S(mlearn$data[1,],obs=sort(sample(150)),  S1,off=rep(1,150),offdf=3)"},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"function dfv.test tests null hypothesis interaction functional covariate scalar response general framework. null hypothesis $$H_0:\\,m(X)=0,$$ \\(m(\\cdot)\\) denotes regression function functional variate \\(X\\) centred scalar response \\(Y\\) (\\(E[Y]=0\\)). null hypothesis tested smoothed integrated square error response (see Details).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"","code":"dfv.statistic(   X.fdata,   Y,   h = quantile(x = metric.lp(X.fdata), probs = c(0.05, 0.1, 0.15, 0.25, 0.5)),   K = function(x) 2 * dnorm(abs(x)),   weights = rep(1, dim(X.fdata$data)[1]),   d = metric.lp,   dist = NULL )  dfv.test(   X.fdata,   Y,   B = 5000,   h = quantile(x = metric.lp(X.fdata), probs = c(0.05, 0.1, 0.15, 0.25, 0.5)),   K = function(x) 2 * dnorm(abs(x)),   weights = rep(1, dim(X.fdata$data)[1]),   d = metric.lp,   verbose = TRUE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"X.fdata Functional covariate. object must class fdata. Y Scalar response. Must vector number elements functions X.fdata. h Bandwidth parameter kernel smoothing. crucial parameter affects power performance test. One possibility choose considering Cross-validatory bandwidth nonparametric functional regression, given function fregre.np (see Examples). possibility consider grid bandwidths. default option, considering grid given quantiles 0.05, 0.10, 0.15, 0.25 0.50 functional \\(L^2\\) distances data. K Kernel function. specified taken rescaled right part normal density. weights vector weights sample data. default uniform weights rep(1,dim(X.fdata$data)[1]). d Semimetric use kernel smoothers. default \\(L^2\\) distance given metric.lp. dist Matrix distances functional data, used save time bootstrap calibration. given, matrix automatically computed using semimetric d. B Number bootstrap replicates calibrate distribution test statistic. B=5000 replicates recommended carry test, although exploratory analysis (inferential), acceptable less time-consuming option B=500. verbose Either show information computing progress.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"value dfv.statistic vector length length(h) values  statistic bandwidth. value dfv.test object class  \"htest\" whose underlying structure list containing following components: statistic: value Delsol, Ferraty Vieu test statistic. boot.statistics: vector length B values bootstrap test statistics. p.value: p-value test. method: character string \"Delsol, Ferraty Vieu test functional-scalar interaction\". B: number bootstrap replicates used. h: Bandwidth parameters test. K: Kernel function used. weights: weights considered. d: Matrix distances functional data. data.name: character string \"Y=0+e\".","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"Delsol, Ferraty Vieu statistic defined $$T_n=\\int\\bigg(\\sum_{=1}^n(Y_i-m(X_i))K\\bigg(\\frac{d(X,X_i)}{h}\\bigg)\\bigg)^2\\omega(X)dP_X(X)$$ case interaction centred scalar response (\\(H_0:\\,m(X)=0\\) holds), sample version computed $$T_n=\\frac{1}{n}\\sum_{j=1}^n\\bigg(\\sum_{=1}^n Y_iK\\bigg(\\frac{d(X_j,X_i)}{h}\\bigg)\\bigg)^2\\omega(X_j).$$ sample version implemented consider splitting sample, authors comment paper. statistic computed function dfv.statistic , applying test, response \\(Y\\) centred. distribution test statistic approximated wild bootstrap residuals, using golden section bootstrap. Please note grid bandwidths passed, harmless warning message prompt end test (comes returning several p-values htest class).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"NA's allowed neither functional covariate scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"Delsol, L., Ferraty, F. Vieu, P. (2011). Structural test regression functional variables. Journal Multivariate Analysis, 102, 422-447. doi:10.1016/j.jmva.2010.10.003 Delsol, L. (2013). effect tests regression functional variable applications spectrometric studies. Computational Statistics, 28(4), 1775-1811. doi:10.1007/s00180-012-0378-1","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"Eduardo Garcia-Portugues. Please, report bugs suggestions  eduardo.garcia.portugues@uc3m.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dfv.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Delsol, Ferraty and Vieu test for no functional-scalar interaction — dfv.test","text":"","code":"if (FALSE) { # \\dontrun{ ## Simulated example ## X=rproc2fdata(n=50,t=seq(0,1,l=101),sigma=\"OU\")  beta0=fdata(mdata=rep(0,length=101)+rnorm(101,sd=0.05), argvals=seq(0,1,l=101),rangeval=c(0,1)) beta1=fdata(mdata=cos(2*pi*seq(0,1,l=101))-(seq(0,1,l=101)-0.5)^2+ rnorm(101,sd=0.05),argvals=seq(0,1,l=101),rangeval=c(0,1))  # Null hypothesis holds Y0=drop(inprod.fdata(X,beta0)+rnorm(50,sd=0.1))  # Null hypothesis does not hold Y1=drop(inprod.fdata(X,beta1)+rnorm(50,sd=0.1))  # We use the CV bandwidth given by fregre.np # Do not reject H0 dfv.test(X,Y0,h=fregre.np(X,Y0)$h.opt,B=100) # dfv.test(X,Y0,B=5000)  # Reject H0 dfv.test(X,Y1,B=100) # dfv.test(X,Y1,B=5000) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Proximities between functional data — dis.cos.cor","title":"Proximities between functional data — dis.cos.cor","text":"Computes cosine correlation distance two functional dataset class fdata.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proximities between functional data — dis.cos.cor","text":"","code":"dis.cos.cor(fdata1, fdata2 = NULL, as.dis = FALSE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proximities between functional data — dis.cos.cor","text":"fdata1 Functional data 1 curve 1. fdata2 Functional data 2 curve 2. .dis Returns distance matrix como 1-cor(fdata1,fdata2).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Proximities between functional data — dis.cos.cor","text":"Returns proximity/distance matrix (depending .dis)  functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Proximities between functional data — dis.cos.cor","text":"Kemmeren P, van Berkum NL, Vilo J, et al. (2002). Protein Interaction Verification Functional Annotation Integrated Analysis Genome-Scale Data . Mol Cell. 2002 9(5):1133-43.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/dis.cos.cor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Proximities between functional data — dis.cos.cor","text":"","code":"if (FALSE) { # \\dontrun{  r1<-rnorm(1001,sd=.01)  r2<-rnorm(1001,sd=.01)  x<-seq(0,2*pi,length=1001)  fx<-fdata(sin(x)/sqrt(pi)+r1,x)  dis.cos.cor(fx,fx)  dis.cos.cor(c(fx,fx),as.dis=TRUE)  fx0<-fdata(rep(0,length(x))+r2,x)  plot(c(fx,fx0))  dis.cos.cor(c(fx,fx0),as.dis=TRUE)  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":null,"dir":"Reference","previous_headings":"","what":"ANOVA for heteroscedastic data — fanova.hetero","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"Univariate ANOVA heteroscedastic data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"","code":"fanova.hetero(object = NULL, formula, pr = FALSE, contrast = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"object data frame dimension (n x p+1).  first column contains n response values following p columns explanatory variables specified formula. formula formula. pr TRUE, print intermediate results. contrast List special contrast used, default special contrasts used (contrast=NULL). ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"Return: ans: list components including: Beta estimation Est, factor degrees freedom df1, residual degrees freedom df2, p-value factor. contrast: List special contrasts.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"function fits univariate analysis variance model allows calculate special contrasts defined user.  list special contrast used factors formula.  matrix list r rows r-1 columns. user can also request special predetermined contrasts, example using contr.helmert, contr.sum contr.treatment functions.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"anova.hetero deprecated works categorical variables.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"Brunner, E., Dette, H., Munk, . Box-Type Approximations Nonparametric Factorial Designs. Journal American Statistical Association, Vol. 92, . 440 (Dec., 1997), pp. 1494-1502.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.hetero.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ANOVA for heteroscedastic data — fanova.hetero","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) ind=1 # beetwen 1:150 fdataobj=data.frame(phoneme$learn[[\"data\"]][,ind]) n=dim(fdataobj)[1] group<-factor(phoneme$classlearn)  #ex 1: real factor and random factor group.rand=as.factor(sample(rep(1:3,n),n)) f=data.frame(group,group.rand) mm=data.frame(fdataobj,f) colnames(mm)=c(\"value\",\"group\",\"group.rand\") out1=fanova.hetero(object=mm[,-2],value~group.rand,pr=FALSE) out2=fanova.hetero(object=mm[,-3],value~group,pr=FALSE) out1 out2  #ex 2: real factor, random factor and  special contrasts cr5=contr.sum(5)  #each level vs last level cr3=c(1,0,-1)      #first level vs last level out.contrast=fanova.hetero(object=mm[,-3],value~group,pr=FALSE, contrast=list(group=cr5)) out.contrast } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":null,"dir":"Reference","previous_headings":"","what":"One–way anova model for functional data — fanova.onefactor","title":"One–way anova model for functional data — fanova.onefactor","text":"One–way anova model k independent samples functional data. function contrasts null hypothesis equality mean functions functional data based asymptotic version anova F–test. $$H_0:\\, m_1=\\ldots=m_k$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"One–way anova model for functional data — fanova.onefactor","text":"","code":"fanova.onefactor(   object,   group,   nboot = 100,   plot = FALSE,   verbose = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"One–way anova model for functional data — fanova.onefactor","text":"object functional response data.  fdata class object n curves. group factor specifying class curve. nboot number bootstrap samples. plot TRUE, plot mean factor level results test. verbose TRUE, print intermediate results. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"One–way anova model for functional data — fanova.onefactor","text":"Returns: p-value: Probability rejecting null hypothesis H0 significance level. stat: Statistic value test. wm: Statistic values bootstrap resamples.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"One–way anova model for functional data — fanova.onefactor","text":"function returns p–value  test using one–way anova model nboot runs.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"One–way anova model for functional data — fanova.onefactor","text":"anova.onefactor deprecated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"One–way anova model for functional data — fanova.onefactor","text":"Cuevas, ., Febrero, M., & Fraiman, R. (2004). anova test functional data. Computational statistics & data analysis, 47(1), 111-122.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"One–way anova model for functional data — fanova.onefactor","text":"Juan . Cuesta-Albertos, Manuel Febrero-Bande, Manuel Oviedo de la Fuentemanuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.onefactor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"One–way anova model for functional data — fanova.onefactor","text":"","code":"if (FALSE) { # \\dontrun{ data(MCO) grupo<-MCO$classintact datos<-MCO$intact res=fanova.onefactor(datos,grupo,nboot=50,plot=TRUE) grupo <- MCO$classpermea datos <- MCO$permea res=fanova.onefactor(datos,grupo,nboot=50,plot=TRUE) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional ANOVA with Random Project. — fanova.RPm","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"procedure based analysis randomly chosen one-dimensional projections. function tests ANOVA models functional data continuous covariates perform special contrasts factors formula.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"","code":"fanova.RPm(   object,   formula,   data.fac,   RP = min(30, ncol(object)),   alpha = 0.95,   zproj = NULL,   par.zproj = list(norm = TRUE),   hetero = TRUE,   pr = FALSE,   w = rep(1, ncol(object)),   nboot = 0,   contrast = NULL,   ... )  # S3 method for class 'fanova.RPm' summary(object, ndec = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"object Functional response data.  Object class fdata n curves discretizated m points. multivariate problems object can data.frame matrix formula formula without response. data.fac Explanatory variables.  Data frame dimension (n x p), p number factors covariates considered. RP Vector number random projections. alpha Confidence level, default alpha=0.95. zproj Function generating projections object contains projections. par.zproj List parameters zproj function. hetero logical. TRUE (default) means heteroskedastic ANOVA. pr logical. TRUE prints intermediate results. w Vector weights (multivariate problems). nboot Number bootstrap samples, default bootstrap computations, nboot=0. contrast List special contrast used ; default special contrasts used (contrast=NULL). ... arguments passed methods. ndec Number decimals.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"object following components: proj: projection value point curves. Matrix dimensions (RP x m), RP number projections m number points observed projection curve. mins: Minimum number random projection. result: p-value random projection. test.Bonf: Significance (TRUE FALSE) vector random projections RP columns factors (special contrasts) rows. p.Bonf: p-value vector random projections RP columns factors (special contrasts) rows. test.fdr: False Discovery Rate (TRUE FALSE) vector random projections RP columns factors (special contrasts) rows. p.fdr: p-value False Discovery Rate vector random projections RP columns factors (special contrasts) rows. test.Boot: False Discovery Rate (TRUE FALSE) vector random projections RP columns factors (special contrasts) rows. p.Boot: p-value Bootstrap sample vector random projections RP columns factors (special contrasts) rows.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"zproj allows change generator process projections. can done inclusion function collection projections generated outside function. default, functional problem, function rproc2fdata used. multivariate problems, function included, projections generated normalized gaussian process dimension object. user function can included limitation two first parameters : n: number projections t: discretization points functional problems m: number columns multivariate problems. functions must return fdata matrix object respectively. function allows user-defined contrasts.  list contrast used factors formula.  contrast matrix list r rows, r number factor levels. user can also request special predetermined contrasts, example using contr.helmert, contr.sum contr.treatment functions. function returns (default) significance variables using Bonferroni test False Discovery Rate test. Bootstrap procedure provides precision","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"anova.RPm deprecated. hetero=TRUE factors must categorical.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"Cuesta-Albertos, J.., Febrero-Bande, M. simple multiway ANOVA functional data. TEST 2010, DOI 10.1007/s11749-010-0185-3.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"Juan . Cuesta-Albertos, Manuel Febrero-Bande, Manuel Oviedo de la Fuentemanuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fanova.RPm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional ANOVA with Random Project. — fanova.RPm","text":"","code":"if (FALSE) { # \\dontrun{ # ex fanova.hetero data(phoneme) names(phoneme) # A MV matrix obtained from functional data data=as.data.frame(phoneme$learn$data[,c(1,seq(0,150,10)[-1])])  group=phoneme$classlearn n=nrow(data) group.rand=as.factor(sample(rep(1:3,len=n),n)) RP=c(2,5,15,30)  #ex 1: real factor and random factor m03=data.frame(group,group.rand) resul1=fanova.RPm(phoneme$learn,~group+group.rand,m03,RP=c(5,30)) summary(resul1)  #ex 2: real factor with special contrast m0=data.frame(group) cr5=contr.sum(5)   #each level vs last level resul03c1=fanova.RPm(data,~group,m0,contrast=list(group=cr5)) summary(resul03c1)  #ex 3: random factor with special contrast. Same projs as ex 2. m0=data.frame(group.rand) zz=resul03c1$proj cr3=contr.sum(3)   #each level vs last level resul03c1=fanova.RPm(data,~group.rand,m0,contrast=list(group.rand=cr3),zproj=zz) summary(resul03c1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Data Analysis and Utilities for Statistical Computing (fda.usc) — fda.usc-package","title":"Functional Data Analysis and Utilities for Statistical Computing (fda.usc) — fda.usc-package","text":"devel version carries exploratory descriptive analysis functional data exploring important features: depth measurements functional outliers detection, among others.  also helps explain model relationship dependent variable independent (regression models) make predictions. Methods supervised unsupervised classification set functional data regarding feature data also included. Finally, can perform analysis variance model (ANOVA) functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Data Analysis and Utilities for Statistical Computing (fda.usc) — fda.usc-package","text":"Sections fda.usc-package: .- Functional Data Representation  functions included section allow define, transform, manipulate represent functional dataset many ways including derivatives, non-parametric kernel methods basis representation. B.- Functional Depth Functional Outlier Detection functional data depth calculated different depth functions implemented use measure centrality outlyingness. B.1-Depth methods Depth: B.2-Functional Outliers detection methods: C.- Functional Regression Models C.1. Functional explanatory covariate scalar response functions included section allow estimation different functional regression models scalar response single functional explicative covariate. C.2. Test functional linear model (FLM) scalar response. C.3. Functional non functional explanatory covariates. functions section extends regression models previous section several ways. C.4. Functional response model (fregre.basis.fr) allows estimation functional regression models functional response single functional explicative covariate. C.5. fregre.gls fits functional linear model using generalized least squares.  fregre.igls fits iteratively functional linear model using generalized least squares. C.6. fregre.gsam.vs, Variable Selection using Functional Additive Models D.- Functional Supervised Classification  section allows estimation groups training set functional data fdata class different nonparametric methods supervised classification. classifiers trained, can used predict new functional data. Package allows estimation groups training set functional data different methods supervised classification. D.1 Univariate predictor (x,y arguments, fdata class) D.2 Multiple predictors (formula,data arguments, ldata class) D.3 Depth classifiers (fdata ldata class) D.4 Functional Classification usign k-fold CV E.- Functional Non-Supervised Classification  section allows estimation groups functional data set fdata class kmeans method. F.- Functional ANOVA G.- Utilities auxiliary functions:","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Data Analysis and Utilities for Statistical Computing (fda.usc) — fda.usc-package","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. doi:10.18637/jss.v051.i04","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Data Analysis and Utilities for Statistical Computing (fda.usc) — fda.usc-package","text":"Authors: Manuel Febrero Bande manuel.febrero@usc.es Manuel Oviedo de la Fuente manuel.oviedo@udc.es Contributors: Pedro Galeano, Alicia Nieto-Reyes, Eduardo Garcia-Portugues STAPH group https://www.math.univ-toulouse.fr/~ferraty/ Maintainer: Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":null,"dir":"Reference","previous_headings":"","what":"fda.usc internal functions — fda.usc.internal","title":"fda.usc internal functions — fda.usc.internal","text":"Internal undocumentation functions fda.usc package.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fda.usc internal functions — fda.usc.internal","text":"","code":"trace.matrix(x, na.rm = TRUE)  argvals.equi(tt)  # S3 method for class 'fdata' fdata1 + fdata2  # S3 method for class 'fdata' fdata1 - fdata2  # S3 method for class 'fdata' fdata1 * fdata2  # S3 method for class 'fdata' fdata1/fdata2  # S3 method for class 'fdata' fdataobj[i = TRUE, j = TRUE, drop = FALSE]  # S3 method for class 'fdata' fdata1 != fdata2  # S3 method for class 'fdata' fdata1 == fdata2  # S3 method for class 'fdata' fdataobj^pot  # S3 method for class 'fdata' dim(x)  ncol.fdata(x)  nrow.fdata(x)  # S3 method for class 'fdata' length(x)  NROW.fdata(x)  NCOL.fdata(x)  rownames.fdata(x)  colnames.fdata(x)  # S3 method for class 'fdata' c(...)  argvals(fdataobj)  rangeval(fdataobj)  # S3 method for class 'fdist' fdataobj[i = TRUE, j = TRUE, drop = FALSE]  # S3 method for class 'fdata' is.na(x)  # S3 method for class 'fdata' anyNA(x, recursive = FALSE)  count.na.fdata(x)  unlist_fdata(x, recursive = TRUE, use.names = TRUE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"fda.usc internal functions — fda.usc.internal","text":"x matrix fdata class object. na.rm logical. missing values (including NaN) removed? tt Argvals fdataobj, fdata1, fdata2 fdata class object. , j Indices specifying elements extract, replace. Indices numeric character vectors empty drop fdata class object. TRUE result coerced lowest possible dimension  element data. works extracting elements, replacement. pot Numeric value exponentiation. ... fdata objects concatenated. recursive anyNA applied recursively lists pairlists?  ( anyNA.fdata function) logical unlisting applied list components x? (unlist_fdata function). use.names logical names preserved?","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"fda.usc internal functions — fda.usc.internal","text":"argvals.equi function returns TRUE argvals equispaced FALSE othercase.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"fda.usc internal functions — fda.usc.internal","text":"\"Ops\" functions \"+.fdata\", \"-.fdata\", \"*.fdata\" \"/.fdata\": lengths objects fdata1 fdata2 may different operates recycled minimum size necessary.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fda.usc.internal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"fda.usc internal functions — fda.usc.internal","text":"Febrero-Bande,  M., Oviedo de la Fuente, M. (2012).  Statistical Computing  Functional Data Analysis: R Package fda.usc.  Journal Statistical Software,  51(4), 1-28. doi:10.18637/jss.v051.i04","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap samples of a functional statistic — fdata.bootstrap","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"provides bootstrap samples functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"","code":"fdata.bootstrap(   fdataobj,   statistic = func.mean,   alpha = 0.05,   nb = 200,   smo = 0,   draw = FALSE,   draw.control = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"fdataobj fdata class object. statistic Sample statistic. must function returns object class fdata. default, uses sample mean func.mean.  See Descriptive statistics. alpha Significance value. nb Number bootstrap resamples. smo smoothing parameter bootstrap samples proportion sample variance matrix. draw TRUE, plot bootstrap samples statistic. draw.control List specifies col, lty lwd objects: fdataobj, statistic, . ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"statistic: fdata class object statistic estimate nb bootstrap samples. dband: Bootstrap estimate (1-alpha)% distance. rep.dist: Distance every replicate. resamples: fdata class object bootstrap resamples. fdataobj: fdata class object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"fdata.bootstrap computes confidence ball using bootstrap following way: Let \\(X_1(t),\\ldots,X_n(t)\\) original data \\(T=T(X_1(t),\\ldots,X_n(t))\\) sample statistic. Calculate nb bootstrap resamples \\(\\left\\{X_{1}^{*}(t),\\cdots,X_n^*(t)\\right\\}\\), using following scheme: $$X_i^*(t)=X_i(t)+Z(t)$$ \\(Z(t)\\) normally distributed mean 0 covariance matrix \\(\\gamma\\Sigma_x\\), \\(\\Sigma_x\\) covariance matrix \\(\\left\\{X_1(t),\\ldots,X_n(t)\\right\\}\\) \\(\\gamma\\) smoothing parameter. Let \\(T^{*j}=T(X^{*j}_1(t),...,X^{*j}_n(t))\\) estimate using \\(j\\) resample. Compute \\(d(T,T^{*j})\\), \\(j=1,\\ldots,nb\\). Define bootstrap confidence ball level \\(1-\\alpha\\) \\(CB(\\alpha)=X\\E\\) \\(d(T,X)\\leq d_{\\alpha}\\) \\(d_{\\alpha}\\) quantile \\((1-\\alpha)\\) distances bootstrap resamples sample estimate. fdata.bootstrap function allows us define statistic calculated nb resamples, control degree smoothing smo argument represent confidence ball level \\(1-\\alpha\\) resamples fulfill condition belonging \\(CB(\\alpha)\\).  statistic used default mean (func.mean) also depth-based functions can used (see help(Descriptive)).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"Cuevas ., Febrero-Bande, M. Fraiman, R. (2007). Robust estimation classification functional data via projection-based depth notions. Computational Statistics 22, 3: 481-496. Cuevas ., Febrero-Bande, M., Fraiman R. 2006.  use bootstrap estimating functions functional data. Computational Statistics Data Analysis 51: 1063-1074. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.bootstrap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bootstrap samples of a functional statistic — fdata.bootstrap","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp<-tecator$absorp.fdata # Time consuming #Bootstrap for Trimmed Mean with depth mode out.boot=fdata.bootstrap(absorp,statistic=func.trim.FM,nb=200,draw=TRUE) names(out.boot) #Bootstrap for Median with with depth mode control=list(\"col\"=c(\"grey\",\"blue\",\"cyan\"),\"lty\"=c(2,1,1),\"lwd\"=c(1,3,1)) out.boot=fdata.bootstrap(absorp,statistic=func.med.mode, draw=TRUE,draw.control=control) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"function fdata.cen centres curves subtracting functional mean.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"","code":"fdata.cen(fdataobj, meanX = func.mean(fdataobj))"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"fdataobj fdata class object. meanX functional mean subtracted fdatobj.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"Return: two fdata class objects : Xcen centered fdata. meanX Functional mean substracted.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.cen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional data centred (subtract the mean of each discretization point) — fdata.cen","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme[[\"learn\"]][13:15,] fdata.c=fdata.cen(mlearn)$Xcen par(mfrow=c(1,2)) plot(mlearn,type=\"l\") plot(fdata.c,type=\"l\") } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the derivative of functional data object. — fdata.deriv","title":"Computes the derivative of functional data object. — fdata.deriv","text":"Computes derivative functional data. method =\"bspline\", \"exponential\", \"fourier\", \"monomial\" \"polynomial\".  fdata.deriv function creates basis represent functional data. functional data converted class fd using Data2fd function basis indicated method. Finally, function calculates derivative order nderiv curves using deriv.fd function. method=\"fmm\", \"periodic\", \"natural\" \"monoH.FC\" used splinefun function. method=\"diff\", raw derivation applied.  recommended use method values equally spaced.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the derivative of functional data object. — fdata.deriv","text":"","code":"fdata.deriv(   fdataobj,   nderiv = 1,   method = \"bspline\",   class.out = \"fdata\",   nbasis = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the derivative of functional data object. — fdata.deriv","text":"fdataobj fdata class object. nderiv Order derivation, defalult nderiv=1. method Type derivative method, information see details. class.Class functional data returned: fdata fd class. nbasis Number Basis fdatataobj\\$DATA. used method =\"bspline\", \"exponential\", \"fourier\", \"monomial\" \"polynomial\" ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes the derivative of functional data object. — fdata.deriv","text":"Returns derivative functional data fd class class.=\"fd\"  fdata class class.=\"fdata\".","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes the derivative of functional data object. — fdata.deriv","text":"","code":"data(tecator) absorp=tecator$absorp.fdata tecator.fd1=fdata2fd(absorp) tecator.fd2=fdata2fd(absorp,\"fourier\",9) tecator.fd3=fdata2fd(absorp,\"fourier\",nbasis=9,nderiv=1) #tecator.fd1;tecator.fd2;tecator.fd3 tecator.fdata1=fdata(tecator.fd1) tecator.fdata2=fdata(tecator.fd2) tecator.fdata3=fdata(tecator.fd3) tecator.fdata4=fdata.deriv(absorp,nderiv=1,method=\"bspline\", class.out='fdata',nbasis=9) tecator.fd4=fdata.deriv(tecator.fd3,nderiv=0,class.out='fd',nbasis=9) plot(tecator.fdata4)  plot(fdata.deriv(absorp,nderiv=1,method=\"bspline\",class.out='fd',nbasis=11))  #> [1] \"done\""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Converts raw data or other functional data classes into fdata class. — fdata","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"Create functional data object class fdata (matrix, data.frame, numeric, integer, fd, fds, fts sfts) class data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"","code":"fdata(mdata, argvals = NULL, rangeval = NULL, names = NULL, fdata2d = FALSE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"mdata Matrix set cases dimension (n x m), n number curves m points observed curve. argvals Argvals, default: 1:m. rangeval (optional) Range discretization points, default: range(argvals). names (optional) list tree components: main overall title, xlab title x axis ylab title y axis. fdata2d TRUE class fdata2d, functional data observed least two grids (argvals list vectors). default fdata2d=FALSE functional data observed single grid (argvals vector).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"Return fdata class object : \"data\": matrix set cases dimension (n x m), n number curves m points observed curve \"rangeval\": discretizations points values, provided: 1:m \"rangeval\": range discretizations points values, default: range(argvals) \"names\": (optional) list main overall title, xlab title x axis ylab title y axis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Converts raw data or other functional data classes into fdata class. — fdata","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme$learn[1:4,1:150] # Center curves fdata.c=fdata.cen(mlearn)$Xcen par(mfrow=c(2,1)) plot(mlearn,type=\"l\") plot(fdata.c,type=\"l\")  # Convert  from class fda to fdata bsp1 <- create.bspline.basis(c(1,150),21) fd1 <- Data2fd(1:150,y=t(mlearn$data),basisobj=bsp1) fdataobj=fdata(fd1)  # Convert  from class fds, fts or sfts to fdata #require(fds) #a=fds(x = 1:20, y = Simulationdata$y, xname = \"x\",  # yname = \"Simulated value\") #b=fts(x = 15:49, y = Australiasmoothfertility$y, xname = \"Age\", #    yname = \"Fertility rate\") #c=sfts(ts(as.numeric(ElNino_ERSST_region_1and2$y), frequency = 12), xname = \"Month\", #yname = \"Sea surface temperature\") #class(a);class(b);class(c) #fdataobj=fdata(b) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":null,"dir":"Reference","previous_headings":"","what":"fdata S3 Group Generic Functions — fdata.methods","title":"fdata S3 Group Generic Functions — fdata.methods","text":"fdata Group generic methods defined four specified groups functions, Math, Ops, Summary Complex. order.fdata split.fdata: wrapper order split  function fdata object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fdata S3 Group Generic Functions — fdata.methods","text":"","code":"# S3 method for class 'fdata' Math(x, ...)  # S3 method for class 'fdata' Ops(e1, e2 = NULL)  # S3 method for class 'fdata' Summary(..., na.rm = FALSE)  # S3 method for class 'fdata' split(x, f, drop = FALSE, ...)  order.fdata(y, fdataobj, na.last = TRUE, decreasing = FALSE)  is.fdata(fdataobj)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"fdata S3 Group Generic Functions — fdata.methods","text":"x fdata object containing values divided groups list fdata objects  containing values combine rows flatten one fdata object. ... arguments passed methods. e1, e2 fdata class object na.rm logical: missing values removed? f factor sense .factor(f) defines grouping, list factors case interaction used grouping. drop logical indicating levels occur dropped (f factor list). y sequence numeric, complex, character logical vectors, length, classed R object. fdataobj fdata class object. na.last controlling treatment NAs. TRUE, missing values data put last; FALSE, put first; NA, removed; \"keep\" kept rank NA. decreasing logical sort order increasing decreasing?.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fdata S3 Group Generic Functions — fdata.methods","text":"split.fdata: value returned split list fdata objects containing values groups. components list named  levels f (converting factor, already factor  drop = TRUE, dropping unused levels).\\ order.fdata:  returns functional data fdataobj  w.r.t. permutation rearranges first argument ascending descending order.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"fdata S3 Group Generic Functions — fdata.methods","text":"order.fdata funcional data ordered w.r.t sample order values vector. split.fdata divides data fdata object x groups defined f.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fdata S3 Group Generic Functions — fdata.methods","text":"Manuel Febrero Bande Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata.methods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"fdata S3 Group Generic Functions — fdata.methods","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absor<-tecator$absorp.fdata absor2<-fdata.deriv(absor,1) absor<-absor2[1:5,1:4] absor2<-absor2[1:5,1:4] sum(absor) round(absor,4) log1<-log(absor)  fdataobj<-fdata(MontrealTemp) fac<-factor(c(rep(1,len=17),rep(2,len=17))) a1<-split(fdataobj,fac) dim(a1[[1]]);dim(a1[[2]]) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"Compute fucntional coefficients functional data (fdata class object) represented basis (fixed data-driven basis).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"","code":"fdata2basis(fdataobj, basis, method = c(\"grid\", \"inprod\"))  # S3 method for class 'basis.fdata' summary(object, draw = TRUE, index = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"fdataobj fdata class object. basis functional basis object defining basis method character string, \"grid\" fdata object evaluated grid (argvals fdata), \"inprod\" basis representation functional data computed inner product (inprod.fdata(fdataobj,basis)). object basis.fdata class object calculated : fdata2basis draw logical, original curves  basis representation plotted index vector, default (NULL) first n curves plotted, n = min(4, length(fdataobj)). Otherwise, index vector indicates taht curvesare plotted. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"fdata2basis function returns: coef:  matrix two-dimensional array coefficients. basis:  Basis fdata class evaluated grid fdataobj.  summary function return: R: matrix measure similar R-sq curve aproximation (row) number basis elements (column).","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente  manuel.oviedo@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute fucntional coefficients from functional data represented in a base of functions — fdata2basis","text":"","code":"if (FALSE) { # \\dontrun{ T <- 71 S <- 51 tj <- round(seq(0,1,len=T),3) si <- round(seq(0,1,len=S),3) beta1 <- outer(si,tj,function(si,tj){exp(-5*abs((tj-si)/5))}) nbasis.s =7 nbasis.t=11 base.s <- create.fourier.basis(c(0,1),nbasis=nbasis.s) base.t <- create.fourier.basis(c(0,1),nbasis=nbasis.t) y1 <- fdata(rbind(log(1+tj),1-5*(tj-0.5)^2),argvals=tj,rangeval=c(0,1)) aa <- fdata2basis(y1,base.t,method=\"inprod\") summary(aa) plot(gridfdata(aa$coefs,aa$basis)) lines(y1,lwd=2,col=c(3,4),lty=2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":null,"dir":"Reference","previous_headings":"","what":"Converts fdata class object into fd class object — fdata2fd","title":"Converts fdata class object into fd class object — fdata2fd","text":"Converts fdata class object fd class object using Data2fd function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converts fdata class object into fd class object — fdata2fd","text":"","code":"fdata2fd(   fdataobj,   type.basis = NULL,   nbasis = NULL,   nderiv = 0,   lambda = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converts fdata class object into fd class object — fdata2fd","text":"fdataobj fdata class object. type.basis Type basis. function create.\"type.basis\".basis must exists. default, bspline basis used. nbasis Number basis used create.basis function. nderiv Order derivation used deriv.fd function (optional). lambda Weight smoothing operator specified nderiv. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Converts fdata class object into fd class object — fdata2fd","text":"Return object fd class.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Converts fdata class object into fd class object — fdata2fd","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Converts fdata class object into fd class object — fdata2fd","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Converts fdata class object into fd class object — fdata2fd","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme$learn[1] fdata2=fdata2fd(mlearn) class(mlearn) class(fdata2) fdata3=fdata2fd(mlearn,type.basis=\"fourier\",nbasis=7) plot(mlearn) lines(fdata2,col=2) lines(fdata3,col=3) fdata5=fdata2fd(mlearn,nderiv=1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal components for functional data — fdata2pc","title":"Principal components for functional data — fdata2pc","text":"Compute (penalized) principal components functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal components for functional data — fdata2pc","text":"","code":"fdata2pc(fdataobj, ncomp = 2, norm = TRUE, lambda = 0, P = c(0, 0, 1), ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal components for functional data — fdata2pc","text":"fdataobj fdata class object. ncomp Number principal components. norm =TRUE norm eigenvectors (rotation) 1. lambda Amount penalization. Default value 0, .e. penalization used. P P vector: coefficients define penalty matrix object. default P=c(0,0,1) penalize second derivative (curvature) acceleration.  P matrix: penalty matrix object. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Principal components for functional data — fdata2pc","text":"d: standard deviations functional principal components. rotation: Also known loadings. fdata class object whose rows contain eigenvectors. x: Also known scores. value rotated functional data returned. fdataobj.cen: centered fdataobj object. mean: functional mean fdataobj object. l: Vector indices principal components. C: matched call. lambda: Amount penalization. P: Penalty matrix.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Principal components for functional data — fdata2pc","text":"Smoothing achieved penalizing integral square derivative order m rangeval: m = 0 penalizes squared difference 0 function m = 1 penalize square slope velocity m = 2 penalize squared acceleration m = 3 penalize squared rate change acceleration","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Principal components for functional data — fdata2pc","text":"Venables, W. N. B. D. Ripley (2002). Modern Applied Statistics S. Springer-Verlag. N. Kraemer, .-L. Boulsteix, G. Tutz (2008). Penalized Partial Least Squares Applications B-Spline Transformations Functional Data. Chemometrics Intelligent Laboratory Systems, 94, 60 - 69. doi:10.1016/j.chemolab.2008.06.009 Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Principal components for functional data — fdata2pc","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Principal components for functional data — fdata2pc","text":"","code":"if (FALSE) { # \\dontrun{  n= 100;tt= seq(0,1,len=51)  x0<-rproc2fdata(n,tt,sigma=\"wiener\")  x1<-rproc2fdata(n,tt,sigma=0.1)  x<-x0*3+x1  pc=fdata2pc(x,lambda=1)  summary(pc)  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":null,"dir":"Reference","previous_headings":"","what":"Partial least squares components for functional data. — fdata2pls","title":"Partial least squares components for functional data. — fdata2pls","text":"Compute penalized partial least squares (PLS) components functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partial least squares components for functional data. — fdata2pls","text":"","code":"fdata2pls(fdataobj, y, ncomp = 2, lambda = 0, P = c(0, 0, 1), norm = TRUE, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partial least squares components for functional data. — fdata2pls","text":"fdataobj fdata class object. y Scalar response length n. ncomp number components include model. lambda Amount penalization. Default value 0, .e. penalization used. P P vector: coefficients define penalty matrix object. default \\(P=c(0,0,1)\\) penalizes second derivative (curvature) acceleration.  P matrix: penalty matrix object. norm TRUE fdataobj centered scaled. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Partial least squares components for functional data. — fdata2pls","text":"fdata2pls function return: fdata2pls function returns: df: Degree freedom. rotation: fdata class object. x: value rotated data (centered data multiplied rotation matrix) returned. fdataobj.cen: centered fdataobj object. mean: Mean fdataobj. l: Vector indices principal components. C: matched call. lambda: Amount penalization. P: Penalty matrix.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Partial least squares components for functional data. — fdata2pls","text":"norm=TRUE, computes PLS NIPALS algorithm Degrees Freedom using Krylov representation PLS, see Kraemer Sugiyama (2011). norm=FALSE, computes PLS Orthogonal Scores Algorithm Degrees Freedom number components ncomp, see Martens Naes (1989).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Partial least squares components for functional data. — fdata2pls","text":"Kraemer, N., Sugiyama M. (2011). Degrees Freedom Partial Least Squares Regression. Journal American Statistical Association. Volume 106, 697-705. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/ Martens, H., Naes, T. (1989) Multivariate calibration. Chichester: Wiley.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Partial least squares components for functional data. — fdata2pls","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente  manuel.oviedo@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fdata2pls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Partial least squares components for functional data. — fdata2pls","text":"","code":"if (FALSE) { # \\dontrun{ n= 500;tt= seq(0,1,len=101) x0<-rproc2fdata(n,tt,sigma=\"wiener\") x1<-rproc2fdata(n,tt,sigma=0.1) x<-x0*3+x1 beta = tt*sin(2*pi*tt)^2 fbeta = fdata(beta,tt) y<-inprod.fdata(x,fbeta)+rnorm(n,sd=0.1) pls1=fdata2pls(x,y) pls1$call summary(pls1) pls1$l norm.fdata(pls1$rotation) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":null,"dir":"Reference","previous_headings":"","what":"False Discorvery Rate (FDR) — FDR","title":"False Discorvery Rate (FDR) — FDR","text":"Compute False Discovery Rate vector p-values alpha value.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"False Discorvery Rate (FDR) — FDR","text":"","code":"FDR(pvalues = NULL, alpha = 0.95, dep = 1)  pvalue.FDR(pvalues = NULL, dep = 1)"},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"False Discorvery Rate (FDR) — FDR","text":"pvalues Vector p-values alpha Alpha value (level significance). dep Parameter dependence test. default dep = 1, direct dependence tests.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"False Discorvery Rate (FDR) — FDR","text":"Return: .FDR=TRUE: significative differences. pv.FDR: p-value False Discovery Rate test.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"False Discorvery Rate (FDR) — FDR","text":"FDR method used multiple hypothesis testing correct problems multiple contrasts. dep = 1, tests positively correlated, example many tests contrast.  dep < 1 tests negatively correlated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"False Discorvery Rate (FDR) — FDR","text":"Benjamini, Y., Yekutieli, D. (2001). control false discovery rate multiple testing dependency. Annals Statistics. 29 (4): 1165-1188. DOI:10.1214/aos/1013699998.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"False Discorvery Rate (FDR) — FDR","text":"Febrero-Bande, M.  Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/FDR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"False Discorvery Rate (FDR) — FDR","text":"","code":"p=seq(1:50)/1000  FDR(p) #> [1] TRUE  pvalue.FDR(p) #> [1] 0.05  FDR(p,alpha=0.9999) #> [1] FALSE  FDR(p,alpha=0.9) #> [1] TRUE  FDR(p,alpha=0.9,dep=-1) #> [1] FALSE"},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"Three tests equality distributions two populations provided. null hypothesis two populations ","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"","code":"XYRP.test(X.fdata, Y.fdata, nproj = 10, npc = 5, test = c(\"KS\", \"AD\"))  MMD.test(   X.fdata,   Y.fdata,   metric = \"metric.lp\",   B = 1000,   alpha = 0.95,   kern = \"RBF\",   ops.metric = list(lp = 2),   draw = FALSE )  MMDA.test(   X.fdata,   Y.fdata,   metric = \"metric.lp\",   B = 1000,   alpha = 0.95,   kern = \"RBF\",   ops.metric = list(lp = 2),   draw = FALSE )  fEqDistrib.test(   X.fdata,   Y.fdata,   metric = \"metric.lp\",   method = c(\"Exch\", \"WildB\"),   B = 5000,   ops.metric = list(lp = 2),   iboot = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"X.fdata fdata object containing curves first population. Y.fdata fdata object containing curves second population. nproj Number projections XYRP.test. npc number principal components employed generating random projections. test XYRP.test \"KS\" /\"AD\" computing Kolmogorov-Smirnov Anderson-Darling p-values projections. metric Character metric function computing distances among curves. B Number bootstrap Monte Carlo replicas. alpha Confidence level computing threshold. default =0.95. kern MMDA.test \"RBF\" \"metric\" indicating use Radial Basis Function directly, distances. ops.metric List parameters used metric. draw default, FALSE. Plots density bootstrap replicas jointly statistic. method fEqDistrib.test character indicating bootstrap method computing distribution H0. \"Exch\" Exchangeable bootstrap \"WildB\" Wild Bootstrap. default, provided. iboot fEqDistrib.test returns bootstrap replicas.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"list following components function: XYRP.test, FDR.pv: p-value using FDR, proj.pv: Matrix p-values obtained projections. MMD.test, MMDA.test: stat: Statistic, p.value: p-value, thresh: Threshold level alpha. fEqDistrib.test, result: data.frame columns Stat p.value, Boot: data.frame bootstrap replicas iboot=TRUE.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"XYRP.test computes p-values using random projections. Requires kSamples library. MMD.test computes Maximum Mean Discrepancy p-values using permutations (see Sejdinovic et al, (2013)) MMDA.test using asymptotic approximation. fEqDistrib.test checks equality distributions using embedding RKHS two bootstrap approximations calibration.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"Sejdinovic, D., Sriperumbudur, B., Gretton, ., Fukumizu, K. Equivalence distance-based RKHS-based statistics Hypothesis Testing Annals Statistics, 2013. DOI 10.1214/13-AOS1140.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.febrero@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqDistrib.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tests for checking the equality of distributions between two functional populations. — fEqDistrib.test","text":"","code":"if (FALSE) { # \\dontrun{ tt=seq(0,1,len=51) bet=0 mu1=fdata(10*tt*(1-tt)^(1+bet),tt) mu2=fdata(10*tt^(1+bet)*(1-tt),tt)  fsig=1 X=rproc2fdata(100,tt,mu1,sigma=\"vexponential\",par.list=list(scale=0.2,theta=0.35)) Y=rproc2fdata(100,tt,mu2,sigma=\"vexponential\",par.list=list(scale=0.2*fsig,theta=0.35)) fmean.test.fdata(X,Y,npc=-.98,draw=TRUE) cov.test.fdata(X,Y,npc=5,draw=TRUE) bet=0.1 mu1=fdata(10*tt*(1-tt)^(1+bet),tt) mu2=fdata(10*tt^(1+bet)*(1-tt),tt)  fsig=1.5 X=rproc2fdata(100,tt,mu1,sigma=\"vexponential\",par.list=list(scale=0.2,theta=0.35)) Y=rproc2fdata(100,tt,mu2,sigma=\"vexponential\",par.list=list(scale=0.2*fsig,theta=0.35)) fmean.test.fdata(X,Y,npc=-.98,draw=TRUE) cov.test.fdata(X,Y,npc=5,draw=TRUE) XYRP.test(X,Y,nproj=15) MMD.test(X,Y,B=1000) fEqDistrib.test(X,Y,B=1000) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"Two tests equality means covariances two populations provided.  tests constructed gaussianity following Horvath & Kokoszka, 2012, Chapter 5.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"","code":"fmean.test.fdata(   X.fdata,   Y.fdata,   method = c(\"X2\", \"Boot\"),   npc = 5,   alpha = 0.95,   B = 1000,   draw = FALSE )  cov.test.fdata(   X.fdata,   Y.fdata,   method = c(\"X2\", \"Boot\"),   npc = 5,   alpha = 0.95,   B = 1000,   draw = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"X.fdata fdata object containing curves first population. Y.fdata fdata object containing curves second population. method c(\"X2\",\"Boot\"). \"X2\" includes asymptotic distribution. \"Boot\" computes bootstrap approximation. npc number principal components employed.  npc negative 0<abs(npc)<1, number components determined explaining, least, abs(p)% variability. alpha Confidence level. default =0.95. B Number bootstrap replicas method=\"Boot\". draw default, FALSE. Plots density bootstrap replicas jointly statistic.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"Return list : stat: Value statistic. pvalue: P-values test. vcrit: Critical cutoff rejecting null hypothesis. p: Degrees freedom X2 statistic. B: Number bootstrap replicas.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"fmean.test.fdata computes test equality means. cov.test.fdata computes test equality covariance operators. tests asymptotic distributions null related chi-square distribution. Also, parametric bootstrap procedure implemented cases.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"Inference Functional Data Applications. Horvath, L Kokoszka, P. (2012). Springer.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.febrero@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fEqMoments.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tests for checking the equality of means and/or covariance between two populations under gaussianity. — fEqMoments.test","text":"","code":"if (FALSE) { # \\dontrun{ tt=seq(0,1,len=51) bet=0 mu1=fdata(10*tt*(1-tt)^(1+bet),tt) mu2=fdata(10*tt^(1+bet)*(1-tt),tt)  fsig=1 X=rproc2fdata(100,tt,mu1,sigma=\"vexponential\",par.list=list(scale=0.2,theta=0.35)) Y=rproc2fdata(100,tt,mu2,sigma=\"vexponential\",par.list=list(scale=0.2*fsig,theta=0.35)) fmean.test.fdata(X,Y,npc=-.98,draw=TRUE) cov.test.fdata(X,Y,npc=5,draw=TRUE) bet=0.1 mu1=fdata(10*tt*(1-tt)^(1+bet),tt) mu2=fdata(10*tt^(1+bet)*(1-tt),tt)  fsig=1.5 X=rproc2fdata(100,tt,mu1,sigma=\"vexponential\",par.list=list(scale=0.2,theta=0.35)) Y=rproc2fdata(100,tt,mu2,sigma=\"vexponential\",par.list=list(scale=0.2*fsig,theta=0.35)) fmean.test.fdata(X,Y,npc=-.98,draw=TRUE) cov.test.fdata(X,Y,npc=5,draw=TRUE) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":null,"dir":"Reference","previous_headings":"","what":"F-test for the Functional Linear Model with scalar response — flm.Ftest","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"function flm.Ftest tests null hypothesis interaction functional covariate scalar response inside Functional Linear Model (FLM): \\(Y=\\big<X,\\beta\\big>+\\epsilon\\). null hypothesis \\(H_0:\\,\\beta=0\\) alternative \\(H_1:\\,\\beta\\neq 0\\). null hypothesis tested functional extension classical F-test (see Details).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"","code":"Ftest.statistic(X.fdata, Y)  flm.Ftest(X.fdata, Y, B = 5000, verbose = TRUE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"X.fdata Functional covariate FLM. object must class fdata. Y Scalar response FLM. Must vector number elements functions X.fdata. B Number bootstrap replicates calibrate distribution test statistic. B=5000 replicates recommended carry test, although exploratory analysis (inferential), acceptable less time-consuming option B=500. verbose Either show information computing progress.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"value Ftest.statistic simply F-test statistic. value flm.Ftest object class \"htest\" whose underlying structure list containing following components: statistic: value F-test statistic. boot.statistics: vector length B values bootstrap F-test statistics. p.value: p-value test. method: character string \"Functional Linear Model F-test\". B: number bootstrap replicates used. data.name: character string \"Y=<X,0>+e\".","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"Functional Linear Model scalar response (FLM), defined \\(Y=\\big<X,\\beta\\big>+\\epsilon\\), functional process \\(X\\) \\(E[X(t)]=0\\), \\(E[X(t)\\epsilon]=0\\) \\(t\\) scalar variable \\(Y\\) \\(E[Y]=0\\). functional F-test defined  $$T_n=\\bigg\\|\\frac{1}{n}\\sum_{=1}^n (X_i-\\bar X)(Y_i-\\bar Y)\\bigg\\|,$$ \\(\\bar X\\) functional mean \\(X\\), \\(\\bar Y\\) ordinary mean \\(Y\\) \\(\\|\\cdot\\|\\) \\(L^2\\) functional norm. statistic computed function Ftest.statistic. distribution test statistic approximated wild bootstrap resampling residuals, using golden section bootstrap.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"NA's allowed neither functional covariate scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"Garcia-Portugues, E., Gonzalez-Manteiga, W. Febrero-Bande, M. (2014). goodness––fit test functional linear model scalar response. Journal Computational Graphical Statistics, 23(3), 761-778. doi:10.1080/10618600.2013.812519 Gonzalez-Manteiga, W., Gonzalez-Rodriguez, G., Martinez-Calvo, . Garcia-Portugues, E. Bootstrap independence test functional linear models. arXiv:1210.1072. https://arxiv.org/abs/1210.1072","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"Eduardo Garcia-Portugues. Please, report bugs suggestions eduardo.garcia.portugues@uc3m.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.Ftest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"F-test for the Functional Linear Model with scalar response — flm.Ftest","text":"","code":"if (FALSE) { # \\dontrun{ ## Simulated example ## X=rproc2fdata(n=50,t=seq(0,1,l=101),sigma=\"OU\") beta0=fdata(mdata=rep(0,length=101)+rnorm(101,sd=0.05), argvals=seq(0,1,l=101),rangeval=c(0,1)) beta1=fdata(mdata=cos(2*pi*seq(0,1,l=101))-(seq(0,1,l=101)-0.5)^2+ rnorm(101,sd=0.05),argvals=seq(0,1,l=101),rangeval=c(0,1))  # Null hypothesis holds Y0=drop(inprod.fdata(X,beta0)+rnorm(50,sd=0.1)) # Null hypothesis does not hold Y1=drop(inprod.fdata(X,beta1)+rnorm(50,sd=0.1))  # Do not reject H0 flm.Ftest(X,Y0,B=100) flm.Ftest(X,Y0,B=5000)  # Reject H0 flm.Ftest(X,Y1,B=100) flm.Ftest(X,Y1,B=5000) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"function flm.test tests composite null hypothesis Functional Linear Model scalar response (FLM), $$H_0:\\,Y=\\big<X,\\beta\\big>+\\epsilon,$$  versus general alternative. \\(\\beta=\\beta_0\\) provided, simple hypothesis \\(H_0:\\,Y=\\big<X,\\beta_0\\big>+\\epsilon\\) tested. testing null hypothesis done Projected Cramer-von Mises statistic (see Details).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"","code":"flm.test(   X.fdata,   Y,   beta0.fdata = NULL,   B = 5000,   est.method = \"pls\",   p = NULL,   type.basis = \"bspline\",   verbose = TRUE,   plot.it = TRUE,   B.plot = 100,   G = 200,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"X.fdata Functional covariate FLM. object must class fdata. Y Scalar response FLM. Must vector number elements functions X.fdata. beta0.fdata Functional parameter simple null hypothesis, fdata class. Recall argvals rangeval arguments beta0.fdata must X.fdata. possibility consider, example \\(\\beta_0=0\\) (simple null hypothesis interaction),  beta0.fdata=fdata(mdata=rep(0,length(X.fdata$argvals)),argvals=X.fdata$argvals,rangeval=X.fdata$rangeval).  beta0.fdata=NULL (default), function test composite null hypothesis. B Number bootstrap replicates calibrate distribution test statistic. B=5000 replicates recommended carry test, although exploratory analysis  (inferential), acceptable less time-consuming option B=500. est.method Estimation method unknown parameter \\(\\beta\\), used composite case. Mainly, two options: specify number basis elements estimated \\(\\beta\\) p optimally select p data-driven criteria (see Details section discussion). , must one following methods: \"pc\": p, number basis elements, given, \\(\\beta\\) estimated fregre.pc. Otherwise, optimum p chosen using fregre.pc.cv \"SICc\" criteria. \"pls\": p given, \\(\\beta\\) estimated fregre.pls. Otherwise, optimum p chosen using fregre.pls.cv \"SICc\" criteria.  default argument checked empirically provides good balance performance test estimation \\(\\beta\\). \"basis\": p given, \\(\\beta\\) estimated fregre.basis. Otherwise, optimum p chosen using fregre.basis.cv \"GCV.S\" criteria. functions, basis arguments basis.x basis.b considered.  type basis used given argument type.basis must one class create.basis. arguments passed create.basis (rangeval taken rangeval X.fdata), can passed throughout .... p Number elements basis considered. given, optimal p chosen using specific criteria (see est.method type.basis arguments). type.basis Type basis used represent functional process. Depending hypothesis, different interpretation: Simple hypothesis. One options: \"bspline\": p given, functional process expressed basis p B-splines. , optimal p chosen optim.basis, using \"GCV.S\" criteria. \"fourier\": p given, functional process expressed basis p Fourier functions. , optimal p chosen optim.basis, using \"GCV.S\" criteria. \"pc\": p must given. Expresses functional process basis p principal components. \"pls\": p must given. Expresses functional process basis p partial least squares. Although basis types supported create.basis possible,\"bspline\" \"fourier\" recommended. basis types may cause incompatibilities. Composite hypothesis. argument used est.method=\"basis\" , case, specifies type basis used basis estimation method functional parameter. , basis  \"bspline\" \"fourier\" recommended, basis types may cause incompatibilities. verbose Either show information computing progress. plot.Either show graph observed trajectory, bootstrap trajectories null composite hypothesis, process \\(R_n(\\cdot)\\) (see Details). Note plot.=TRUE, function takes time run. B.plot Number bootstrap trajectories show resulting plot test. trajectories shown first B.plot B, B.plot must lower equal B. G Number projections used compute trajectories process \\(R_n(\\cdot)\\) Monte Carlo. ... arguments passed create.basis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"object class \"htest\" whose underlying structure list containing following components: statistic: value test statistic. boot.statistics: vector length B values bootstrap test statistics. p.value: p-value test. method: method used. B: number bootstrap replicates used. type.basis: type basis used. beta.est: estimated functional parameter \\(\\beta\\) composite  hypothesis. simple hypothesis, given beta0.fdata. p: number basis elements passed automatically chosen. ord: optimal order PC PLS given fregre.pc.cv  fregre.pls.cv. methods, set 1:p. data.name: character string \"Y=<X,b>+e\".","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"Functional Linear Model scalar response (FLM), defined \\(Y=\\big<X,\\beta\\big>+\\epsilon\\), functional process \\(X\\) \\(E[X(t)]=0\\), \\(E[X(t)\\epsilon]=0\\)  \\(t\\) scalar variable \\(Y\\) \\(E[Y]=0\\).  , test assumes Y X.fdata centred automatically  center . , bear mind apply test Y X.fdata,  actually,  applying Y-mean(Y) fdata.cen(X.fdata)$Xcen.  test statistic corresponds Cramer-von Mises norm Residual Marked  empirical Process based Projections \\(R_n(u,\\gamma)\\) defined  Garcia-Portugues et al. (2014).  expression process \\(p\\)-truncated basis space \\(L^2[0,T]\\)  leads \\(p\\)-multivariate process \\(R_{n,p}\\big(u,\\gamma^{(p)}\\big)\\),  whose Cramer-von Mises norm computed.  choice appropriate \\(p\\) represent functional process \\(X\\),  case provided, done via estimation \\(\\beta\\) composite  hypothesis. simple hypothesis, estimation \\(\\beta\\) done, choice  \\(p\\) depends functional process \\(X\\). result test may  change different \\(p\\)'s, recommend use automatic criterion select \\(p\\)  instead provide fixed one.  distribution test statistic approximated wild bootstrap resampling  residuals, using golden section bootstrap.  Finally, graph shown plot.=TRUE represents observed trajectory,  bootstrap trajectories null, process RMPP integrated projections:  $$R_n(u)\\approx\\frac{1}{G}\\sum_{g=1}^G R_n(u,\\gamma_g),$$   \\(\\gamma_g\\) simulated Gaussians processes. gives graphical idea    distant observed trajectory null hypothesis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"NA's allowed neither functional covariate scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"Escanciano, J. C. (2006). consistent diagnostic test regression models using projections. Econometric Theory, 22, 1030-1051. doi:10.1017/S0266466606060506 Garcia-Portugues, E., Gonzalez-Manteiga, W. Febrero-Bande, M. (2014). goodness––fit test functional linear model scalar response. Journal Computational Graphical Statistics, 23(3), 761-778. doi:10.1080/10618600.2013.812519","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"Eduardo Garcia-Portugues. Please, report bugs suggestions  edgarcia@est-econ.uc3m.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/flm.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test","text":"","code":"# Simulated example # X=rproc2fdata(n=100,t=seq(0,1,l=101),sigma=\"OU\") beta0=fdata(mdata=cos(2*pi*seq(0,1,l=101))-(seq(0,1,l=101)-0.5)^2+             rnorm(101,sd=0.05),argvals=seq(0,1,l=101),rangeval=c(0,1)) Y=inprod.fdata(X,beta0)+rnorm(100,sd=0.1)  dev.new(width=21,height=7) par(mfrow=c(1,3)) plot(X,main=\"X\") plot(beta0,main=\"beta0\") plot(density(Y),main=\"Density of Y\",xlab=\"Y\",ylab=\"Density\") rug(Y)  if (FALSE) { # \\dontrun{ # Composite hypothesis: do not reject FLM pcvm.sim=flm.test(X,Y,B=50,B.plot=50,G=100,plot.it=TRUE) pcvm.sim flm.test(X,Y,B=5000)   # Estimated beta dev.new() plot(pcvm.sim$beta.est)  # Simple hypothesis: do not reject beta=beta0 flm.test(X,Y,beta0.fdata=beta0,B=50,B.plot=50,G=100) flm.test(X,Y,beta0.fdata=beta0,B=5000)   # AEMET dataset # data(aemet) # Remove the 5\\ dev.new() res.FM=depth.FM(aemet$temp,draw=TRUE) qu=quantile(res.FM$dep,prob=0.05) l=which(res.FM$dep<=qu) lines(aemet$temp[l],col=3) aemet$df$name[l]  # Data without outliers  wind.speed=apply(aemet$wind.speed$data,1,mean)[-l] temp=aemet$temp[-l] # Exploratory analysis: accept the FLM pcvm.aemet=flm.test(temp,wind.speed,est.method=\"pls\",B=100,B.plot=50,G=100) pcvm.aemet  # Estimated beta dev.new() plot(pcvm.aemet$beta.est,lwd=2,col=2) # B=5000 for more precision on calibration of the test: also accept the FLM flm.test(temp,wind.speed,est.method=\"pls\",B=5000)   # Simple hypothesis: rejection of beta0=0? Limiting p-value... dat=rep(0,length(temp$argvals)) flm.test(temp,wind.speed, beta0.fdata=fdata(mdata=dat,argvals=temp$argvals,                                             rangeval=temp$rangeval),B=100) flm.test(temp,wind.speed, beta0.fdata=fdata(mdata=dat,argvals=temp$argvals,                                             rangeval=temp$rangeval),B=5000)                                               # Tecator dataset # data(tecator) names(tecator) absorp=tecator$absorp.fdata ind=1:129 # or ind=1:215 x=absorp[ind,] y=tecator$y$Fat[ind] tt=absorp[[\"argvals\"]]  # Exploratory analysis for composite hypothesis with automatic choose of p pcvm.tecat=flm.test(x,y,B=100,B.plot=50,G=100) pcvm.tecat  # B=5000 for more precision on calibration of the test: also reject the FLM flm.test(x,y,B=5000)   # Distribution of the PCvM statistic plot(density(pcvm.tecat$boot.statistics),lwd=2,xlim=c(0,10),               main=\"PCvM distribution\", xlab=\"PCvM*\",ylab=\"Density\") rug(pcvm.tecat$boot.statistics) abline(v=pcvm.tecat$statistic,col=2,lwd=2) legend(\"top\",legend=c(\"PCvM observed\"),lwd=2,col=2)  # Simple hypothesis: fixed p dat=rep(0,length(x$argvals)) flm.test(x,y,beta0.fdata=fdata(mdata=dat,argvals=x$argvals,                                rangeval=x$rangeval),B=100,p=11)                                 # Simple hypothesis, automatic choose of p flm.test(x,y,beta0.fdata=fdata(mdata=dat,argvals=x$argvals,                                rangeval=x$rangeval),B=100) flm.test(x,y,beta0.fdata=fdata(mdata=dat,argvals=x$argvals,                                rangeval=x$rangeval),B=5000) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"Computes functional regression functional explanatory variables scalar response using basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"","code":"fregre.basis.cv(   fdataobj,   y,   basis.x = NULL,   basis.b = NULL,   type.basis = NULL,   lambda = 0,   Lfdobj = vec2Lfd(c(0, 0), rtt),   type.CV = GCV.S,   par.CV = list(trim = 0),   weights = rep(1, n),   verbose = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"fdataobj fdata class object. y Scalar response length n. basis.x Basis functional explanatory data fdataobj. basis.b Basis functional beta parameter. type.basis vector character string determines type basis. default \"bspline\". used basis.x basis.b vector number basis considered. lambda roughness penalty. default, penalty lambda=0. Lfdobj See eval.penalty. type.CV Type cross-validation. default generalized cross-validation GCV.S method. par.CV List parameters type.CV: trim, alpha trimming draw. weights weights verbose TRUE information procedure printed. Default FALSE. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"Return: fregre.basis: Fitted regression object best parameters (basis elements data beta lambda penalty). basis.x.opt: Basis used functional explanatory data estimation fdata. basis.b.opt: Basis used functional beta parameter estimation. lambda.opt: lambda value minimizes CV GCV method. gcv.opt: Minimum value CV GCV method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"function fregre.basis.cv()  uses validation criterion defined argument type.CV estimate number basis elements /penalized parameter (lambda) best predicts response. basis = NULL creates bspline basis. functional covariate fdataobj format raw data, matrix data.frame, creates object class fdata default attributes, see fdata. basis.x vector number basis elements basis.b=NULL, function force number elements basis x beta. basis.x$type=``fourier'' basis.b$type=``fourier'', function decreases number fourier basis elements \\(min(k_{n1},k_{n2})\\), \\(k_{n1}\\) \\(k_{n2}\\) number basis element basis.x basis.b respectively.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"Ramsay, James O. Silverman, Bernard W. (2006), Functional Data Analysis, 2nd ed., Springer, New York. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-validation Functional Regression with scalar response using basis representation. — fregre.basis.cv","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x<-tecator$absorp.fdata[1:129] y=tecator$y$Fat[1:129] b1<-c(15,21,31) b2<-c(7,9) res1=fregre.basis.cv(x,y,basis.x=b1) res2=fregre.basis.cv(x,y,basis.x=b1,basis.b=b2) res1$gcv res2$gcv l=2^(-4:10) res3=fregre.basis.cv(x,y,basis.b=b1,type.basis=\"fourier\", lambda=l,type.CV=GCV.S,par.CV=list(trim=0.15)) res3$gcv } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Regression with functional response using basis representation. — fregre.basis.fr","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"Computes functional regression functional explanatory variable \\(X(s)\\) functional response \\(Y(t)\\) using basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"","code":"fregre.basis.fr(   x,   y,   basis.s = NULL,   basis.t = NULL,   lambda.s = 0,   lambda.t = 0,   Lfdobj.s = vec2Lfd(c(0, 0), range.s),   Lfdobj.t = vec2Lfd(c(0, 0), range.t),   weights = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"x Functional explanatory variable. y Functional response variable. basis.s Basis related s used estimation \\(\\beta(s,t)\\). basis.t Basis related t used estimation \\(\\beta(s,t)\\). lambda.s roughness penalty respect s applied estimation \\(\\beta(s,t)\\). default, penalty lambda.s=0. lambda.t roughness penalty respect t applied estimation \\(\\beta(s,t)\\).  default, penalty lambda.t=0. Lfdobj.s linear differential operator object respect s . See eval.penalty. Lfdobj.t linear differential operator object respect t. See eval.penalty. weights Weights. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"Return: call: matched call. .est: Intercept parameter estimated. coefficients: matrix coefficients. beta.est: bivariate functional data object class bifd estimated parameters \\(\\beta(s,t)\\). fitted.values: Estimated response. residuals: y minus fitted values. y: Functional response. x: Functional explanatory data. lambda.s: roughness penalty respect s. lambda.t: roughness penalty respect t. Lfdobj.s: linear differential operator respect s. Lfdobj.t: linear differential operator respect t. weights: Weights.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"$$Y(t)=\\alpha(t)+\\int_{T}{X(s)\\beta(s,t)ds+\\epsilon(t)}$$ \\(\\alpha(t)\\) intercept function, \\(\\beta(s,t)\\) bivariate resgression function \\(\\epsilon(t)\\) error term mean zero. function wrapped linmod function proposed Ramsay Silverman (2005) model relationship functional response \\(Y(t)\\) functional covariate \\(X(t)\\) basis representation . unknown bivariate functional parameter \\(\\beta(s,t)\\) can expressed double expansion terms \\(K\\) basis function \\(\\nu_k\\) \\(L\\) basis functions \\(\\theta_l\\), $$\\beta(s,t)=\\sum_{k=1}^{K}\\sum_{l=1}^{L} b_{kl} \\nu_{k}(s)\\theta_{l}(t)=\\nu(s)^{\\top}\\bold{B}\\theta(t)$$ , model can re–written matrix version , $$Y(t)=\\alpha(t)+\\int_{T}{X(s)\\nu(s)^{\\top}\\bold{B}\\theta(t)ds+\\epsilon(t)}=\\alpha(t)+\\bold{XB}\\theta(t)+\\epsilon(t)$$ \\(\\bold{X}=\\int X(s)\\nu^{\\top}(t)ds\\) function allows objects class fdata directly covariates class fd.  x fdata class, basis.s also basis used represent x fd class object. y fdata class, basis.t also basis used represent y fd class object. function also gives default values arguments basis.s basis.t construct bifd class object used estimation \\(\\beta(s,t)\\).  basis.s=NULL basis.t=NULL function creates bspline basis create.bspline.basis. fregre.basis.fr incorporates roughness penalty using appropiate linear differential operator; lambda.s, Lfdobj.s penalization \\(\\beta\\)'s variations respect \\(s\\) lambda.t, Lfdobj.t penalization \\(\\beta\\)'s variations respect \\(t\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.fr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Regression with functional response using basis representation. — fregre.basis.fr","text":"","code":"if (FALSE) { # \\dontrun{ rtt<-c(0, 365) basis.alpha  <- create.constant.basis(rtt) basisx  <- create.bspline.basis(rtt,11) basisy  <- create.bspline.basis(rtt,11) basiss  <- create.bspline.basis(rtt,7) basist  <- create.bspline.basis(rtt,9)  # fd class dayfd<-Data2fd(day.5,CanadianWeather$dailyAv,basisx) tempfd<-dayfd[,1] log10precfd<-dayfd[,3] res1 <-  fregre.basis.fr(tempfd, log10precfd, basis.s=basiss,basis.t=basist)  # fdata class tt<-1:365 tempfdata<-fdata(t(CanadianWeather$dailyAv[,,1]),tt,rtt) log10precfdata<-fdata(t(CanadianWeather$dailyAv[,,3]),tt,rtt) res2<-fregre.basis.fr(tempfdata,log10precfdata, basis.s=basiss,basis.t=basist)  # penalization Lfdobjt <- Lfdobjs <- vec2Lfd(c(0,0), rtt) Lfdobjt <- vec2Lfd(c(0,0), rtt) lambdat<-lambdas <- 100 res1.pen <- fregre.basis.fr(tempfdata,log10precfdata,basis.s=basiss, basis.t=basist,lambda.s=lambdas,lambda.t=lambdat, Lfdobj.s=Lfdobjs,Lfdobj.t=Lfdobjt)  res2.pen <- fregre.basis.fr(tempfd, log10precfd, basis.s=basiss,basis.t=basist,lambda.s=lambdas, lambda.t=lambdat,Lfdobj.s=Lfdobjs,Lfdobj.t=Lfdobjt)  plot(log10precfd,col=1) lines(res1$fitted.values,col=2) plot(res1$residuals) plot(res1$beta.est,tt,tt) plot(res1$beta.est,tt,tt,type=\"persp\",theta=45,phi=30) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Regression with scalar response using basis representation. — fregre.basis","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"Computes functional regression functional explanatory variable \\(X(t)\\) scalar response \\(Y\\) using basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"","code":"fregre.basis(   fdataobj,   y,   basis.x = NULL,   basis.b = NULL,   lambda = 0,   Lfdobj = vec2Lfd(c(0, 0), rtt),   weights = rep(1, n),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"fdataobj fdata class object. y Scalar response length n. basis.x Basis functional explanatory data fdataobj. basis.b Basis functional beta parameter. lambda roughness penalty. default, penalty lambda=0. Lfdobj See eval.penalty. weights weights ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"Return: call: matched call. coefficients: named vector coefficients. residuals: y minus fitted values. fitted.values: Estimated scalar response. beta.est: Estimated beta parameter class fd. weights: (weighted fits) specified weights. df.residual: residual degrees freedom. r2: Coefficient determination. sr2: Residual variance. Vp: Estimated covariance matrix parameters. H: Hat matrix. y: Response. fdataobj: Functional explanatory data class fdata. .est: Intercept parameter estimated. x.fd: Centered functional explanatory data class fd. basis.b: Basis used beta parameter estimation. lambda.opt: roughness penalty. Lfdobj: Order derivative linear differential operator. P: Penalty matrix. lm: Return lm object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"$$Y=\\big<X,\\beta\\big>+\\epsilon=\\int_{T}{X(t)\\beta(t)dt+\\epsilon}$$ \\( \\big< \\cdot , \\cdot \\big>\\) denotes inner product \\(L_2\\) \\(\\epsilon\\) random errors mean zero, finite variance \\(\\sigma^2\\) \\(E[X(t)\\epsilon]=0\\). function uses basis representation proposed Ramsay Silverman (2005) model relationship scalar response functional covariate basis representation observed functional data \\(X(t)\\approx\\sum_{k=1}^{k_{n1}} c_k \\xi_k(t)\\) unknown functional parameter \\(\\beta(t)\\approx\\sum_{k=1}^{k_{n2}} b_k \\phi_k(t)\\). functional linear models estimated expression: $$\\hat{y}= \\big< X,\\hat{\\beta} \\big> = C^{T}\\psi(t)\\phi^{T}(t)\\hat{b}=\\tilde{X}\\hat{b}$$ \\(\\tilde{X}(t)=C^{T}\\psi(t)\\phi^{T}(t)\\), \\(\\hat{b}=(\\tilde{X}^{T}\\tilde{X})^{-1}\\tilde{X}^{T}y\\) , \\(\\hat{y}=\\tilde{X}\\hat{b}=\\tilde{X}(\\tilde{X}^{T}\\tilde{X})^{-1}\\tilde{X}^{T}y=Hy\\) \\(H\\) hat matrix degrees freedom: \\(df=tr(H)\\). \\(\\lambda>0\\) fregre.basis incorporates roughness penalty:  \\(\\hat{y}=\\tilde{X}\\hat{b}=\\tilde{X}(\\tilde{X}^{T}\\tilde{X}+\\lambda R_0)^{-1}\\tilde{X}^{T}y= H_{\\lambda}y\\) \\(R_0\\) penalty matrix. function allows covariates class fdata, matrix, data.frame directly covariates class fd.  function also gives default values arguments basis.x basis.b representation basis functional data \\(X(t)\\) functional parameter \\(\\beta(t)\\), respectively. basis=NULL creates bspline basis create.bspline.basis.  functional covariate fdataobj matrix data.frame, creates object class \"fdata\" default attributes, see fdata. basis.x$type=``fourier'' basis.b$type=``fourier'', basis orthonormal function decreases number fourier basis elements \\(min(k_{n1},k_{n2})\\), \\(k_{n1}\\) \\(k_{n2}\\) number basis element basis.x basis.b respectively.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Regression with scalar response using basis representation. — fregre.basis","text":"","code":"if (FALSE) { # \\dontrun{ # fregre.basis data(tecator) names(tecator) absorp=tecator$absorp.fdata ind=1:129 x=absorp[ind,] y=tecator$y$Fat[ind] tt=absorp[[\"argvals\"]] res1=fregre.basis(x,y) summary(res1) basis1=create.bspline.basis(rangeval=range(tt),nbasis=19) basis2=create.bspline.basis(rangeval=range(tt),nbasis=9) res5=fregre.basis(x,y,basis1,basis2) summary(res5) x.d2=fdata.deriv(x,nbasis=19,nderiv=1,method=\"bspline\",class.out=\"fdata\") res7=fregre.basis(x.d2,y,basis1,basis2) summary(res7) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap regression — fregre.bootstrap","title":"Bootstrap regression — fregre.bootstrap","text":"Estimate beta parameter wild smoothed bootstrap procedure","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap regression — fregre.bootstrap","text":"","code":"fregre.bootstrap(   model,   nb = 500,   wild = TRUE,   type.wild = \"golden\",   newX = NULL,   smo = 0.1,   smoX = 0.05,   alpha = 0.95,   kmax.fix = FALSE,   draw = TRUE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap regression — fregre.bootstrap","text":"model fregre.pc, fregre.pls fregre.basis object. nb Number bootstrap samples. wild Naive smoothed bootstrap depending smo smoX parameters. type.wild Type distribution V wild bootstrap procedure, see rwild. newX fdata class containing values model covariates predictions required (smoothed bootstrap). smo \\(>0\\), smoothed bootstrap residuals (proportion response variance). smoX \\(>0\\), smoothed bootstrap explanatory functional variable fdata (proportion variance-covariance matrix fdata object. alpha Significance level used graphical option, draw=TRUE. kmax.fix number maximum components consider bootstrap iteration.  =TRUE, bootstrap procedure considers number components used previous fitted model.  =FALSE, bootstrap procedure estimates best components iteration. draw =TRUE, plot bootstrap estimated beta, (optional) CI predicted response values. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap regression — fregre.bootstrap","text":"Return: model: fregre.pc, fregre.pls fregre.basis object. beta.boot: Functional beta estimated nb bootstrap regressions. norm.boot: Norm differences nboot betas estimated bootstrap beta estimated regression model. coefs.boot: Matrix bootstrap estimated basis coefficients. kn.boot: Vector list length nb index basis, PC PLS factors selected bootstrap regression. y.pred: Predicted response values using newX covariates. y.boot: Matrix bootstrap predicted response values using newX covariates. newX: fdata class containing values model covariates predictions required (smoothed bootstrap).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bootstrap regression — fregre.bootstrap","text":"Estimate beta parameter wild smoothed bootstrap procedure using principal components representation fregre.pc, Partial least squares components (PLS) representation fregre.pls basis representation fregre.basis. new curves newX argument bootstrap method estimates response using bootstrap resamples. model exhibits heteroskedasticity, use wild bootstrap procedure recommended (default).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bootstrap regression — fregre.bootstrap","text":"Febrero-Bande, M., Galeano, P. Gonzalez-Manteiga, W. (2010). Measures influence functional linear model scalar response. Journal Multivariate Analysis 101, 327-339. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bootstrap regression — fregre.bootstrap","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.bootstrap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bootstrap regression — fregre.bootstrap","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) iest<-1:165 x=tecator$absorp.fdata[iest] y=tecator$y$Fat[iest] nb<-25  ## Time-consuming res.pc=fregre.pc(x,y,1:6) # Fix the compontents used in the each regression res.boot1=fregre.bootstrap(res.pc,nb=nb,wild=FALSE,kmax.fix=TRUE) # Select the \"best\" compontents used in the each regression res.boot2=fregre.bootstrap(res.pc,nb=nb,wild=FALSE,kmax.fix=FALSE)  res.boot3=fregre.bootstrap(res.pc,nb=nb,wild=FALSE,kmax.fix=10)  ## predicted responses and bootstrap confidence interval newx=tecator$absorp.fdata[-iest] res.boot4=fregre.bootstrap(res.pc,nb=nb,wild=FALSE,newX=newx,draw=TRUE) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"Computes functional regression functional explanatory variables \\((X^{1}(t_1),...,X^{q}(t_q))\\) scalar response \\(Y\\) using backfitting algorithm.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"","code":"fregre.gkam(   formula,   family = gaussian(),   data,   weights = rep(1, nobs),   par.metric = NULL,   par.np = NULL,   offset = NULL,   control = list(maxit = 100, epsilon = 0.001, trace = FALSE, inverse = \"solve\"),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"formula object class formula (one can coerced class): symbolic description model fitted. procedure considers functional covariates (implemented non-functional covariates). details model specification given Details. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions). data List containing variables model. weights weights par.metric List arguments covariate pass metric function covariate. par.np List arguments pass fregre.np.cv function offset can used specify priori known component included linear predictor fitting. control list parameters controlling fitting process, default: maxit, epsilon, trace inverse ... arguments passed methods. inverse =\"svd\" (default) =\"solve\" method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"result: List non-parametric estimation covariate. fitted.values: Estimated scalar response. residuals: y minus fitted values. effects: residual degrees freedom. alpha: Hat matrix. family: Coefficient determination. linear.predictors: Residual variance. deviance: Scalar response. aic: Functional explanatory data. null.deviance: Non functional explanatory data. iter: Distance matrix curves. w: Beta coefficient estimated. eqrank: List containing variables model. prior.weights: Asymmetric kernel used. y: Scalar response. H: Hat matrix, see Opsomer Ruppert (1997) details. converged: Conv.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"smooth functions \\(f(.)\\) estimated nonparametrically using iterative local scoring algorithm applying Nadaraya-Watson weighted kernel smoothers using fregre.np.cv step, see Febrero-Bande Gonzalez-Manteiga (2011) details. Consider fitted response \\(\\hat{Y}=g^{-1}(H_{Q}y)\\), \\(H_{Q}\\) weighted hat matrix. Opsomer Ruppert (1997) solves system equations fit unknowns \\(f(\\cdot)\\) computing additive smoother matrix \\(H_k\\) \\(\\hat{f}_k (X^k)=H_{k}Y\\) \\(H_Q=H_1+,\\cdots,+H_q\\). additive model fitted follows: $$\\hat{Y}=g^{-1}\\Big(\\sum_i^q \\hat{f_i}(X_i)\\Big)$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"Febrero-Bande M. Gonzalez-Manteiga W. (2012). Generalized Additive Models Functional Data. TEST. Springer-Velag.  doi:10.1007/s11749-012-0308-0 Opsomer J.D. Ruppert D.(1997). Fitting bivariate additive model local polynomial regression.Annals Statistics, 25, 186-211.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"Febrero-Bande, M. Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gkam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting Functional Generalized Kernel Additive Models. — fregre.gkam","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) ab=tecator$absorp.fdata[1:100] ab2=fdata.deriv(ab,2) yfat=tecator$y[1:100,\"Fat\"]  # Example 1: # Changing the argument par.np and family yfat.cat=ifelse(yfat<15,0,1) xlist=list(\"df\"=data.frame(yfat.cat),\"ab\"=ab,\"ab2\"=ab2) f2<-yfat.cat~ab+ab2  par.NP<-list(\"ab\"=list(Ker=AKer.norm,type.S=\"S.NW\"), \"ab2\"=list(Ker=AKer.norm,type.S=\"S.NW\")) res2=fregre.gkam(f2,family=binomial(),data=xlist, par.np=par.NP) res2  # Example 2: Changing the argument par.metric and family link par.metric=list(\"ab\"=list(metric=semimetric.deriv,nderiv=2,nbasis=15), \"ab2\"=list(\"metric\"=semimetric.basis)) res3=fregre.gkam(f2,family=binomial(\"probit\"),data=xlist, par.metric=par.metric,control=list(maxit=2,trace=FALSE)) summary(res3)  # Example 3: Gaussian family (by default) # Only 1 iteration (by default maxit=100) xlist=list(\"df\"=data.frame(yfat),\"ab\"=ab,\"ab2\"=ab2) f<-yfat~ab+ab2 res=fregre.gkam(f,data=xlist,control=list(maxit=1,trace=FALSE)) res } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting Functional Generalized Linear Models — fregre.glm","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"Computes functional generalized linear model functional covariate \\(X^j(t)\\) (non functional covariate \\(Z^j\\)) scalar response \\(Y\\) using basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"","code":"fregre.glm(   formula,   family = gaussian(),   data,   basis.x = NULL,   basis.b = NULL,   subset = NULL,   weights = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) data List containing variables model. basis.x List basis functional explanatory data estimation. basis.b List basis \\(\\beta(t)\\) parameter estimation. subset optional vector specifying subset observations used fitting process. weights weights ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"Return glm object plus: basis.x: Basis used fdata fd covariates. basis.b: Basis used beta parameter estimation. beta.l: List estimated beta parameter functional covariates. data: List contains variables model. formula: Formula.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"function extension linear regression models: fregre.lm \\(E[Y|X,Z]\\) related linear prediction \\(\\eta\\) via link function \\(g(.)\\). $$E[Y|X,Z]=\\eta=g^{-1}(\\alpha+\\sum_{j=1}^{p}\\beta_{j}Z^{j}+\\sum_{k=1}^{q}\\frac{1}{\\sqrt{T_k}}\\int_{T_k}{X^{k}(t)\\beta_{k}(t)dt})$$ \\(Z=\\left[ Z^1,\\cdots,Z^p \\right]\\) non functional covariates \\(X(t)=\\left[ X^{1}(t_1),\\cdots,X^{q}(t_q) \\right]\\) functional ones. first item data list called \"df\" data frame response non functional explanatory variables, glm. Functional covariates class fdata fd introduced following items data list.basis.x list basis represent functional covariate. basis object can created function: create.pc.basis, pca.fd create.pc.basis, create.fdata.basis o create.basis.basis.b list basis represent \\(\\beta(t)\\) parameter. basis.x list functional principal components basis (see create.pc.basis pca.fd) argument basis.b ignored. represent beta lower number basis used represent functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"formula contains non functional explanatory variables (multivariate covariates), function compute standard glm procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. McCullagh Nelder (1989), Generalized Linear Models 2nd ed. Chapman Hall. Venables, W. N. Ripley, B. D. (2002) Modern Applied Statistics S, New York: Springer.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting Functional Generalized Linear Models — fregre.glm","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) x=tecator$absorp.fdata y=tecator$y$Fat tt=x[[\"argvals\"]] dataf=as.data.frame(tecator$y) nbasis.x=11 nbasis.b=7 basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x) basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b) f=Fat~Protein+x basis.x=list(\"x\"=basis1) basis.b=list(\"x\"=basis2) ldata=list(\"df\"=dataf,\"x\"=x) res=fregre.glm(f,family=gaussian(),data=ldata,basis.x=basis.x, basis.b=basis.b) summary(res) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":null,"dir":"Reference","previous_headings":"","what":"Variable Selection using Functional Linear Models — fregre.glm.vs","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"Computes functional GLM model functional covariates  \\((X^1(t_1),\\cdots,X^{q}(t_q))\\) non functional covariates   \\((Z^1,...,Z^p)\\) scalar response \\(Y\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"","code":"fregre.glm.vs(   data = list(),   y,   include = \"all\",   exclude = \"none\",   family = gaussian(),   weights = NULL,   basis.x = NULL,   numbasis.opt = FALSE,   dcor.min = 0.1,   alpha = 0.05,   par.model,   xydist,   trace = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"data List containing variables model. \"df\" element data.frame containing response scalar covariates (numeric factors variables allowed). Functional covariates class   fdata fd included named components data list. y Caracter string name scalar response variable. include vector name variables use. default \"\", variables used. exclude vector name variables use. default  \"none\", variable deleted. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) weights weights basis.x Basis parameter options list (recomended)  List basis functional covariates, see argument fregre.glm. default, function uses basis 3 PC represent functional covariate. vector (default) Vector two parameters: Type basis. default basis.x[1]=\"pc\", principal   component basis used  functional covariate included model.   options \"pls\" \"bspline\". Maximum number  basis elements numbasis  used. default, basis.x[2]=3. numbasis.opt Logical, FALSE default, functional covariate included model, function uses basis elements. Otherwise, function selects significant coefficients. dcor.min Threshold variable entered model. X discarded distance correlation \\(R(X,e)< dcor.min\\) (e residual previous steps). alpha Alpha value testing independence among covariate X residual e previous steps. default 0.05. par.model Model parameters. xydist List inner distance matrices variable (potential covariates response). trace Interactive Tracing Debugging Call.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"Return object corresponding estimated additive mdoel using selected variables (ame output thefregre.glm function) following elements: gof, goodness fit step VS algorithm. .predictor, vector 1 variable selected, 0 otherwise. ipredictor, vector name selected variables (order selection) dcor, value distance correlation potential covariate residual model step.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"function extension functional generalized spectral additive regression models: fregre.glm \\(E[Y|X,Z]\\) related linear prediction \\(\\eta\\) via link function \\(g(\\cdot)\\). $$E[Y|X,Z]=\\eta=g^{-1}(\\alpha+\\sum_{j=1}^{p}\\beta_{j}Z^{j}+\\sum_{k=1}^{q}\\frac{1}{\\sqrt{T_k}}\\int_{T_k}{X^{k}(t)\\beta_{k}(t)dt})$$ \\(Z=\\left[ Z^1,\\cdots,Z^p \\right]\\) non functional covariates \\(X(t)=\\left[ X^{1}(t_1),\\cdots,X^{q}(t_q) \\right]\\) functional ones.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"formula contains non functional explanatory variables (multivariate covariates),  function compute standard  glm procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"Febrero-Bande, M., Gonz\\'alez-Manteiga, W. Oviedo de la Fuente, M. Variable selection functional additive regression models, (2018).  Computational Statistics, 1-19. DOI: doi:10.1007/s00180-018-0844-5","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"Manuel Febrero-Bande, Manuel Oviedo-de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.glm.vs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variable Selection using Functional Linear Models — fregre.glm.vs","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) x=tecator$absorp.fdata x1 <- fdata.deriv(x) x2 <- fdata.deriv(x,nderiv=2) y=tecator$y$Fat xcat0 <- cut(rnorm(length(y)),4) xcat1 <- cut(tecator$y$Protein,4) xcat2 <- cut(tecator$y$Water,4) ind <- 1:165 dat <- data.frame(\"Fat\"=y, x1$data, xcat1, xcat2) ldat <- ldata(\"df\"=dat[ind,],\"x\"=x[ind,],\"x1\"=x1[ind,],\"x2\"=x2[ind,]) # 3 functionals (x,x1,x2), 3 factors (xcat0, xcat1, xcat2) # and 100 scalars (impact poitns of x1)   # Time consuming res.glm0 <- fregre.glm.vs(data=ldat,y=\"Fat\",numbasis.opt=T) # All the covariates summary(res.glm0) res.glm0$ipredictors res.glm0$i.predictor  res.glm1 <- fregre.glm.vs(data=ldat,y=\"Fat\") # All the covariates summary(res.glm1) res.glm1$ipredictors covar <- c(\"xcat0\",\"xcat1\",\"xcat2\",\"x\",\"x1\",\"x2\") res.glm2 <- fregre.glm.vs(data=ldat, y=\"Fat\", include=covar) summary(res.glm2) res.glm2$ipredictors  res.glm2$i.predictor  res.glm3 <- fregre.glm.vs(data=ldat,y=\"Fat\",                            basis.x=c(\"type.basis\"=\"pc\",\"numbasis\"=2)) summary(res.glm3) res.glm3$ipredictors  res.glm4 <- fregre.glm.vs(data=ldat,y=\"Fat\",include=covar, basis.x=c(\"type.basis\"=\"pc\",\"numbasis\"=5),numbasis.opt=T) summary(res.glm4) res.glm4$ipredictors lpc <- list(\"x\"=create.pc.basis(ldat$x,1:4)            ,\"x1\"=create.pc.basis(ldat$x1,1:3)            ,\"x2\"=create.pc.basis(ldat$x2,1:4)) res.glm5 <- fregre.glm.vs(data=ldat,y=\"Fat\",basis.x=lpc) summary(res.glm5) res.glm5 <- fregre.glm.vs(data=ldat,y=\"Fat\",basis.x=lpc,numbasis.opt=T) summary(res.glm5) bsp <- create.fourier.basis(ldat$x$rangeval,7) lbsp <- list(\"x\"=bsp,\"x1\"=bsp,\"x2\"=bsp) res.glm6 <- fregre.glm.vs(data=ldat,y=\"Fat\",basis.x=lbsp) summary(res.glm6) # Prediction like fregre.glm()  newldat <- ldata(\"df\"=dat[-ind,],\"x\"=x[-ind,],\"x1\"=x1[-ind,],                 \"x2\"=x2[-ind,]) pred.glm1 <- predict(res.glm1,newldat) pred.glm2 <- predict(res.glm2,newldat) pred.glm3 <- predict(res.glm3,newldat) pred.glm4 <- predict(res.glm4,newldat) pred.glm5 <- predict(res.glm5,newldat) pred.glm6 <- predict(res.glm6,newldat) plot(dat[-ind,\"Fat\"],pred.glm1) points(dat[-ind,\"Fat\"],pred.glm2,col=2) points(dat[-ind,\"Fat\"],pred.glm3,col=3) points(dat[-ind,\"Fat\"],pred.glm4,col=4) points(dat[-ind,\"Fat\"],pred.glm5,col=5) points(dat[-ind,\"Fat\"],pred.glm6,col=6) pred2meas(newldat$df$Fat,pred.glm1) pred2meas(newldat$df$Fat,pred.glm2) pred2meas(newldat$df$Fat,pred.glm3) pred2meas(newldat$df$Fat,pred.glm4) pred2meas(newldat$df$Fat,pred.glm5) pred2meas(newldat$df$Fat,pred.glm6) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"function fits functional linear model using generalized least squares. errors allowed correlated /unequal variances.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"","code":"fregre.gls(   formula,   data,   correlation = NULL,   basis.x = NULL,   basis.b = NULL,   rn,   lambda,   weights = NULL,   subset,   method = c(\"REML\", \"ML\"),   control = list(),   verbose = FALSE,   criteria = \"GCCV1\",   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"formula two-sided linear formula object describing model, response left ~ operator terms, separated + operators, right. data optional data frame containing variables named model, correlation, weights, subset. default variables taken environment gls called. correlation optional corStruct object describing within-group correlation structure. See documentation corClasses description available corStruct classes. grouping variable used, must specified form argument corStruct constructor. Defaults NULL, corresponding uncorrelated errors. basis.x List basis functional explanatory data estimation. basis.b List basis \\(\\beta(t)\\) parameter estimation. rn List Ridge parameter. lambda List Roughness penalty parameter. weights optional varFunc object one-sided formula describing within-group heteroscedasticity structure. given formula, used argument varFixed, corresponding fixed variance weights. See documentation varClasses description available varFunc classes. Defaults NULL, corresponding homoscedastic errors. subset optional expression indicating subset rows data used fit. can logical vector, numeric vector indicating observation numbers included, character vector row names included.  observations included default. method character string.  \"REML\" model fit maximizing restricted log-likelihood.  \"ML\" log-likelihood maximized.  Defaults \"REML\". control list control values estimation algorithm replace default values returned function glsControl.  Defaults empty list. verbose optional logical value. TRUE information evolution iterative algorithm printed. Default FALSE. criteria GCCV criteria, see GCCV.S. ... methods generic require additional arguments. None used method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"object class \"gls\" representing functional linear model fit. Generic functions print, plot, summary methods show results fit. See glsObject components fit. functions resid, coef, fitted can used extract components. Besides, class(z) \"gls\", \"lm\", \"fregre.lm\" following objects: sr2: Residual variance. Vp: Estimated covariance matrix parameters. lambda: roughness penalty. basis.x: Basis used fdata fd covariates. basis.b: Basis used beta parameter estimation. beta.l: List estimated beta parameter functional covariates. data: List containing variables model. formula: Formula used adjusted model. formula.ini: Formula call. W: Inverse covariance matrix. correlation: See glsObject components fit.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"Oviedo de la Fuente, M., Febrero-Bande, M., Pilar Munoz, Dominguez, .  (2018). Predicting seasonal influenza transmission using functional regression models temporal dependence. PloS one, 13(4), e0194250. doi:10.1371/journal.pone.0194250","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Functional Linear Model Using Generalized Least Squares — fregre.gls","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) x=tecator$absorp.fdata x.d2<-fdata.deriv(x,nderiv=) tt<-x[[\"argvals\"]] dataf=as.data.frame(tecator$y)  # plot the response plot(ts(tecator$y$Fat))  nbasis.x=11;nbasis.b=7 basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x) basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b) basis.x=list(\"x.d2\"=basis1) basis.b=list(\"x.d2\"=basis2) ldata=list(\"df\"=dataf,\"x.d2\"=x.d2) res.gls=fregre.gls(Fat~x.d2,data=ldata, correlation=corAR1(),                    basis.x=basis.x,basis.b=basis.b) summary(res.gls)                    } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"Computes functional GAM model functional covariate \\((X^1(t_1), \\dots, X^{q}(t_q))\\) non-functional covariate \\((Z^1, ..., Z^p)\\) scalar response \\(Y\\). function extends functional generalized linear regression models (fregre.glm) \\(E[Y|X,Z]\\) related linear predictor \\(\\eta\\) via link function \\(g(\\cdot)\\) integrated smoothness estimation smooth functions \\(f(\\cdot)\\). $$E[Y|X,Z]=\\eta=g^{-1}\\left(\\alpha+\\sum_{=1}^{p}f_{}(Z^{})+\\sum_{k=1}^{q}\\sum_{j=1}^{k_q} f_{j}^{k}(\\xi_j^k)\\right)$$ \\(\\xi_j^k\\) coefficient basis function expansion \\(X^k\\); PCA analysis, \\(\\xi_j^k\\) score \\(j\\)-functional PC \\(X^k\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"","code":"fregre.gsam(   formula,   family = gaussian(),   data = list(),   weights = NULL,   basis.x = NULL,   basis.b = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) data List containing variables model. weights weights basis.x List basis functional explanatory data estimation. basis.b List basis functional beta parameter estimation. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"Return gam object plus: basis.x: Basis used fdata fd covariates. basis.b: Basis used beta parameter estimation. data: List containing variables model. formula: Formula used model. y.pred: Predicted response cross-validation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"smooth functions \\(f(\\cdot)\\) can added right-hand side formula specify linear predictor depends smooth functions predictors using smooth terms s te gam (linear functionals \\(Z \\beta\\) \\(\\langle X(t), \\beta \\rangle\\) fregre.glm). first item data list called \"df\" data frame response non-functional explanatory variables, gam. Functional covariates class fdata fd introduced following items data list.basis.x list basis functions representing functional covariate. basis object can created using functions create.pc.basis, pca.fd, create.fdata.basis, create.basis.basis.b list basis functions representing functional beta parameter. basis.x list functional principal components basis functions (see create.pc.basis pca.fd), argument basis.b ignored.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"formula contains non functional explanatory variables (multivariate covariates), function compute standard glm procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"Muller HG Stadtmuller U. (2005). Generalized functional linear models. Ann. Statist.33 774-805. Wood (2001) mgcv:GAMs Generalized Ridge Regression R. R News 1(2):20-25. Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. Venables, W. N. Ripley, B. D. (2002) Modern Applied Statistics S, New York: Springer.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting Functional Generalized Spectral Additive Models — fregre.gsam","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x <- tecator$absorp.fdata x.d1 <- fdata.deriv(x) tt <- x[[\"argvals\"]] dataf <- as.data.frame(tecator$y) nbasis.x <- 11 nbasis.b <- 5 basis1 <- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x) basis2 <- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b) f <- Fat ~ s(Protein) + s(x) basis.x <- list(\"x\"=basis1,\"x.d1\"=basis1) basis.b <- list(\"x\"=basis2,\"x.d1\"=basis2) ldat <- ldata(\"df\" = dataf, \"x\" = x , \"x.d1\" = x.d1) res <- fregre.gsam(Fat ~ Water + s(Protein) + x + s(x.d1), ldat,                    family = gaussian(),  basis.x = basis.x,                    basis.b = basis.b) summary(res) pred <- predict(res,ldat) plot(pred-res$fitted) pred2 <- predict.gam(res,res$XX) plot(pred2-res$fitted) plot(pred2-pred) res2 <- fregre.gsam(Fat ~ te(Protein, k = 3) + x, data =  ldat,                      family=gaussian()) summary(res2)  ##  dropind basis pc basis.pc0 <- create.pc.basis(x,c(2,4,7)) basis.pc1 <- create.pc.basis(x.d1,c(1:3)) basis.x <- list(\"x\"=basis.pc0,\"x.d1\"=basis.pc1) ldata <- ldata(\"df\"=dataf,\"x\"=x,\"x.d1\"=x.d1)   res.pc <- fregre.gsam(f,data=ldata,family=gaussian(),           basis.x=basis.x,basis.b=basis.b) summary(res.pc)   ##  Binomial family ldat$df$FatCat <- factor(ifelse(tecator$y$Fat > 20, 1, 0)) res.bin <- fregre.gsam(FatCat ~ Protein + s(x),ldat,family=binomial()) summary(res.bin) table(ldat$df$FatCat, ifelse(res.bin$fitted.values < 0.5,0,1)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":null,"dir":"Reference","previous_headings":"","what":"Variable Selection using Functional Additive Models — fregre.gsam.vs","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"Computes functional GAM model functional covariates  \\((X^1(t_1),\\cdots,X^{q}(t_q))\\) non functional covariates   \\((Z^1,...,Z^p)\\) scalar response \\(Y\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"","code":"fregre.gsam.vs(   data = list(),   y,   include = \"all\",   exclude = \"none\",   family = gaussian(),   weights = NULL,   basis.x = NULL,   numbasis.opt = FALSE,   kbs,   dcor.min = 0.1,   alpha = 0.05,   par.model,   xydist,   trace = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"data List containing variables model. \"df\" element data.frame containing response scalar covariates (numeric factors variables allowed). Functional covariates class   fdata fd included named components data list. y Caracter string name scalar response variable. include vector name variables use. default \"\", variables used. exclude vector name variables use. default  \"none\", variable deleted. family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) weights weights basis.x Basis parameter options list (recomended)  List basis functional covariates, see argument fregre.glm. default, function uses basis 3 PC represent functional covariate. vector (default) Vector two parameters: Type basis. default basis.x[1]=\"pc\", principal   component basis used  functional covariate included model.   options \"pls\" \"bspline\". Maximum number  basis elements numbasis  used. default, basis.x[2]=3. numbasis.opt Logical, FALSE default, functional covariate included model, function uses basis elements. Otherwise, function selects significant coefficients. kbs dimension basis used represent smooth term. default depends number variables smooth function . dcor.min Threshold variable entered model. X discarded distance correlation \\(R(X,e)< dcor.min\\) (e residual previous steps). alpha Alpha value testing independence among covariate X residual e previous steps. default 0.05. par.model Model parameters. xydist List inner distance matrices variable (potential covariates response). trace Interactive Tracing Debugging Call.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"Return object corresponding estimated additive mdoel using selected variables (ame output thefregre.gsam function) following elements: gof: goodness fit step VS algorithm. .predictor: vector 1 variable selected, 0 otherwise. ipredictor: vector name selected variables (order selection) dcor: value distance correlation potential covariate residual model step.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"function extension functional generalized spectral additive regression models: fregre.gsam \\(E[Y|X,Z]\\) related linear prediction \\(\\eta\\) via link function \\(g(\\cdot)\\) integrated smoothness estimation smooth functions \\(f(\\cdot)\\). $$E[Y|X,Z] = \\eta = g^{-1}(\\alpha + \\sum_{=1}^{p} f_{}(Z^{}) + \\sum_{k=1}^{q} \\sum_{j=1}^{k_q} f_{j}^{k}(\\xi_j^k))$$ \\(\\xi_j^k\\) coefficient basis function expansion \\(X^k\\), (PCA analysis, \\(\\xi_j^k\\) score \\(j\\)-functional PC \\(X^k\\)). smooth functions \\(f(\\cdot)\\) can added right-hand side formula specify linear predictor depends smooth functions predictors using smooth terms s te gam (linear functionals \\(Z\\beta\\) \\(\\langle X(t), \\beta(t) \\rangle\\) fregre.glm).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"formula contains non functional explanatory variables (multivariate covariates),  function compute standard  gam procedure.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"Febrero-Bande, M., Gonz\\'alez-Manteiga, W. Oviedo de la Fuente, M. Variable selection functional additive regression models, (2018).  Computational Statistics, 1-19. DOI: doi:10.1007/s00180-018-0844-5","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"Manuel Feb-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.gsam.vs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variable Selection using Functional Additive Models — fregre.gsam.vs","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) x=tecator$absorp.fdata x1 <- fdata.deriv(x) x2 <- fdata.deriv(x,nderiv=2) y=tecator$y$Fat xcat0 <- cut(rnorm(length(y)),4)  xcat1 <- cut(tecator$y$Protein,4) xcat2 <- cut(tecator$y$Water,4) ind <- 1:165 dat <- data.frame(\"Fat\"=y, x1$data, xcat1, xcat2) ldat <- ldata(\"df\"=dat[ind,],\"x\"=x[ind,],\"x1\"=x1[ind,],\"x2\"=x2[ind,]) # 3 functionals (x,x1,x2), 3 factors (xcat0, xcat1, xcat2) # and 100 scalars (impact poitns of x1)   # Time consuming res.gam0 <- fregre.gsam.vs(data=ldat,y=\"Fat\"             ,exclude=\"x2\",numbasis.opt=T) # All the covariates summary(res.gam0) res.gam0$ipredictors  res.gam1 <- fregre.gsam.vs(data=ldat,y=\"Fat\") # All the covariates summary(res.gam1) res.gam1$ipredictors  covar <- c(\"xcat0\",\"xcat1\",\"xcat2\",\"x\",\"x1\",\"x2\") res.gam2 <- fregre.gsam.vs(data=ldat, y=\"Fat\", include=covar) summary(res.gam2) res.gam2$ipredictors  res.gam2$i.predictor  res.gam3 <- fregre.gsam.vs(data=ldat,y=\"Fat\",             basis.x=c(\"type.basis\"=\"pc\",\"numbasis\"=10)) summary(res.gam3) res.gam3$ipredictors  res.gam4 <- fregre.gsam.vs(data=ldat,y=\"Fat\",include=c(\"x\",\"x1\",\"x2\"), basis.x=c(\"type.basis\"=\"pc\",\"numbasis\"=5),numbasis.opt=T) summary(res.gam4) res.gam4$ipredictors lpc <- list(\"x\"=create.pc.basis(ldat$x,1:4)            ,\"x1\"=create.pc.basis(ldat$x1,1:3)            ,\"x2\"=create.pc.basis(ldat$x2,1:12)) res.gam5 <- fregre.gsam.vs(data=ldat,y=\"Fat\",basis.x=lpc) summary(res.gam5) res.gam6 <- fregre.gsam.vs(data=ldat,y=\"Fat\",basis.x=lpc,numbasis.opt=T) summary(res.gam6) bsp <- create.fourier.basis(ldat$x$rangeval,7) lbsp <- list(\"x\"=bsp,\"x1\"=bsp,\"x2\"=bsp) res.gam7 <- fregre.gsam.vs(data=ldat,y=\"Fat\",basis.x=lbsp,kbs=4) summary(res.gam7) # Prediction like fregre.gsam()  newldat <- ldata(\"df\"=dat[-ind,],\"x\"=x[-ind,],\"x1\"=x1[-ind,],                 \"x2\"=x2[-ind,]) pred.gam1 <- predict(res.gam1,newldat) pred.gam2 <- predict(res.gam2,newldat) pred.gam3 <- predict(res.gam3,newldat) pred.gam4 <- predict(res.gam4,newldat) pred.gam5 <- predict(res.gam5,newldat) pred.gam6 <- predict(res.gam6,newldat) pred.gam7 <- predict(res.gam7,newldat) plot(dat[-ind,\"Fat\"],pred.gam1) points(dat[-ind,\"Fat\"],pred.gam2,col=2) points(dat[-ind,\"Fat\"],pred.gam3,col=3) points(dat[-ind,\"Fat\"],pred.gam4,col=4) points(dat[-ind,\"Fat\"],pred.gam5,col=5) points(dat[-ind,\"Fat\"],pred.gam6,col=6) points(dat[-ind,\"Fat\"],pred.gam7,col=7) pred2meas(newldat$df$Fat,pred.gam1) pred2meas(newldat$df$Fat,pred.gam2) pred2meas(newldat$df$Fat,pred.gam3) pred2meas(newldat$df$Fat,pred.gam4) pred2meas(newldat$df$Fat,pred.gam5) pred2meas(newldat$df$Fat,pred.gam6) pred2meas(newldat$df$Fat,pred.gam7) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"function fits iteratively functional linear model using generalized least squares. errors allowed correlated /unequal variances. Begin preliminary estimation \\(\\hat{\\theta}=\\theta_0\\) (instance,  \\(\\theta_0=0\\)). Compute \\(\\hat{W}\\). Estimate \\(b_\\Sigma =(Z'\\hat{W}Z)^{-1}Z'\\hat{W}y\\) Based residuals, \\(\\hat{e}=\\left(y-Zb_\\Sigma \\right)\\), update  \\(\\hat{\\theta}=\\rho\\left({\\hat{e}}\\right)\\) \\(\\rho\\) depends  dependence structure chosen. Repeats steps 2 3 convergence (small changes \\(b_\\Sigma\\) /\\(\\hat{\\theta}\\)).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"","code":"fregre.igls(   formula,   data,   basis.x = NULL,   basis.b = NULL,   correlation,   maxit = 100,   rn,   lambda,   weights = rep(1, n),   control,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"formula two-sided linear formula object describing model, response left ~ operator terms, separated + operators, right. data optional data frame containing variables named model, correlation, weights, subset. default variables taken environment  gls called. basis.x List basis functional explanatory data estimation. basis.b List basis \\(\\beta(t)\\) parameter estimation. correlation List  describing  correlation structure. Defaults NULL, corresponding uncorrelated errors. See following internal functions  description code example script file. corUnstruc(x), fit unstrutured correlation. cor.AR(x, order.max = 8, p=1, method = \"lm\") fit Autoregressive Models Time Series using ar function. cor.ARMA(x, p, d = 0, q = 0, method = \"lm\", order.max = 1) Fit   ARIMA model univariate time series using arima function. corExpo(xy,range, method = \"euclidean\",p=2) Fit exponential correlation structure. maxit Number maximum interactions. rn List Ridge parameter. lambda List Roughness penalty parameter. weights weights control Control parameters. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"object class fregre.igls representing functional linear model fit temporal dependence errors. Beside, class(z)  similar \"fregre.lm\" plus following objects: corStruct: Fitted  AR ARIMA model.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"Oviedo de la Fuente, M., Febrero-Bande, M., Pilar Munoz, Dominguez, .  (2018). Predicting seasonal influenza transmission using functional regression models temporal dependence. PloS one, 13(4), e0194250. doi:10.1371/journal.pone.0194250","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.igls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit of Functional Generalized Least Squares Model Iteratively — fregre.igls","text":"","code":"if (FALSE) { # \\dontrun{  data(tecator) x=tecator$absorp.fdata x.d2<-fdata.deriv(x,nderiv=) tt<-x[[\"argvals\"]] dataf=as.data.frame(tecator$y) # plot the response plot(ts(tecator$y$Fat)) ldata=list(\"df\"=dataf,\"x.d2\"=x.d2) res.gls=fregre.igls(Fat~x.d2,data=ldata, correlation=list(\"cor.ARMA\"=list()), control=list(\"p\"=1))  res.gls res.gls$corStruct } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting Functional Linear Models — fregre.lm","title":"Fitting Functional Linear Models — fregre.lm","text":"Computes functional regression functional (non functional) explanatory variables scalar response using basis representation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting Functional Linear Models — fregre.lm","text":"","code":"fregre.lm(   formula,   data,   basis.x = NULL,   basis.b = NULL,   lambda = NULL,   P = NULL,   weights = rep(1, n),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting Functional Linear Models — fregre.lm","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. data List containing variables model. Functional covariates recommended class fdata. Objects class \"fd\" can used user's risk. basis.x List basis functional explanatory data estimation. basis.b List basis functional beta parameter estimation. lambda List, indexed names functional covariates, contains Roughness penalty parameter. P List, indexed names functional covariates, contains parameters creation penalty matrix. weights weights ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting Functional Linear Models — fregre.lm","text":"Return lm object plus: sr2: Residual variance. Vp: Estimated covariance matrix parameters. lambda: roughness penalty. basis.x: Basis used fdata fd covariates. basis.b: Basis used beta parameter estimation. beta.l: List estimated beta parameter functional covariates. data: List containing variables model. formula: Formula used model.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitting Functional Linear Models — fregre.lm","text":"section presented extension linear regression models: fregre.pc, fregre.pls fregre.basis. Now, scalar response \\(Y\\) estimated one functional covariate \\(X^j(t)\\) also one non functional covariate \\(Z^j\\). regression model given : $$E[Y|X,Z]=\\alpha+\\sum_{j=1}^{p}\\beta_{j}Z^{j}+\\sum_{k=1}^{q}\\frac{1}{\\sqrt{T_k}}\\int_{T_k}{X^{k}(t)\\beta_{k}(t)dt} $$ \\(Z=\\left[ Z^1,\\cdots,Z^p \\right]\\) non functional covariates, \\(X(t)=\\left[ X^{1}(t_1),\\cdots,X^{q}(t_q) \\right]\\) functional ones \\(\\epsilon\\) random errors mean zero , finite variance \\(\\sigma^2\\) \\(E[X(t)\\epsilon]=0\\). first item data list called \"df\" data frame response non functional explanatory variables, lm. Functional covariates class fdata fd introduced following items data list. basis.x list basis represent functional covariate. basis object can created function: create.pc.basis, pca.fd create.pc.basis, create.fdata.basis create.basis.basis.b list basis represent functional \\(\\beta_k\\) parameter. basis.x list functional principal components basis (see create.pc.basis pca.fd) argument basis.b (unnecessary ) ignored. Penalty options development, guaranteed work properly. user can penalty basis elements : () lambda list rough penalty values functional covariate, see  P.penalty details.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fitting Functional Linear Models — fregre.lm","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fitting Functional Linear Models — fregre.lm","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.lm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting Functional Linear Models — fregre.lm","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x <- tecator$absorp.fdata y <- tecator$y$Fat tt <- x[[\"argvals\"]] dataf <- as.data.frame(tecator$y)  nbasis.x <- 11 nbasis.b <- 5 basis1 <- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x) basis2 <- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b) basis.x <- list(\"x\"=basis1) basis.b <- list(\"x\"=basis2) f <- Fat ~ Protein + x ldat <- ldata(\"df\"=dataf,\"x\"=x) res <- fregre.lm(f,ldat,  basis.b=basis.b) summary(res) f2 <- Fat ~ Protein + xd +xd2 xd <- fdata.deriv(x,nderiv=1,class.out='fdata', nbasis=nbasis.x) xd2 <- fdata.deriv(x,nderiv=2,class.out='fdata', nbasis=nbasis.x) ldat2 <- list(\"df\"=dataf,\"xd\"=xd,\"x\"=x,\"xd2\"=xd2) basis.x2 <- NULL#list(\"xd\"=basis1) basis.b2 <- NULL#list(\"xd\"=basis2) basis.b2 <- list(\"xd\"=basis2,\"xd2\"=basis2,\"x\"=basis2) res2 <- fregre.lm(f2, ldat2,basis.b=basis.b2) summary(res2) par(mfrow=c(2,1)) plot(res$beta.l$x,main=\"functional beta estimation\") plot(res2$beta.l$xd,col=2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"Computes functional regression functional explanatory variables scalar response using asymmetric kernel estimation cross-validation method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"","code":"fregre.np.cv(   fdataobj,   y,   h = NULL,   Ker = AKer.norm,   metric = metric.lp,   type.CV = GCV.S,   type.S = S.NW,   par.CV = list(trim = 0),   par.S = list(w = 1),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"fdataobj fdata class object. y Scalar response length n. h Bandwidth, h>0. Default argument values provided sequence length 25 2.5%–quantile 25%–quantile distance fdataobj curves, see h.default. Ker Type asymmetric kernel used, default asymmetric normal kernel. metric Metric function, default metric.lp. type.CV Type cross-validation. default generalized cross-validation GCV.S method. type.S Type smothing matrix S. default S calculated Nadaraya-Watson kernel estimator (S.NW). par.CV List parameters type.CV: trim, alpha trimming draw=TRUE. par.S List parameters type.S: w, weights. ... Arguments passed metric.lp o metric function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"Return: call: matched call. residuals: y minus fitted values. fitted.values: Estimated scalar response. df.residual: residual degrees freedom. r2: Coefficient determination. sr2: Residual variance. H: Hat matrix. y: Response. fdataobj: Functional explanatory data. mdist: Distance matrix x newx. Ker: Asymmetric kernel used. gcv: CV GCV values. h.opt: Smoothing parameter bandwidth minimizes CV GCV method. h: Vector smoothing parameter bandwidth. cv: List fitted values residuals estimated CV, without curve.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"non-parametric functional regression model can written follows $$ y_i =r(X_i) + \\epsilon_i $$ unknown smooth real function \\(r\\) estimated using kernel estimation means $$\\hat{r}(X)=\\frac{\\sum_{=1}^{n}{K(h^{-1}d(X,X_{}))y_{}}}{\\sum_{=1}^{n}{K(h^{-1}d(X,X_{}))}}$$ \\(K\\) kernel function (see Ker argument), h smoothing parameter \\(d\\) metric semi-metric (see metric argument). function estimates value smoothing parameter (also called bandwidth) h Generalized Cross-validation GCV criteria, see GCV.S CV.S. function estimates value smoothing parameter bandwidth cross validation methods: GCV.S CV.S. computes distance curves using metric.lp, although semimetric used (see semimetric.basis semimetric.NPFDA functions). Different asymmetric kernels can used, see Kernel.asymmetric.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-validation functional regression with scalar response using kernel estimation. — fregre.np.cv","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp=tecator$absorp.fdata ind=1:129 x=absorp[ind,] y=tecator$y$Fat[ind] Ker=AKer.tri res.np=fregre.np.cv(x,y,Ker=Ker) summary(res.np) res.np2=fregre.np.cv(x,y,type.CV=GCV.S,criteria=\"Shibata\") summary(res.np2)  ## Example with other semimetrics (not run) res.pca1=fregre.np.cv(x,y,Ker=Ker,metric=semimetric.pca,q=1) summary(res.pca1) res.deriv=fregre.np.cv(x,y,Ker=Ker,metric=semimetric.deriv) summary(res.deriv)  x.d2=fdata.deriv(x,nderiv=1,method=\"fmm\",class.out='fdata') res.deriv2=fregre.np.cv(x.d2,y,Ker=Ker) summary(res.deriv2) x.d3=fdata.deriv(x,nderiv=1,method=\"bspline\",class.out='fdata') res.deriv3=fregre.np.cv(x.d3,y,Ker=Ker) summary(res.deriv3) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"Computes functional regression functional explanatory variables scalar response using kernel estimation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"","code":"fregre.np(   fdataobj,   y,   h = NULL,   Ker = AKer.norm,   metric = metric.lp,   type.S = S.NW,   par.S = list(w = 1),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"fdataobj fdata class object. y Scalar response length n. h Bandwidth, h>0. Default argument values provided 5%–quantile distance fdataobj curves, see h.default. Ker Type asymmetric kernel used, default asymmetric normal kernel. metric Metric function, default metric.lp. type.S Type smothing matrix S. default S calculated Nadaraya-Watson kernel estimator (S.NW). par.S List parameters type.S: w, weights. ... Arguments passed metric.lp o metric function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"Return: call: matched call. fitted.values: Estimated scalar response. H: Hat matrix. residuals: y minus fitted values. df.residual: residual degrees freedom. r2: Coefficient determination. sr2: Residual variance. y: Response. fdataobj: Functional explanatory data. mdist: Distance matrix x newx. Ker: Asymmetric kernel used. h.opt: Smoothing parameter bandwidth.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"non-parametric functional regression model can written follows $$y_i =r(X_i)+\\epsilon_i$$ unknown smooth real function \\(r\\) estimated using kernel estimation means $$\\hat{r}(X)=\\frac{\\sum_{=1}^{n}{K(h^{-1}d(X,X_{}))y_{}}}{\\sum_{=1}^{n}{K(h^{-1}d(X,X_{}))}}$$ \\(K\\) kernel function (see Ker argument), h smoothing parameter \\(d\\) metric semi-metric (see metric argument). distance curves calculated using metric.lp although semimetric used (see semimetric.basis semimetric.NPFDA functions). kernel applied metric semi-metrics provides non-negative values, common use asymmetric kernels. Different asymmetric kernels can used, see Kernel.asymmetric.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/ Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.np.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional regression with scalar response using non-parametric kernel estimation — fregre.np","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp=tecator$absorp.fdata ind=1:129 x=absorp[ind,] y=tecator$y$Fat[ind]  res.np=fregre.np(x,y,Ker=AKer.epa) summary(res.np) res.np2=fregre.np(x,y,Ker=AKer.tri) summary(res.np2)  # with other semimetrics. res.pca1=fregre.np(x,y,Ker=AKer.tri,metri=semimetric.pca,q=1) summary(res.pca1) res.deriv=fregre.np(x,y,metri=semimetric.deriv) summary(res.deriv) x.d2=fdata.deriv(x,nderiv=1,method=\"fmm\",class.out='fdata') res.deriv2=fregre.np(x.d2,y) summary(res.deriv2) x.d3=fdata.deriv(x,nderiv=1,method=\"bspline\",class.out='fdata') res.deriv3=fregre.np(x.d3,y) summary(res.deriv3) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"Functional Regression scalar response using selection number (penalized) principal components PC cross-validation. algorithm selects PC best estimates response. selection performed cross-validation (CV) Model Selection Criteria (MSC). computing functional regression using best selection principal components.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"","code":"fregre.pc.cv(   fdataobj,   y,   kmax = 8,   lambda = 0,   P = c(0, 0, 1),   criteria = \"SIC\",   weights = rep(1, len = n),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"fdataobj fdata class object. y Scalar response length n. kmax number components include model. lambda Vector amounts penalization. Default value 0, .e. penalization used.  lambda=TRUE algorithm computes sequence lambda values. P vector coefficients define penalty matrix object. example, P=c(1,0,0), ridge regresion computed P=c(0,0,1), penalized regression computed penalizing second derivative (curvature). criteria Type cross-validation (CV) Model Selection Criteria (MSC) applied. Possible values \"CV\", \"AIC\", \"AICc\", \"SIC\", \"SICc\", \"HQIC\". weights weights ... arguments passed fregre.pc fregre.pls","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"Return: fregre.pc: Fitted regression object best (pc.opt) components. pc.opt: Index PC components selected. MSC.min: Minimum Model Selection Criteria (MSC) value (pc.opt) components. MSC: Minimum Model Selection Criteria (MSC) value kmax components.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"algorithm selects best principal components pc.opt first kmax PC (optionally) best penalized parameter lambda.opt sequence non-negative numbers lambda.  kmax integer (default recomended) procedure follows (see example 1): Calculate best principal component (pc.order[1]) kmax fregre.pc. Calculate second-best principal component (pc.order [2]) (kmax-1) fregre.pc calculate criteria value two principal components. process (point 1 2) repeated kmax principal component (pc.order[kmax]). proces (point 1, 2 3) repeated lambda value. method selects principal components (pc.opt=pc.order[1:k.min]) (optionally) lambda parameter minimum MSC criteria. kmax sequence integer procedure follows (see example 2): method selects best principal components minimum MSC criteria stepwise regression using fregre.pc step. process (point 1) repeated lambda value. method selects principal components (pc.opt=pc.order[1:k.min]) (optionally) lambda parameter minimum MSC criteria. Finally, computing functional PC regression functional explanatory variable \\(X(t)\\) scalar response \\(Y\\) using best selection PC pc.opt ridge parameter rn.opt.   criteria selection done cross-validation (CV) Model Selection Criteria (MSC). Predictive Cross-Validation: \\(PCV(k_n)=\\frac{1}{n}\\sum_{=1}^{n}{\\Big(y_i -\\hat{y}_{(-,k_n)} \\Big)^2}\\),criteria=“CV” Model Selection Criteria: \\(MSC(k_n)=log \\left[ \\frac{1}{n}\\sum_{=1}^{n}{\\Big(y_i-\\hat{y}_i\\Big)^2} \\right] +p_n\\frac{k_n}{n} \\) \\(p_n=\\frac{log(n)}{n}\\), criteria=“SIC” (default) \\(p_n=\\frac{log(n)}{n-k_n-2}\\), criteria=“SICc” \\(p_n=2\\), criteria=“AIC” \\(p_n=\\frac{2n}{n-k_n-2}\\), criteria=“AICc” \\(p_n=\\frac{2log(log(n))}{n}\\), criteria=“HQIC”  criteria argument controls type validation used selection smoothing parameter kmax\\(=k_n\\) penalized parameter lambda\\(=\\lambda\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"criteria=``CV'' recommended: time-consuming.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional penalized PC regression with scalar response using selection of number of PC components — fregre.pc.cv","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x<-tecator$absorp.fdata[1:129] y<-tecator$y$Fat[1:129] # no penalization  res.pc1=fregre.pc.cv(x,y,8) # 2nd derivative penalization  res.pc2=fregre.pc.cv(x,y,8,lambda=TRUE,P=c(0,0,1)) # Ridge regression res.pc3=fregre.pc.cv(x,y,1:8,lambda=TRUE,P=1)  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"Computes functional (ridge penalized) regression functional explanatory variable \\(X(t)\\) scalar response \\(Y\\) using Principal Components Analysis. $$Y=\\big<X,\\beta\\big>+\\epsilon=\\int_{T}{X(t)\\beta(t)dt+\\epsilon}$$ \\( \\big< \\cdot , \\cdot \\big>\\) denotes inner product \\(L_2\\) \\(\\epsilon\\) random errors mean zero , finite variance \\(\\sigma^2\\) \\(E[X(t)\\epsilon]=0\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"","code":"fregre.pc(   fdataobj,   y,   l = NULL,   lambda = 0,   P = c(0, 0, 1),   weights = rep(1, len = n),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"fdataobj fdata class object fdata.comp class object created create.pc.basis function. y Scalar response length n. l Index components include model.null l (default), l=1:3. lambda Amount penalization. Default value 0, .e. penalization used. P P vector: P coefficients define penalty matrix object. P matrix: P penalty matrix object, see P.penalty. weights weights ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"Return: call: matched call fregre.pc function. coefficients: named vector coefficients. residuals: y minus fitted values. fitted.values: Estimated scalar response. beta.est: Beta coefficient estimated class fdata. df.residual: residual degrees freedom. ridge regression, df(rn) effective degrees freedom. r2: Coefficient determination. sr2: Residual variance. Vp: Estimated covariance matrix parameters. H: Hat matrix. l: Index principal components selected. lambda: Amount shrinkage. P: Penalty matrix. fdata.comp: Fitted object fdata2pc function. lm: lm object. fdataobj: Functional explanatory data. y: Scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"function computes \\(\\left\\{\\nu_k\\right\\}_{k=1}^{\\infty}\\) orthonormal basis functional principal components represent functional data \\(X_i(t)=\\sum_{k=1}^{\\infty}\\gamma_{ik}\\nu_k\\) functional parameter \\(\\beta(t)=\\sum_{k=1}^{\\infty}\\beta_k\\nu_k\\), \\(\\gamma_{ik}=\\Big< X_i(t),\\nu_k\\Big>\\) \\(\\beta_{k}=\\Big<\\beta,\\nu_k\\Big>\\).  response can fitted : \\(\\lambda=0\\), penalization, $$\\hat{y}=\\nu_k^{\\top}(\\nu_k^{\\top}\\nu_k)^{-1}\\nu_k^{\\top}y$$ Ridge regression, \\(\\lambda>0\\) \\(P=1\\),  $$\\hat{y}=\\nu_k^{\\top}(\\nu_k\\top \\nu_k+\\lambda )^{-1}\\nu_k^{\\top}y$$ Penalized regression, \\(\\lambda>0\\) \\(P\\neq0\\). example, \\(P=c(0,0,1)\\) penalizes second derivative (curvature) P=P.penalty(fdataobj[\"argvals\"],P), $$\\hat{y}=\\nu_k^{\\top}(\\nu_k\\top \\nu_k+\\lambda \\nu_k^{\\top} \\textbf{P}\\nu_k)^{-1}\\nu_k^{\\top}y$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"Cai TT, Hall P. 2006. Prediction functional linear regression. Annals Statistics 34: 2159-2179. Cardot H, Ferraty F, Sarda P. 1999. Functional linear model. Statistics Probability Letters 45: 11-22. Hall P, Hosseini-Nasab M. 2006. properties functional principal components analysis. Journal Royal Statistical Society B 68: 109-126. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/ N. Kraemer, .-L. Boulsteix, G. Tutz (2008). Penalized Partial Least Squares Applications B-Spline Transformations Functional Data. Chemometrics Intelligent Laboratory Systems, 94, 60 - 69. doi:10.1016/j.chemolab.2008.06.009","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Regression with scalar response using Principal Components Analysis — fregre.pc","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp <- tecator$absorp.fdata ind <- 1:129 x <- absorp[ind,] y <- tecator$y$Fat[ind] res <- fregre.pc(x,y) summary(res) res2 <- fregre.pc(x,y,l=c(1,3,4)) summary(res2) # Functional Ridge Regression res3 <- fregre.pc(x,y,l=c(1,3,4),lambda=1,P=1) summary(res3) # Functional Regression with 2nd derivative penalization res4 <- fregre.pc(x,y,l=c(1,3,4),lambda=1,P=c(0,0,1)) summary(res4) betas <- c(res$beta.est,res2$beta.est,            res3$beta.est,res4$beta.est) plot(betas) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":null,"dir":"Reference","previous_headings":"","what":"Semi-functional partially linear model with scalar response. — fregre.plm","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"Computes functional regression functional (non functional) explanatory variables scalar response using asymmetric kernel estimation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"","code":"fregre.plm(   formula,   data,   h = NULL,   Ker = AKer.norm,   metric = metric.lp,   type.CV = GCV.S,   type.S = S.NW,   par.CV = list(trim = 0, draw = FALSE),   par.S = list(w = 1),   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"formula object class formula (one can coerced class): symbolic description model fitted. details model specification given Details. data List containing variables model. h Bandwidth, h>0. Default argument values provided sequence length 51 2.5%–quantile 25%–quantile distance functional data, see h.default. Ker Type asymmetric kernel used, default asymmetric normal kernel. metric Metric function, default metric.lp. type.CV Type cross-validation. default generalized cross-validation GCV.S method. type.S Type smothing matrix S. default S calculated Nadaraya-Watson kernel estimator (S.NW). par.CV List parameters type.CV: trim, alpha trimming draw=TRUE. par.S List parameters type.S: w, weights. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"call: matched call. fitted.values: Estimated scalar response. residuals: y minus fitted values. df.residual: residual degrees freedom. H: Hat matrix. r2: Coefficient determination. sr2: Residual variance. y: Scalar response. fdataobj: Functional explanatory data. XX: Non functional explanatory data. mdist: Distance matrix curves. betah: beta coefficient estimated. data: List containing variables model. Ker: Asymmetric kernel used. h.opt: Value minimizes CV GCV method. h: Smoothing parameter bandwidth. data: List containing variables model. gcv: GCV values. formula: formula.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"extension non-parametric functional regression models semi-functional partial linear model proposed Aneiros-Perez Vieu (2005). model uses non-parametric kernel procedure described fregre.np. output \\(y\\) scalar. functional covariate \\(X\\) multivariate non functional covariate \\(Z\\) considered. $$y =r(X)+\\sum_{j=1}^{p}{Z_j\\beta_j}+\\epsilon$$ unknown smooth real function \\(r\\) estimated means $$\\hat{r}_{h}(X)=\\sum_{=1}^{n}{w_{n,h}(X,X_{})(Y_{}-Z_{}^{T}\\hat{\\beta}_{h})}$$ \\(W_h\\) weight function: \\(w_{n,h}(X,X_{})=\\frac{K(d(X,X_i)/h)}{\\sum_{j=1}^{n}K(d(X,X_j)/h)}\\) smoothing parameter \\(h\\), asymmetric kernel \\(K\\) metric semi-metric \\(d\\).  fregre.plm() default \\(W_h\\) functional version Nadaraya-Watson-type weights (type.S=S.NW) asymmetric normal kernel (Ker=AKer.norm) \\(L_2\\) (metric=metric.lp p=2). unknown parameters \\(\\beta_j\\) multivariate non functional covariates estimated means \\(\\hat{\\beta}_j=(\\tilde{Z}_{h}^{T}\\tilde{Z}_{h})^{-1}\\tilde{Z}_{h}^{T}\\tilde{Z}_{h}\\) \\(\\tilde{Z}_{h}=(-W_{h})Z\\) smoothing parameter \\(h\\). errors \\(\\epsilon\\) independent, zero mean, finite variance \\(\\sigma^2\\) \\(E[\\epsilon|Z_1,\\ldots,Z_p,X(t)]=0\\). first item data list called \"df\" data frame response non functional explanatory variables, link{lm}. non functional data formula lm regression performed. Functional variable (fdata fd class) introduced second item data list.  functional variable formula fregre.np.cv performed. function estimates value smoothing parameter bandwidth h Generalized Cross-validation GCV criteria. computes distance curves using metric.lp, although can also use metric function.  Different asymmetric kernels can used, see Kernel.asymmetric.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"Aneiros-Perez G. Vieu P. (2005). Semi-functional partial linear regression.  Statistics & Probability Letters, 76:1102-1110. Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.plm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Semi-functional partially linear model with scalar response. — fregre.plm","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x=tecator$absorp.fdata[1:129] dataf=tecator$y[1:129,]  f=Fat~Water+x ldata=list(\"df\"=dataf,\"x\"=x) res.plm=fregre.plm(f,ldata) summary(res.plm)  # with 2nd derivative of functional data x.fd=fdata.deriv(x,nderiv=2) f2=Fat~Water+x.fd ldata2=list(\"df\"=dataf,\"x.fd\"=x.fd) res.plm2=fregre.plm(f2,ldata2) summary(res.plm2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"Functional Regression scalar response using selection number penalized principal componentes PPLS cross-validation. algorithm selects PPLS components best estimates response. selection performed cross-validation (CV) Model Selection Criteria (MSC). computing functional regression using best selection PPLS components.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"","code":"fregre.pls.cv(   fdataobj,   y,   kmax = 8,   lambda = 0,   P = c(0, 0, 1),   criteria = \"SIC\",   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"fdataobj fdata class object. y Scalar response length n. kmax number components include model. lambda Vector amounts penalization. Default value 0, .e. penalization used.  lambda=TRUE algorithm computes sequence lambda values. P vector coefficients define penalty matrix object. example, P=c(0,0,1), penalized regression computed penalizing second derivative (curvature). criteria Type cross-validation (CV) Model Selection Criteria (MSC) applied. Possible values \"CV\", \"AIC\", \"AICc\", \"SIC\", \"SICc\", \"HQIC\". ... arguments passed fregre.pls.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"Return: fregre.pls: Fitted regression object best (pls.opt) components. pls.opt: Index PLS components selected. MSC.min: Minimum Model Selection Criteria (MSC) value (pls.opt) components. MSC: Minimum Model Selection Criteria (MSC) value kmax components.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"algorithm selects best principal components pls.opt first kmax PLS (optionally) best penalized parameter lambda.opt sequence non-negative numbers lambda. method selects best principal components minimum MSC criteria stepwise regression using fregre.pls step. process (point 1) repeated lambda value. method selects principal components (pls.opt=pls.order[1:k.min]) (optionally) lambda parameter minimum MSC criteria. Finally, computing functional PLS regression functional explanatory variable \\(X(t)\\) scalar response \\(Y\\) using best selection PLS pls.opt ridge parameter rn.opt. criteria selection done cross-validation (CV) Model Selection Criteria (MSC). Predictive Cross-Validation: \\(PCV(k_n)=\\frac{1}{n}\\sum_{=1}^{n}{\\Big(y_i -\\hat{y}_{(-,k_n)}\\Big)^2}\\), criteria=“CV” Model Selection Criteria: \\(MSC(k_n)=log \\left[ \\frac{1}{n}\\sum_{=1}^{n}{\\Big(y_i-\\hat{y}_i\\Big)^2} \\right] +p_n\\frac{k_n}{n} \\)   \\(p_n=\\frac{log(n)}{n}\\), criteria=“SIC” (default) \\(p_n=\\frac{log(n)}{n-k_n-2}\\), criteria=“SICc” \\(p_n=2\\), criteria=“AIC” \\(p_n=\\frac{2n}{n-k_n-2}\\), criteria=“AICc” \\(p_n=\\frac{2log(log(n))}{n}\\), criteria=“HQIC” criteria argument controls type validation used selection smoothing parameter kmax\\(=k_n\\) penalized parameter lambda\\(=\\lambda\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"criteria=``CV'' recommended: time-consuming.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"Preda C. Saporta G. PLS regression stochastic process. Comput. Statist. Data Anal. 48 (2005): 149-158. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional penalized PLS regression with scalar response using selection of number of PLS components — fregre.pls.cv","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x<-tecator$absorp.fdata[1:129] y<-tecator$y$Fat[1:129] # no penalization pls1<- fregre.pls.cv(x,y,8) # 2nd derivative penalization pls2<-fregre.pls.cv(x,y,8,lambda=0:5,P=c(0,0,1)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Penalized PLS regression with scalar response — fregre.pls","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"Computes functional linear regression functional explanatory variable \\(X(t)\\) scalar response \\(Y\\) using penalized Partial Least Squares (PLS) $$Y=\\big<\\tilde{X},\\beta\\big>+\\epsilon=\\int_{T}{\\tilde{X}(t)\\beta(t)dt+\\epsilon}$$ \\( \\big< \\cdot , \\cdot \\big>\\) denotes inner product \\(L_2\\) \\(\\epsilon\\) random errors mean zero , finite variance \\(\\sigma^2\\) \\(E[\\tilde{X}(t)\\epsilon]=0\\). \\(\\left\\{\\nu_k\\right\\}_{k=1}^{\\infty}\\) orthonormal basis PLS represent functional data \\(X_i(t)=\\sum_{k=1}^{\\infty}\\gamma_{ik}\\nu_k\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"","code":"fregre.pls(fdataobj, y = NULL, l = NULL, lambda = 0, P = c(0, 0, 1), ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"fdataobj fdata class object. y Scalar response length n. l Index components include model. lambda Amount penalization. Default value 0, .e. penalization used. P P vector: P coefficients define penalty matrix object. default P=c(0,0,1) penalize second derivative (curvature) acceleration.  P matrix: P penalty matrix object. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"Return: call: matched call fregre.pls function. beta.est: Beta coefficient estimated class fdata. coefficients: named vector coefficients. fitted.values: Estimated scalar response. residuals: y minus fitted values. H: Hat matrix. df.residual: residual degrees freedom. r2: Coefficient determination. GCV: GCV criterion. sr2: Residual variance. l: Index components include model. lambda: Amount shrinkage. fdata.comp: Fitted object fdata2pls function. lm: Fitted object lm function. fdataobj: Functional explanatory data. y: Scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"Functional (FPLS) algorithm maximizes covariance \\(X(t)\\) scalar response \\(Y\\) via partial least squares (PLS) components. functional penalized PLS calculated fdata2pls alternative formulation NIPALS algorithm proposed Kraemer Sugiyama (2011). Let \\(\\left\\{\\tilde{\\nu}_k\\right\\}_{k=1}^{\\infty}\\) functional PLS components \\(\\tilde{X}_i(t)=\\sum_{k=1}^{\\infty}\\tilde{\\gamma}_{ik}\\tilde{\\nu}_k\\) \\(\\beta(t)=\\sum_{k=1}^{\\infty}\\tilde{\\beta}_k\\tilde{\\nu}_k\\). functional linear model estimated : $$\\hat{y}=\\big< X,\\hat{\\beta} \\big> \\approx \\sum_{k=1}^{k_n}\\tilde{\\gamma}_{k}\\tilde{\\beta}_k $$ response can fitted : \\(\\lambda=0\\), penalization, $$\\hat{y}=\\nu_k^{\\top}(\\nu_k^{\\top}\\nu_k)^{-1}\\nu_k^{\\top}y$$ Penalized regression, \\(\\lambda>0\\) \\(P\\neq0\\). example, \\(P=c(0,0,1)\\) penalizes second derivative (curvature) P=P.penalty(fdataobj[\"argvals\"],P), $$\\hat{y}=\\nu_k^{\\top}(\\nu_k\\top \\nu_k+\\lambda \\nu_k^{\\top} \\textbf{P}\\nu_k)^{-1}\\nu_k^{\\top}y$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"Preda C. Saporta G. PLS regression stochastic process. Comput. Statist. Data Anal. 48 (2005): 149-158. N. Kraemer, .-L. Boulsteix, G. Tutz (2008). Penalized Partial Least Squares Applications B-Spline Transformations Functional Data. Chemometrics Intelligent Laboratory Systems, 94, 60 - 69. doi:10.1016/j.chemolab.2008.06.009 Martens, H., Naes, T. (1989) Multivariate calibration. Chichester: Wiley. Kraemer, N., Sugiyama M. (2011). Degrees Freedom Partial Least Squares Regression. Journal American Statistical Association. Volume 106, 697-705. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/fregre.pls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Penalized PLS regression with scalar response — fregre.pls","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x <- tecator$absorp.fdata y <- tecator$y$Fat res <- fregre.pls(x,y,c(1:4)) summary(res) res1 <- fregre.pls(x,y,l=1:4,lambda=100,P=c(1)) res4 <- fregre.pls(x,y,l=1:4,lambda=1,P=c(0,0,1)) summary(res4)#' plot(res$beta.est) lines(res1$beta.est,col=4) lines(res4$beta.est,col=2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":null,"dir":"Reference","previous_headings":"","what":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"generalized correlated cross-validation (GCV) score.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"","code":"GCCV.S(   y,   S,   criteria = \"GCCV1\",   W = NULL,   trim = 0,   draw = FALSE,   metric = metric.lp,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"y Response vectorith length n Matrix set cases dimension (n x m), n number curves m points observed curve. S Smoothing matrix, see S.NW, S.LLR \\(S.KNN\\). criteria penalizing function. default \"Rice\" criteria. Possible values \"GCCV1\", \"GCCV2\", \"GCCV3\", \"GCV\". W Matrix weights. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. metric Metric function, default metric.lp. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"Returns GCCV score calculated input parameters.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"$$GCCV = \\frac{\\sum_{=1}^n {(y_{} - \\hat{y}_{, b})}^2}{(1 - \\frac{tr(C)}{n})^2}$$ \\(C = 2S\\Sigma(\\theta) - S\\Sigma(\\theta)S'\\)  \\(\\Sigma\\) \\(n \\times n\\) covariance matrix \\(cor(\\epsilon_i, \\epsilon_j) = \\sigma\\). , \\(S\\) smoothing matrix, options \\(C\\): .- \\(C = 2S\\Sigma - S\\Sigma S\\) B.- \\(C = S\\Sigma\\) C.- \\(C = S\\Sigma S'\\) \\(\\Sigma\\) \\(n \\times n\\) covariance matrix \\(cor(\\epsilon_i, \\epsilon_j) = \\sigma\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"Provided \\(C = \\) smoother matrix S symmetric idempotent, case many linear fitting techniques, trace term reduces \\(n - tr[S]\\), proportional familiar denominator GCV.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"Carmack, P. S., Spence, J. S., Schucany, W. R. (2012). Generalised correlated cross-validation. Journal Nonparametric Statistics, 24(2):269–282. Oviedo de la Fuente, M., Febrero-Bande, M., Munoz, P., Dominguez, . Predicting seasonal influenza transmission using Functional Regression Models Temporal Dependence.https://arxiv.org/abs/1610.08718","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCCV.S.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The generalized correlated cross-validation (GCCV) score. — GCCV.S","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x=tecator$absorp.fdata x.d2<-fdata.deriv(x,nderiv=) tt<-x[[\"argvals\"]] dataf=as.data.frame(tecator$y) y=tecator$y$Fat # plot the response plot(ts(tecator$y$Fat))  nbasis.x=11;nbasis.b=7 basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x) basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b) basis.x=list(\"x.d2\"=basis1) basis.b=list(\"x.d2\"=basis2) ldata=list(\"df\"=dataf,\"x.d2\"=x.d2) # No correlation res.gls=fregre.gls(Fat~x.d2,data=ldata,                     basis.x=basis.x,basis.b=basis.b) # AR1 correlation                    res.gls=fregre.gls(Fat~x.d2,data=ldata, correlation=corAR1(),                    basis.x=basis.x,basis.b=basis.b) GCCV.S(y,res.gls$H,\"GCCV1\",W=res.gls$W) res.gls$gcv } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":null,"dir":"Reference","previous_headings":"","what":"The generalized correlated cross-validation (GCCV) score — GCV.S","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"Compute  generalized correlated cross-validation (GCV) score.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"","code":"GCV.S(   y,   S,   criteria = \"GCV\",   W = NULL,   trim = 0,   draw = FALSE,   metric = metric.lp,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"y Matrix set cases dimension (n x m), n number curves m points observed curve. S Smoothing matrix, see S.NW, S.LLR criteria penalizing function. default \"Rice\" criteria. Possible values \"GCCV1\", \"GCCV2\", \"GCCV3\", \"GCV\". W Matrix weights. trim alpha trimming. draw =TRUE, draw curves, sample median trimmed mean. metric Metric function, default metric.lp. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"Returns GCV score calculated input parameters.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":".-trim=0: $$GCCV=\\frac{\\sum_{=1}^n {y_{}-\\hat{y}_{,b}}^2}{1-\\frac{tr(C)}{n}^2}$$ \\(S\\) smoothing matrix \\(S\\) : .-\\(C=2S\\Sigma - S\\Sigma S\\)  B.- \\(C=S\\Sigma\\)  C.- \\(C=S\\Sigma S'\\)  \\(\\Sigma\\) n x n covariance matrix \\(cor(\\epsilon_i,\\epsilon_j ) =\\sigma\\) Note: Provided \\(C = \\) smoother matrix S symmetric idempotent, case many linear fitting techniques, trace term reduces  \\(n - tr[S]\\), proportional familiar denominator GCV.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Febrero-Bande,  M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/GCV.S.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The generalized correlated cross-validation (GCCV) score — GCV.S","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn<-phoneme$learn tt<-1:ncol(mlearn) S1 <- S.NW(tt,2.5) S2 <- S.LLR(tt,2.5) gcv1 <- GCV.S(mlearn, S1) gcv2 <- GCV.S(mlearn, S2) gcv3 <- GCV.S(mlearn, S1,criteria=\"AIC\") gcv4 <- GCV.S(mlearn, S2,criteria=\"AIC\") gcv1; gcv2; gcv3; gcv4 } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculation of the smoothing parameter (h) for a functional data — h.default","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"Calculation smoothing parameter (h) functional data using nonparametric kernel estimation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"","code":"h.default(   fdataobj,   prob = c(0.025, 0.25),   len = 51,   metric = metric.lp,   type.S = \"S.NW\",   Ker = Ker.norm,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"fdataobj fdata class object. prob Vector probabilities extracting quantiles distance matrix. length(prob)=2 sequence prob[1] prob[2] length len. len Vector length smoothing parameter h return used  length(prob)=2. metric function: name function calculate distance matrix curves, default metric.lp.  matrix: distance matrix curves. kernel. type.S Type smothing matrix S.  Possible values : Nadaraya-Watson estimator \"S.NW\" K nearest neighbors estimator \"S.KNN\" Ker Kernel function. default, Ker.norm. Useful scaling bandwidth values according Kernel ... Arguments passed metric argument.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"Returns vector smoothing parameter bandwidth h.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/h.default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculation of the smoothing parameter (h) for a functional data — h.default","text":"","code":"if (FALSE) { # \\dontrun{ data(aemet) h1<-h.default(aemet$temp,prob=c(0.025, 0.25),len=2) mdist<-metric.lp(aemet$temp) h2<-h.default(aemet$temp,len=2,metric=mdist) h3<-h.default(aemet$temp,len=2,metric=semimetric.pca,q=2) h4<-h.default(aemet$temp,len=2,metric=semimetric.pca,q=4) h5<-h.default(aemet$temp,prob=c(.2),type.S=\"S.KNN\") h1;h2;h3;h4;h5 } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional influence measures — influence.fregre.fd","title":"Functional influence measures — influence.fregre.fd","text":"estimated functional regression model scalar response, influence.fregre.fd function used obtain functional influence measures.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional influence measures — influence.fregre.fd","text":"","code":"# S3 method for class 'fregre.fd' influence(model, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional influence measures — influence.fregre.fd","text":"model fregre.pc, fregre.basis fregre.basis.cv object. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional influence measures — influence.fregre.fd","text":"Return: DCP: Cook's Distance Prediction. DCE: Cook's Distance Estimation. DP:\\(\\mbox{Pe}\\tilde{\\mbox{n}}\\mbox{'s} \\) Distance.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional influence measures — influence.fregre.fd","text":"Identify influential observations functional linear model predictor functional response scalar. Three statistics introduced measuring influence:   Distance Cook Prediction  DCP, Distance Cook Estimation DCE Distance   \\(\\mbox{pe}\\tilde{\\mbox{n}}\\mbox{} \\) DP respectively.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Functional influence measures — influence.fregre.fd","text":"influence.fdata deprecated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional influence measures — influence.fregre.fd","text":"Febrero-Bande, M., Galeano, P. Gonzalez-Manteiga, W. (2010). Measures influence functional linear model scalar response. Journal Multivariate Analysis 101, 327-339. Febrero-Bande,  M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functional influence measures — influence.fregre.fd","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence.fregre.fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional influence measures — influence.fregre.fd","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x=tecator$absorp.fdata[1:129] y=tecator$y$Fat[1:129]  res1=fregre.pc(x,y,1:5)   # time consuming res.infl1=influence(res1)   res2=fregre.basis(x,y)   res.infl2=influence(res2)    res<-res1 res.infl<-res.infl1 mat=cbind(y,res$fitted.values,res.infl$DCP,res.infl$DCE,res.infl$DP) colnames(mat)=c(\"Resp.\",\"Pred.\",\"DCP\",\"DCE\",\"DP\") pairs(mat) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile for influence measures — influence_quan","title":"Quantile for influence measures — influence_quan","text":"Estimate quantile measures influence observation.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile for influence measures — influence_quan","text":"","code":"influence_quan(model,out.influ,mue.boot=500, smo=0.1,smoX=0.05,alpha=0.95,kmax.fix=FALSE,...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile for influence measures — influence_quan","text":"model fregre.pc, fregre.basis fregre.basis.cv object. .influ inflluence.fd bject mue.boot Number bootstrap samples smo Smoothing parameter proportion response variance. smoX Smoothing parameter fdata object proportion variance-covariance matrix explanatory functional variable. alpha Significance level. kmax.fix maximum number principal comoponents number basis fixed model object. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile for influence measures — influence_quan","text":"Return: quan.cook.:  Distance Cook Prediction Quantile. quan.cook.est: Distance Cook Estimation Quantile. quan.cook.Pena: Pena Distance Quantile. mues.est: Sample Cook generated. mues.pena: Sample Pena generated. beta.boot: Functional beta estimated bootstrap method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile for influence measures — influence_quan","text":"Compute quantile measures influence estimated influence.fregre.fd functional regression using principal components representation (fregre.pc) basis representation (fregre.basis fregre.basis.cv). smoothed bootstrap method used estimate quantiles influence measures, allows point observations larger influence estimation prediction.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Quantile for influence measures — influence_quan","text":"Febrero-Bande, M., Galeano, P. Gonzalez-Manteiga, W. (2010). Measures influence functional linear model scalar response. Journal Multivariate Analysis 101, 327-339.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Quantile for influence measures — influence_quan","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/influence_quan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile for influence measures — influence_quan","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) x=tecator$absorp.fdata y=tecator$y$Fat res=fregre.pc(x,y,1:6)  #time consuming res.infl=influence.fregre.fd(res) resquan=influence_quan(res,res.infl,4,0.01,0.05,0.95) plot(res.infl$betas,type=\"l\",col=2) lines(res$beta.est,type=\"l\",col=3) lines(resquan$betas.boot,type=\"l\",col=\"gray\")  res=fregre.basis(x,y) res.infl=influence.fregre.fd(res) resquan=influence_quan(res,res.infl,mue.boot=4,kmax.fix=T) plot(resquan$betas.boot,type=\"l\",col=4) lines(res.infl$betas,type=\"l\",col=2) lines(resquan$betas.boot,type=\"l\",col=\"gray\") } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"Computes inner products functional data objects class fdata.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"","code":"inprod.fdata(fdata1, fdata2 = NULL, w = 1, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"fdata1 Functional data 1 curve 1. fdata1$data dimension (n1 x m), n1 number curves m points observed curve. fdata2 Functional data 2 curve 2. fdata2$data dimension (n2 x m), n2 number curves m points observed curve. w Vector weights length m, w = 1 approximates metric Lp Simpson's rule. default uses w = 1 ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"default uses weights w=1.  $$ \\left\\langle fdata1,fdata2 \\right\\rangle=\\frac{1}{\\int_{}^{b}w(x)dx} \\int_{}^{b} fdata1(x) * fdata2(x)w(x) dx $$ observed points curve equally spaced (default) .","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/inprod.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inner products of Functional Data Objects o class (fdata) — inprod.fdata","text":"","code":"if (FALSE) { # \\dontrun{ x<-seq(0,2*pi,length=1001) fx1<-sin(x)/sqrt(pi) fx2<-cos(x)/sqrt(pi) argv<-seq(0,2*pi,len=1001) fdat0<-fdata(rep(0,len=1001),argv,range(argv)) fdat1<-fdata(fx1,x,range(x)) inprod.fdata(fdat1,fdat1) inprod.fdata(fdat1,fdat1) metric.lp(fdat1) metric.lp(fdat1,fdat0) norm.fdata(fdat1) # The same integrate(function(x){(abs(sin(x)/sqrt(pi))^2)},0,2*pi) integrate(function(x){(abs(cos(x)/sqrt(pi))^2)},0,2*pi) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":null,"dir":"Reference","previous_headings":"","what":"Simpson integration — int.simpson","title":"Simpson integration — int.simpson","text":"Computes integral fdataobj$data respect fdataobj$argvals using simpson trapezoid rule integration.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simpson integration — int.simpson","text":"","code":"int.simpson(fdataobj, method = NULL)  int.simpson2(x, y, equi = TRUE, method = NULL)"},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simpson integration — int.simpson","text":"fdataobj fdata objtect. method Method numerical integration, see details. x Sorted vector x-axis values: argvals. y Vector y-axis values. equi =TRUE, observed points curve equally spaced (default).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simpson integration — int.simpson","text":"Posible values method : \"TRAPZ\": Trapezoid rule integration. \"CSR\": Composite Simpson's rule integration. \"ESR\": Extended Simpson's rule integration. method=NULL (default), value par.fda.usc$int.method used.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simpson integration — int.simpson","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/int.simpson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simpson integration — int.simpson","text":"","code":"if (FALSE) { # \\dontrun{ x<-seq(0,2*pi,length=1001) fx<-fdata(sin(x)/sqrt(pi),x) fx0<-fdata(rep(0,length(x)),x) int.simpson(fx0) int.simpson(fx) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":null,"dir":"Reference","previous_headings":"","what":"Asymmetric Smoothing Kernel — Kernel.asymmetric","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"Represent Asymmetric Smoothing Kernels: normal, cosine, triweight, quartic uniform.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"","code":"Kernel.asymmetric(u, type.Ker = \"AKer.norm\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"u Data. type.Ker Type asymmetric metric kernel, default asymmetric normal kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"Returns asymmetric kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"Type Asymmetric kernel:","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.asymmetric.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Asymmetric Smoothing Kernel — Kernel.asymmetric","text":"","code":"y=qnorm(seq(.1,.9,len=100)) a<-Kernel.asymmetric(u=y) b<-Kernel.asymmetric(type.Ker=\"AKer.tri\",u=y) c=AKer.cos(y)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":null,"dir":"Reference","previous_headings":"","what":"Symmetric Smoothing Kernels. — Kernel","title":"Symmetric Smoothing Kernels. — Kernel","text":"Represent symmetric smoothing kernels:: normal, cosine, triweight, quartic uniform.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Symmetric Smoothing Kernels. — Kernel","text":"","code":"Kernel(u, type.Ker = \"Ker.norm\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Symmetric Smoothing Kernels. — Kernel","text":"u Data. type.Ker Type Kernel. default normal kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Symmetric Smoothing Kernels. — Kernel","text":"Returns symmetric kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Symmetric Smoothing Kernels. — Kernel","text":"Type kernel:","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Symmetric Smoothing Kernels. — Kernel","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Symmetric Smoothing Kernels. — Kernel","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Symmetric Smoothing Kernels. — Kernel","text":"","code":"y=qnorm(seq(.1,.9,len=100)) a<-Kernel(u=y) b<-Kernel(type.Ker=\"Ker.tri\",u=y) c=Ker.cos(y)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrate Smoothing Kernels. — Kernel.integrate","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"Represent integrate kernels: normal, cosine, triweight, quartic uniform.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"","code":"Kernel.integrate(u, Ker = Ker.norm, a = -1)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"u data Ker Type Kernel. default normal kernel. Lower limit integration.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"Returns integrate kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"Type integrate kernel:","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Kernel.integrate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Integrate Smoothing Kernels. — Kernel.integrate","text":"","code":"y=qnorm(seq(.1,.9,len=100)) d=IKer.tri(y) e=IKer.cos(y) e2=Kernel.integrate(u=y,Ker=Ker.cos) e-e2 #>   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 f=IKer.epa(y) f2=Kernel.integrate(u=y,Ker=Ker.epa) f-f2 #>   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 plot(d,type=\"l\",ylab=\"Integrate Kernel\") lines(e,col=2,type=\"l\") lines(f,col=4,type=\"l\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":null,"dir":"Reference","previous_headings":"","what":"K-Means Clustering for functional data — kmeans.center.ini","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"Perform k-means clustering functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"","code":"kmeans.center.ini(   fdataobj,   ncl = 2,   metric = metric.lp,   draw = TRUE,   method = \"sample\",   max.iter = 100,   max.comb = 1e+06,   par.metric = NULL,   ... )  kmeans.fd(   fdataobj,   ncl = 2,   metric = metric.lp,   dfunc = func.trim.FM,   max.iter = 100,   par.metric = NULL,   par.dfunc = list(trim = 0.05),   method = \"sample\",   cluster.size = 5,   draw = TRUE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"fdataobj fdata class object. ncl See details section. metric Metric function, default metric.lp. draw =TRUE, draw curves color centers. method Method selecting initial centers. method=\"Sample\" (default) takes n times random selection ncl centers. ncl curves greater distance initial centers. method=\"Exact\" calculated combinations (< 1e+6) ncl centers. ncl curves greater distance initial centers (method may slow). max.iter Maximum number iterations detection centers. max.comb Maximum number initial selection centers (used method=\"exact\"). par.metric List arguments pass metric function. ... arguments passed methods. dfunc Type depth measure, default FM depth. par.dfunc List arguments pass dfunc function . cluster.size Minimum cluster size (default 5). cluster fewer curves, eliminated process continued less cluster.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"Return: cluster: Indexes groups assigned. centers: Curves centers.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"method searches locations around grouped data (predetermined number groups). ncl=NULL, randomizes initial centers, ncl=2 using kmeans.center.ini function. ncl integer, indicating number groups classify, selected ncl initial centers using kmeans.center.ini function. ncl vector integers, indicating position initial centers length(ncl) equal number groups. ncl fdata class objecct, ncl initial centers curves nrow(ncl) number groups.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"Hartigan, J. . Wong, M. . (1979). K-means clustering algorithm. Applied Statistics 28, 100 \\-108.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/kmeans.fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"K-Means Clustering for functional data — kmeans.center.ini","text":"","code":"if (FALSE) { # \\dontrun{ library(fda.usc) data(phoneme) mlearn <- phoneme$learn[c(1:50,101:150,201:250),] # Unsupervised classification out.fd1 <- kmeans.fd(mlearn,ncl=3,draw=TRUE) out.fd2 <- kmeans.fd(mlearn,ncl=3,draw=TRUE,method=\"exact\") # Different Depth function ind <- c(17,77,126) out.fd3 <- kmeans.fd(mlearn,ncl=mlearn[ind,],draw=FALSE, dfunc <- func.trim.FM,par.dfunc=list(trim=0.1)) out.fd4 <- kmeans.fd(mlearn, ncl=mlearn[ind,], draw=FALSE,  dfunc = func.med.FM) group <- c(rep(1,50), rep(2,50),rep(3,50)) table(out.fd4$cluster, group) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/ldata.html","id":null,"dir":"Reference","previous_headings":"","what":"ldata class definition and utilities — ldata","title":"ldata class definition and utilities — ldata","text":"ldata list two type objects: df data frame multivariate data n rows. ...  fdata objects class fdata n rows.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/ldata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ldata class definition and utilities — ldata","text":"","code":"ldata(df, ..., mfdata)  # S3 method for class 'ldata' names(x)  is.ldata(x)  # S3 method for class 'ldata' x[i, row = FALSE]  # S3 method for class 'ldata' subset(x, subset, ...)  # S3 method for class 'ldata' plot(x, ask = FALSE, color, var.name, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/ldata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ldata class definition and utilities — ldata","text":"df data frame ... arguments passed methods. mfdata list fdata objects index row logical FALSE  (default), index selects variables. TRUE,  index selects observations. subset subset ask logilcal    TRUE (R session interactive) user asked input, new figure drawn. color colors interpolate; must valid argument  colorRampPalette. var.name name continuous univariate variable used color argument ldata, x object class ldata","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/ldata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ldata class definition and utilities — ldata","text":"","code":"data(tecator) ab0 <- tecator$absorp.fdata ab1 <- fdata.deriv(ab0) ab2 <- fdata.deriv(ab0,nderiv=2) ldat<-ldata(tecator$y,ab1=ab1,ab2=ab2) is.ldata(ldat) #> [1] TRUE class(ldat) #> [1] \"ldata\" \"list\"  plot(ldat[[1]])  plot(ldat[[2]])   # plot(ldat) # plot(ldat,var.name=\"Fat\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":null,"dir":"Reference","previous_headings":"","what":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"LMDC.select function selects impact points functional predictior using local maxima distance correlation (LMDC) scalar response given. LMDC.regre function fits multivariate regression method using selected impact points like covariates scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"","code":"LMDC.select(   y,   covar,   data,   tol = 0.06,   pvalue = 0.05,   plot = FALSE,   local.dc = TRUE,   smo = FALSE,   verbose = FALSE )  LMDC.regre(   y,   covar,   data,   newdata,   pvalue = 0.05,   method = \"lm\",   par.method = NULL,   plot = FALSE,   verbose = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"y name response variable. covar vector names covaviables (points impact) length p. data data frame length n rows least p + 1 columns, containing scalar response potencial p covaviables (points impact) model. tol Tolerance value distance correlation imapct point. pvalue pvalue bias corrected distance correlation t-test. plot logical value, TRUE plots distance correlation curve covariate multivariate case discretization points (argvals) functional case. local.dc Compute local distance correlation. smo logical. TRUE, curve distance correlation computed impact points smoothed using B-spline representation suitable number basis elements. verbose print iterative relevant steps procedure. newdata optional data frame look variables predict. method Name regression method used, see details. argument used .call function like \"\" argument. par.method List parameters used call method. argument used .call function like \"args\" argument.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"LMDC.select function returns list two elements: cor value distance correlation covariate. maxLocal index locations local maxima distance correlations. LMDC.regre function returns list folowing elements: model object corresponding estimated method using selected variables. xvar names selected variables (impact points). edf effective degrees freedom. nvar number selected variables (impact points).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"String characters corresponding name regression method called. Model available options: \"lm\": Step-wise lm regression model (uses lm function, stats package). Recommended linear models, test linearity using. flm.test function. \"gam\": Step-wise gam regression model (uses gam function, mgcv package).  Recommended non-linear models. Models use indicated function required package: \"svm\": Support vector machine (svm function, e1071 package). \"knn\": k-nearest neighbor regression (knnn.reg function, FNN package). \"lars\": Least Angle Regression using Lasso (lars function, lars package). \"glmnet\": Lasso Elastic-Net Regularized Generalized Linear Models (glmnet cv.glmnet function, glmnet package). \"rpart\": Recursive partitioning regression (rpart function, rpart package). \"flam\": Fit Fused Lasso Additive Model Sequence Tuning Parameters (flam function, flam package). \"novas\": NOnparametric VAriable Selection (code available https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NOVAS/novas-routines.R). \"cosso\": Fit Regularized Nonparametric Regression Models Using COSSO Penalty (cosso function, cosso package). \"npreg\": kernel regression estimate one (1) dimensional dependent  variable p-variate explanatory data (npreg function, np package). \"mars\": Multivariate adaptive regression splines (mars function, mda package). \"nnet\":  Fit Neural Networks (nnet function, nnet package). \"lars\": Fits Least Angle Regression, Lasso Infinitesimal Forward Stagewise regression models (lars function, lars package).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"Ordonez, C., Oviedo de la Fuente, M., Roca-Pardinas, J., Rodriguez-Perez, J. R. (2018). Determining optimum wavelengths leaf water content estimation reflectance: distance correlation approach. Chemometrics Intelligent Laboratory Systems. 173,41-50 doi:10.1016/j.chemolab.2017.12.001 .","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/LMDC.select.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impact points selection of functional predictor and regression using local maxima distance correlation (LMDC) — LMDC.select","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp=fdata.deriv(tecator$absorp.fdata,2) ind=1:129 x=absorp[ind,] y=tecator$y$Fat[ind] newx=absorp[-ind,] newy=tecator$y$Fat[-ind]  ## Functional PC regression res.pc=fregre.pc(x,y,1:6) pred.pc=predict(res.pc,newx)  # Functional regression with basis representation res.basis=fregre.basis.cv(x,y) pred.basis=predict(res.basis[[1]],newx)  # Functional nonparametric regression res.np=fregre.np.cv(x,y) pred.np=predict(res.np,newx)  dat    <- data.frame(\"y\"=y,x$data) newdat <- data.frame(\"y\"=newy,newx$data)  res.gam=fregre.gsam(y~s(x),data=list(\"df\"=dat,\"x\"=x)) pred.gam=predict(res.gam,list(\"x\"=newx))  dc.raw <- LMDC.select(\"y\",data=dat, tol = 0.05, pvalue= 0.05,                       plot=F, smo=T,verbose=F) covar <- paste(\"X\",dc.raw$maxLocal,sep=\"\")                       # Preselected design/impact points  covar ftest<-flm.test(dat[,-1],dat[,\"y\"], B=500, verbose=F,     plot.it=F,type.basis=\"pc\",est.method=\"pc\",p=4,G=50)      if (ftest$p.value>0.05) {    # Linear relationship, step-wise lm is recommended   out <- LMDC.regre(\"y\",covar,dat,newdat,pvalue=.05,               method =\"lm\",plot=F,verbose=F) } else {  # Non-Linear relationship, step-wise gam is recommended   out <- LMDC.regre(\"y\",covar,dat,newdat,pvalue=.05,               method =\"gam\",plot=F,verbose=F) }                 # Final  design/impact points out$xvar  # Predictions mean((newy-pred.pc)^2)                 mean((newy-pred.basis)^2)  mean((newy-pred.np)^2)               mean((newy-pred.gam)^2)  mean((newy-out$pred)^2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/MCO.html","id":null,"dir":"Reference","previous_headings":"","what":"Mithochondiral calcium overload (MCO) data set — MCO","title":"Mithochondiral calcium overload (MCO) data set — MCO","text":"mithochondiral calcium overload (MCO) measured two groups (control treatment) every 10 seconds hour isolated mouse cardiac cells. fact, due technical reasons, original experiment [see Ruiz-Meana et al. (2000)] performed twice, using \"intact\", original cells \"permeabilized\" cells (condition related mitochondrial membrane).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/MCO.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mithochondiral calcium overload (MCO) data set — MCO","text":"Elements MCO:..$intact: fdata class object “intact cells”curves, \"data\": Matrix class fdata 89 intact cells curves (rows) measured every 10 seconds hour isolated mouse cardiac cell. \"argvals\", 360 discretization points seond 0 3590. \"rangeval\": range(\"argvals\"). \"names\" list : main overall title \"Control Intact Treatment\", xlab title x axis \"seconds\" ylab title y axis \"Ca\". ..$classintact: Factor levels “intact cells” curves: \"1\" control group \"2\" treatment group. ..$permea: fdata class object “permeabilized cells” curves (whose membrane removed), \"data\": Matrix class fdata 90 permeabilizzed cells curves (rows) measured every 10 seconds hour isolated mouse cardiac cell. \"argvals\", 360 discretization points seond 0 3590. \"rangeval\": range(\"argvals\"). \"names\" list : main overall title \"Control Intact Treatment\", xlab title x axis \"seconds\" ylab title y axis \"Ca\". ..$classpermea: Factor levels “permeabilized cells” curves: \"1\" control group \"2\" treatment group.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/MCO.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Mithochondiral calcium overload (MCO) data set — MCO","text":"structure curves initial period (first 180 seconds) experiment shows erratic behavior (relevant experiment context) period.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/MCO.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mithochondiral calcium overload (MCO) data set — MCO","text":"Ruiz–Meana M, Garcia-Dorado D, Pina P, Inserte J, Agullo L, Soler–Soler J. Cariporide preserves mitochondrial proton gradient delays ATP depletion cardiomyocytes ischemic conditions. American Journal Physiology Heart Circulatori Physiology. 2003 Sep;285(3):H999–1006.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/MCO.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mithochondiral calcium overload (MCO) data set — MCO","text":"","code":"data(MCO) names(MCO) #> [1] \"intact\"      \"permea\"      \"classintact\" \"classpermea\" par(mfrow=c(1,2)) plot.fdata(MCO$intact, col=MCO$classintact) plot.fdata(MCO$permea, col=MCO$classintact)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance Matrix Computation — metric.dist","title":"Distance Matrix Computation — metric.dist","text":"function computes distances rows data matrix using specified distance measure. function returns distance matrix using dist function.  matrix dimension (n1 x n1) y=NULL, (n1 x n2) otherwise.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance Matrix Computation — metric.dist","text":"","code":"metric.dist(x, y = NULL, method = \"euclidean\", p = 2, dscale = 1, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance Matrix Computation — metric.dist","text":"x Data frame 1. dimension (n1 x m). y Data frame 2. dimension (n2 x m). method distance measure used. must one \"euclidean\", \"maximum\", \"manhattan\", \"canberra\", \"binary\" \"minkowski\". p power Minkowski distance. dscale scale numeric, distance matrix divided scale value. scale function (mean example) distance matrix divided corresponding value output function. ... arguments passed dist function.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.dist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Distance Matrix Computation — metric.dist","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance Matrix Computation — metric.dist","text":"","code":"if (FALSE) { # \\dontrun{ data(iris) d<-metric.dist(iris[,1:4]) matplot(d,type=\"l\",col=as.numeric(iris[,5])) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":null,"dir":"Reference","previous_headings":"","what":"DTW: Dynamic time warping — metric.DTW","title":"DTW: Dynamic time warping — metric.DTW","text":"Computes distances time warping functional data","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DTW: Dynamic time warping — metric.DTW","text":"","code":"metric.DTW(fdata1, fdata2 = NULL, p = 2, w = min(ncol(fdata1), ncol(fdata2)))  metric.WDTW(   fdata1,   fdata2 = NULL,   p = 2,   w = min(ncol(fdata1), ncol(fdata2)),   wmax = 1,   g = 0.05 )  metric.TWED(fdata1, fdata2 = NULL, p = 2, lambda = 1, nu = 0.05)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DTW: Dynamic time warping — metric.DTW","text":"fdata1 Functional data 1 curve 1. fdata class, dimension fdata1$data object (n1 x m), n1 number curves m points observed curve. fdata2 Functional data 2 curve 2. fdata class, dimension fdata2$data object (n2 x m), n2 number curves m points observed curve. p Lp norm, default uses p = 2 w Vector weights length m, w = 1 approximates metric Lp Simpson's rule. default uses w = 1 wmax numeric maximum value weight, (1 default) g numeric g=0 (constant), 0.05 (linear) default, 0.25 sigmoid, 3 two weight values lambda numeric lambda value (0 default) nu numeric constant value, (0 default)","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DTW: Dynamic time warping — metric.DTW","text":"DTW matrix","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"DTW: Dynamic time warping — metric.DTW","text":"Three optins: DTW: Dynamic time warping WDTW: Weight Dynamic time warping TWED: twed","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DTW: Dynamic time warping — metric.DTW","text":"Jeong, Y. S., Jeong, M. K., & Omitaomu, O. . (2011). Weighted dynamic time warping time series classification. Pattern Recognition, 44(9), 2231-2240","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DTW: Dynamic time warping — metric.DTW","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.DTW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DTW: Dynamic time warping — metric.DTW","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) metric.DTW(tecator$absorp.fdata[1:4,]) ab=tecator[[1]] D1=fda.usc:::DTW(ab$data[1,],ab$data[2,],p=2) aa1=fda.usc:::findPath(D1$D) D2=fda.usc:::DTW(ab$data[1,],ab$data[2,],p=2,w=5) aa2=fda.usc:::findPath(D2$D) D3=fda.usc:::WDTW(ab$data[1,],ab$data[2,],p=2,g=0.05)  aa3=fda.usc:::findPath(D3$D) D4=fda.usc:::TWED(ab$data[1,],ab$data[2,],p=2,lambda=0,nu=0) aa4=fda.usc:::findPath(D4$D) par(mfrow=c(2,2)) plot(c(ab[1:2])) segments(ab$argvals[aa1[,1]],ab[1]$data[aa1[,1]],ab$argvals[aa1[,2]],ab[2]$data[aa1[,2]]) plot(c(ab[1:2])) segments(ab$argvals[aa2[,1]],ab[1]$data[aa2[,1]],ab$argvals[aa2[,2]],ab[2]$data[aa2[,2]],col=2) plot(c(ab[1:2])) segments(ab$argvals[aa3[,1]],ab[1]$data[aa3[,1]],ab$argvals[aa3[,2]],ab[2]$data[aa3[,2]],col=3) plot(c(ab[1:2])) segments(ab$argvals[aa4[,1]],ab[1]$data[aa4[,1]],ab$argvals[aa4[,2]],ab[2]$data[aa4[,2]],col=4) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the Hausdorff distances between two curves. — metric.hausdorff","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"Hausdorff distance greatest distances point one curve closest point curve (closest euclidean distance).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"","code":"metric.hausdorff(fdata1, fdata2 = fdata1)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"fdata1 Curves 1 fdata class. dimension fdata1 object (n1 x m), n1 number points observed t coordinates lenght m. fdata2 Curves 2 fdata class. dimension fdata2 object (n2 x m), n2 number points observed t coordinates lenght m.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"Let \\(G(X)=\\left\\{ (t,X(t))\\R^2 \\right\\}\\) \\(G(Y)=\\left\\{(t,Y(t))\\R^2\\right\\}\\) two graphs considered curves \\(X\\) \\(Y\\) respectively, Hausdorff distance \\(d_H(X, Y)\\) defined , $$ d_H(X,Y)=max\\left\\{ sup_{x\\G(X)} inf_{y\\G(Y)} d_2(x,y), sup_{y\\G(Y)} inf_{x\\G(X)}d_2(x,y)\\right\\},$$ \\(d_2(x,y)\\) euclidean distance, see metric.lp.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.hausdorff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the Hausdorff distances between two curves. — metric.hausdorff","text":"","code":"if (FALSE) { # \\dontrun{    data(poblenou) nox<-poblenou$nox[1:6] # Hausdorff vs maximum distance out1<-metric.hausdorff(nox)        out2<-metric.lp(nox,lp=0)  out1 out2 par(mfrow=c(1,3)) plot(nox) plot(hclust(as.dist(out1))) plot(hclust(as.dist(out2))) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":null,"dir":"Reference","previous_headings":"","what":"Kullback–Leibler distance — metric.kl","title":"Kullback–Leibler distance — metric.kl","text":"Measures proximity two groups densities (class fdata) computing Kullback–Leibler distance.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kullback–Leibler distance — metric.kl","text":"","code":"metric.kl(fdata1, fdata2 = NULL, symm = TRUE, base = exp(1), eps = 1e-10, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kullback–Leibler distance — metric.kl","text":"fdata1 Functional data 1 (fdata class) densities. dimension fdata1 object (n1 x m), n1 number densities m number coordinates points density observed. fdata2 Functional data 2 (fdata class) densities. dimension fdata2 object (n2 x m). symm TRUE symmetric K–L distance computed, see details section. base logarithm base used compute distance. eps Tolerance value. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Kullback–Leibler distance — metric.kl","text":"Kullback–Leibler distance \\(f(t)\\) \\(g(t)\\) $$metric.kl(f(t),g(t))= \\int_{}^{b} {f(t) log\\left(\\frac{f(t)}{g(t)}\\right)dt}$$ \\(t\\) m coordinates points density observed (argvals fdata object). Kullback–Leibler distance asymmetric, $$metric.kl(f(t),g(t))\\neq metric.kl(g(t),f(t))$$  symmetry version K–L distance (default) can obtained $$0.5\\left(metric.kl(f(t),g(t))+metric.kl(g(t),f(t))\\right)$$ \\(\\left(f_i(t)=0\\ \\& \\ g_j(t)=0\\right) \\Longrightarrow metric.kl(f(t),g(t))=0\\). \\(\\left|f_i(t)-g_i(t) \\right|\\leq \\epsilon \\Longrightarrow f_i(t)=f_i(t)+\\epsilon\\), \\(\\epsilon\\) tolerance value (default eps=1e-10). coordinates points density observed (discretization points \\(t\\)) can equally spaced (default) .","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Kullback–Leibler distance — metric.kl","text":"Kullback, S., Leibler, R.. (1951). information sufficiency. Annals Mathematical Statistics, 22: 79-86","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Kullback–Leibler distance — metric.kl","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.kl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Kullback–Leibler distance — metric.kl","text":"","code":"if (FALSE) { # \\dontrun{    n<-201                                                                                        tt01<-seq(0,1,len=n)                                                                          rtt01<-c(0,1)   x1<-dbeta(tt01,20,5)                                                                            x2<-dbeta(tt01,21,5)                                                                            y1<-dbeta(tt01,5,20)                                                                            y2<-dbeta(tt01,5,21)                                                                            xy<-fdata(rbind(x1,x2,y1,y2),tt01,rtt01) plot(xy) round(metric.kl(xy,xy,eps=1e-5),6)   round(metric.kl(xy,eps=1e-5),6) round(metric.kl(xy,eps=1e-6),6) round(metric.kl(xy,xy,symm=FALSE,eps=1e-5),6)   round(metric.kl(xy,symm=FALSE,eps=1e-5),6)  plot(c(fdata(y1[1:101]),fdata(y2[1:101])))                        metric.kl(fdata(x1))   metric.kl(fdata(x1),fdata(x2),eps=1e-5,symm=F)        metric.kl(fdata(x1),fdata(x2),eps=1e-6,symm=F)        metric.kl(fdata(y1[1:101]),fdata(y2[1:101]),eps=1e-13,symm=F)   metric.kl(fdata(y1[1:101]),fdata(y2[1:101]),eps=1e-14,symm=F)   } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"function computes distances list elements","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"","code":"metric.ldata(   ldata1,   ldata2 = NULL,   include = \"all\",   exclude = \"none\",   metric,   par.metric = NULL,   w,   method = \"none\" )"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"ldata1 List  fdata objects data.frame object calle 'df'. ldata2 List  fdata objects data.frame object calle 'df'. include vector name variables use exclude vector name variables use metric Type metric combine, 'none', function combine return list o distances variable included par.metric List metric parameters variable included w, weights combine metric (metric 'none') method distance measure used. must one \"euclidean\", \"maximum\", \"manhattan\", \"canberra\", \"binary\" \"minkowski\".","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"function returns distance matrix using metric.lp function fdata objects metric.dist function vector matric objects.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manul.oviedo@usc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.ldata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance Matrix Computation for ldata and mfdata class object — metric.ldata","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) names(tecator)[2] <- \"df\" # Example 1 (list of distances) ldist <- metric.ldata(tecator,method=\"none\") lapply(ldist,names) # Example 2 (combined metric) mdist <- metric.ldata(tecator,method=\"euclidean\") dim(mdist)  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":null,"dir":"Reference","previous_headings":"","what":"Approximates Lp-metric distances for functional data. — metric.lp","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"Measures proximity functional data curves approximating Lp-metric. w = 1 approximates Lp-metric Simpson's rule. default uses lp = 2 weights w = 1.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"","code":"metric.lp(fdata1, fdata2 = NULL, lp = 2, w = 1, dscale = 1, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"fdata1 Functional data 1 curve 1. fdata class, dimension fdata1$data object (n1 x m), n1 number curves m points observed curve. fdata2 Functional data 2 curve 2. fdata class, dimension fdata2$data object (n2 x m), n2 number curves m points observed curve. lp Lp norm, default uses lp = 2 w Vector weights length m, w = 1 approximates metric Lp Simpson's rule. default uses w = 1 dscale scale numeric, distance matrix divided scale value. scale function (mean example) distance matrix divided corresponding value output function. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"default uses L2-norm lp = 2.  $$Let \\ \\ f(x)= fdata1(x)-fdata2(x)$$ $$\\left\\|f\\right\\|_p=\\left ( \\frac{1}{\\int_{}^{b}w(x)dx} \\int_{}^{b} \\left|f(x)\\right|^{p}w(x)dx \\right)^{1/p}$$  observed points curve equally spaced (default) . L\\(\\infty\\)-norm computed lp = 0. $$d(fdata1(x),fdata2(x))_{\\infty}=sup \\left|fdata1(x)-fdata2(x)\\right|$$","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/metric.lp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Approximates Lp-metric distances for functional data. — metric.lp","text":"","code":"if (FALSE) { # \\dontrun{ #  INFERENCE PHONDAT data(phoneme) mlearn<-phoneme$learn[1:100] mtest<-phoneme$test[1:100] glearn<-phoneme$classlearn[1:100] gtest<-phoneme$classtest[1:100] # Matrix of distances of curves of DATA1 mdist1<-metric.lp(mlearn)  # Matrix of distances between curves of DATA1 and curves of DATA2 mdist2<-metric.lp(mlearn,mtest,lp=2) # mdist with L1 norm and weigth=v v=dnorm(seq(-3,3,len=dim(mlearn)[2])) mdist3<-metric.lp(mlearn,mtest,lp=1,w=v) plot(1:100,mdist2[1,],type=\"l\",ylim=c(1,max(mdist3[1,]))) lines(mdist3[1,],type=\"l\",col=\"2\")  # mdist with mlearn with different discretization points. # mlearn2=mlearn # mlearn2[[\"argvals\"]]=seq(0,1,len=150) # mdist5<-metric.lp(mlearn,mlearn2) # mdist6<-metric.lp(mlearn2,mlearn)  # sum(mdist5-mdist6) # sum(mdist1-mdist6)  x<-seq(0,2*pi,length=1001) fx<-fdata(sin(x)/sqrt(pi),x) fx0<-fdata(rep(0,length(x)),x) metric.lp(fx,fx0) # The same integrate(function(x){(abs(sin(x)/sqrt(pi))^2)},0,2*pi) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/mfdata.html","id":null,"dir":"Reference","previous_headings":"","what":"mfdata class definition and utilities — mfdata","title":"mfdata class definition and utilities — mfdata","text":"mfdata list fdata type object: ...  fdata objects class fdata n rows.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/mfdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mfdata class definition and utilities — mfdata","text":"","code":"mfdata(...)  # S3 method for class 'mfdata' names(x)  # S3 method for class 'mfdata' subset(x, subset, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/mfdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mfdata class definition and utilities — mfdata","text":"... arguments passed methods. x object class mfdata subset subset","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/mfdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mfdata class definition and utilities — mfdata","text":"","code":"data(tecator) ab0 <- tecator$absorp.fdata ab1 <- fdata.deriv(ab0) ab2 <- fdata.deriv(ab0,nderiv=2) mdat <- mfdata(ab0, ab1, ab2) is.ldata(mdat) #> [1] FALSE class(mdat) #> [1] \"mfdata\" \"list\"   plot(mdat[[1]])  plot(mdat[[2]])   plot(mdat)"},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"na.fail returns object contain missing values, signals error otherwise. na.omit returns object incomplete cases removed. na.omit.fdata removes cases, row numbers cases form \"na.action\" attribute result, class \"omit\", see generic function na.omit.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"","code":"# S3 method for class 'fdata' na.omit(object, ...)  # S3 method for class 'fdata' na.fail(object, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"object fdata object. ... potential arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"value returned omit fdata object incomplete cases removed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"Manuel Febrero Bande Manuel Oviedo","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/na.omit.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A wrapper for the na.omit and na.fail function for fdata object — na.omit.fdata","text":"","code":"if (FALSE) { # \\dontrun{ fdataobj<-fdata(MontrealTemp) fdataobj$data[3,3]<-NA fdataobj$data[10,]<-NA fdastaobj2<-na.omit(fdataobj) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Approximates Lp-norm for functional data. — norm.fdata","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"Approximates Lp-norm functional data (fdata) object using metric semimetric functions. Norm functional data using default Lp-metric.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"","code":"norm.fdata(fdataobj, metric = metric.lp, ...)  norm.fd(fdobj)"},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"fdataobj fdata class object. metric Metric function, default metric.lp. ... arguments passed methods. fdobj Functional data curves fd class.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"default computes L2-norm p = 2 weights w length=(m-1).  $$Let \\ \\ f(x)= fdataobj(x)\\ $$ $$\\left\\|f\\right\\|_p=\\left ( \\frac{1}{\\int_{}^{b}w(x)dx} \\int_{}^{b} \\left|f(x)\\right|^{p}w(x)dx \\right)^{1/p}$$ observed points curve equally spaced (default) .","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/norm.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Approximates Lp-norm for functional data. — norm.fdata","text":"","code":"if (FALSE) { # \\dontrun{ x<-seq(0,2*pi,length=1001) fx1<-sin(x)/sqrt(pi) fx2<-cos(x)/sqrt(pi) argv<-seq(0,2*pi,len=1001) fdat0<-fdata(rep(0,len=1001),argv,range(argv)) fdat1<-fdata(fx1,x,range(x)) metric.lp(fdat1) metric.lp(fdat1,fdat0) norm.fdata(fdat1) # The same integrate(function(x){(abs(sin(x)/sqrt(pi))^2)},0,2*pi) integrate(function(x){(abs(cos(x)/sqrt(pi))^2)},0,2*pi)  bspl1<- create.bspline.basis(c(0,2*pi),21) fd.bspl1 <- fd(basisobj=bspl1) fd.bspl2<-fdata2fd(fdat1,nbasis=21) norm.fd(fd.bspl1) norm.fd(fd.bspl2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/ops.fda.usc.html","id":null,"dir":"Reference","previous_headings":"","what":"ops.fda.usc Options Settings — ops.fda.usc","title":"ops.fda.usc Options Settings — ops.fda.usc","text":"Set query graphical prompt output parameters. Allow user set examine variety global local options affect way fda.usc functions computes displays results.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/ops.fda.usc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ops.fda.usc Options Settings — ops.fda.usc","text":"","code":"ops.fda.usc(   verbose = FALSE,   trace = FALSE,   warning = FALSE,   ncores = NULL,   int.method = \"TRAPZ\",   reset = FALSE,   eps = as.double(.Machine[[1]] * 10) )"},{"path":"https://moviedo5.github.io/fda.usc/reference/ops.fda.usc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ops.fda.usc Options Settings — ops.fda.usc","text":"verbose logical. R report extra information progress? Set TRUE command-line option –verbose. trace logical. Show internal information procedure. warning logical: true, warnings shown. ncores integer. Number CPU cores current host. int.method see method argument int.simpson function. reset logical.  TRUE creates new Parallel Socket Cluster (ncores>1) sequential parallel backend (ncores=1). useful worker initialization failed crush. eps epsilon parameter.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/ops.fda.usc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ops.fda.usc Options Settings — ops.fda.usc","text":"Manuel Oviedo de la Fuente (manuel.oviedo@udc.es).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/ops.fda.usc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ops.fda.usc Options Settings — ops.fda.usc","text":"","code":"if (FALSE) { # \\dontrun{ # If worker initialization failed, please execute this code  ncores <- max(parallel::detectCores() -1,1)  if (ncores==1) {      foreach::registerDoSEQ()  }  else{  cl <-  suppressWarnings(parallel::makePSOCKcluster(ncores ))  doParallel::registerDoParallel(cl)  }  ops.fda.usc() } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Select the number of basis using GCV method. — optim.basis","title":"Select the number of basis using GCV method. — optim.basis","text":"Functional data estimation via basis representation using cross-validation (CV) generalized cross-validation (GCV) method roughness penalty.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select the number of basis using GCV method. — optim.basis","text":"","code":"optim.basis(   fdataobj,   type.CV = GCV.S,   W = NULL,   lambda = 0,   numbasis = floor(seq(ncol(fdataobj)/16, ncol(fdataobj)/2, len = 10)),   type.basis = \"bspline\",   par.CV = list(trim = 0, draw = FALSE),   verbose = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select the number of basis using GCV method. — optim.basis","text":"fdataobj fdata class object. type.CV Type cross-validation. default generalized cross-validation (GCV) method. W Matrix weights. lambda roughness penalty. default, penalty lambda=0. numbasis Number basis use. type.basis Character string determines type basis. default \"bspline\". par.CV List parameters type.CV: trim, alpha trimming draw=TRUE. verbose TRUE information GCV values input parameters printed. Default FALSE. ... arguments passed methods. Arguments passed default create.basis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select the number of basis using GCV method. — optim.basis","text":"gcv: Returns GCV values calculated input parameters. fdataobj: Matrix set cases dimension (n x m), n number curves m points observed curve. fdata.est: Estimated fdata class object. numbasis.opt: numbasis value minimizes CV GCV method. lambda.opt: lambda value minimizes CV GCV method. basis.opt: basis minimum CV GCV method. S.opt: Smoothing matrix minimum CV GCV method. gcv.opt: Minimum CV GCV method. lambda: roughness penalty. default, penalty lambda=0. numbasis: Number basis use. verbose: TRUE information GCV values input parameters printed. Default FALSE. #' @author Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select the number of basis using GCV method. — optim.basis","text":"Provides least GCV functional data list number basis num.basis lambda values lambda. can define type CV use type.CV, default used GCV.S. Smoothing matrix performed S.basis. W matrix weights discretization points.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Select the number of basis using GCV method. — optim.basis","text":"min.basis deprecated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Select the number of basis using GCV method. — optim.basis","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select the number of basis using GCV method. — optim.basis","text":"","code":"if (FALSE) { # \\dontrun{  a1<-seq(0,1,by=.01) a2=rnorm(length(a1),sd=0.2) f1<-(sin(2*pi*a1))+rnorm(length(a1),sd=0.2) nc<-50 np<-length(f1) tt=1:101 S<-S.NW(tt,2) mdata<-matrix(NA,ncol=np,nrow=50) for (i in 1:50) mdata[i,]<- (sin(2*pi*a1))+rnorm(length(a1),sd=0.2) mdata<-fdata(mdata) nb<-floor(seq(5,29,len=5)) l<-2^(-5:15) out<-optim.basis(mdata,lambda=l,numbasis=nb,type.basis=\"fourier\") matplot(t(out$gcv),type=\"l\",main=\"GCV with fourier basis\")  # out1<-optim.basis(mdata,type.CV = CV.S,lambda=l,numbasis=nb) # out2<-optim.basis(mdata,lambda=l,numbasis=nb)  # variance calculations y<-mdata i<-3 z=qnorm(0.025/np) fdata.est<-out$fdata.est var.e<-Var.e(mdata,out$S.opt) var.y<-Var.y(mdata,out$S.opt) var.y2<-Var.y(mdata,out$S.opt,var.e)  # estimated fdata and point confidence interval upper.var.e<-out$fdata.est[[\"data\"]][i,]-z*sqrt(diag(var.e)) lower.var.e<-out$fdata.est[[\"data\"]][i,]+z*sqrt(diag(var.e)) dev.new() plot(y[i,],lwd=1,ylim=c(min(lower.var.e),max(upper.var.e))) lines(out$fdata.est[[\"data\"]][i,],col=gray(.1),lwd=1) lines(out$fdata.est[[\"data\"]][i,]+z*sqrt(diag(var.y)),col=gray(0.7),lwd=2) lines(out$fdata.est[[\"data\"]][i,]-z*sqrt(diag(var.y)),col=gray(0.7),lwd=2) lines(upper.var.e,col=gray(.3),lwd=2,lty=2) lines(lower.var.e,col=gray(.3),lwd=2,lty=2) legend(\"top\",legend=c(\"Var.y\",\"Var.error\"), col = c(gray(0.7), gray(0.3)),lty=c(1,2)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":null,"dir":"Reference","previous_headings":"","what":"Smoothing of functional data using nonparametric kernel estimation — optim.np","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"Smoothing functional data using nonparametric kernel estimation cross-validation (CV) generalized cross-validation (GCV) methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"","code":"optim.np(   fdataobj,   h = NULL,   W = NULL,   Ker = Ker.norm,   type.CV = GCV.S,   type.S = S.NW,   par.CV = list(trim = 0, draw = FALSE),   par.S = list(),   correl = TRUE,   verbose = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"fdataobj fdata class object. h Smoothing parameter bandwidth. W Matrix weights. Ker Type kernel used, default normal kernel. type.CV Type cross-validation. default generalized cross-validation (GCV) method. Possible values GCV.S CV.S type.S Type smothing matrix S. default S calculated Nadaraya-Watson kernel estimator (S.NW). Possible values S.KNN,  S.LLR,  S.LPR  S.LCR. par.CV List parameters  type.CV: trim, alpha trimming draw=TRUE par.S List parameters type.S: tt argvals,  h bandwidth,  Ker kernel, etc. correl logical. TRUE bandwidth parameter h computed following procedure described De  Brabanter et al. (2018). (option avalaible since v1.6.0 version) verbose TRUE information GCV values input parameters printed. Default FALSE. ... arguments passed methods. Arguments passed kernel method.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"Returns GCV CV values calculated input parameters. gcv: GCV CV vector values smoothing parameter h. fdataobj: fdata class object. fdata.est: Estimated fdata class object. h.opt: h value minimizes CV GCV method. S.opt: Smoothing matrix minimum CV GCV method. gcv.opt: Minimum CV GCV method. h: Smoothing parameter bandwidth.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"Calculate minimum GCV vector values smoothing parameter h. Nonparametric smoothing performed kernel function. type kernel use parameter Ker type smothing matrix S use parameter type.S can selected user, see function Kernel. W matrix weights discretization points.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"min.np deprecated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. De Brabanter, K., Cao, F., Gijbels, ., Opsomer, J. (2018). Local polynomial regression correlated errors random design unknown correlation structure.  Biometrika, 105(3), 681-69. Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/optim.np.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smoothing of functional data using nonparametric kernel estimation — optim.np","text":"","code":"if (FALSE) { # \\dontrun{ # Exemple, phoneme DATA data(phoneme) mlearn<-phoneme$learn[1:100]  out1<-optim.np(mlearn,type.CV=CV.S,type.S=S.NW) np<-ncol(mlearn) # variance calculations y<-mlearn out<-out1 i<-1 z=qnorm(0.025/np) fdata.est<-out$fdata.est tt<-y[[\"argvals\"]] var.e<-Var.e(y,out$S.opt) var.y<-Var.y(y,out$S.opt) var.y2<-Var.y(y,out$S.opt,var.e)  # plot estimated fdata and point confidence interval upper.var.e<-fdata.est[i,]-z*sqrt(diag(var.e)) lower.var.e<-fdata.est[i,]+z*sqrt(diag(var.e)) dev.new() plot(y[i,],lwd=1,  ylim=c(min(lower.var.e$data),max(upper.var.e$data)),xlab=\"t\") lines(fdata.est[i,],col=gray(.1),lwd=1) lines(fdata.est[i,]+z*sqrt(diag(var.y)),col=gray(0.7),lwd=2) lines(fdata.est[i,]-z*sqrt(diag(var.y)),col=gray(0.7),lwd=2) lines(upper.var.e,col=gray(.3),lwd=2,lty=2) lines(lower.var.e,col=gray(.3),lwd=2,lty=2) legend(\"bottom\",legend=c(\"Var.y\",\"Var.error\"), col = c(gray(0.7),gray(0.3)),lty=c(1,2)) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"outliers for functional dataset — Outliers.fdata","title":"outliers for functional dataset — Outliers.fdata","text":"Procedure detecting funcitonal outliers.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"outliers for functional dataset — Outliers.fdata","text":"","code":"outliers.depth.pond(   fdataobj,   nb = 200,   smo = 0.05,   quan = 0.5,   dfunc = depth.mode,   ... )  outliers.depth.trim(   fdataobj,   nb = 200,   smo = 0.05,   trim = 0.01,   quan = 0.5,   dfunc = depth.mode,   ... )  outliers.lrt(fdataobj, nb = 200, smo = 0.05, trim = 0.1, ...)  outliers.thres.lrt(fdataobj, nb = 200, smo = 0.05, trim = 0.1, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"outliers for functional dataset — Outliers.fdata","text":"fdataobj fdata class object. nb number bootstrap samples. smo smoothing parameter bootstrap samples. quan Quantile determine cutoff Bootstrap procedure (default=0.5) dfunc Type depth measure, default depth.mode. ... arguments passed methods. trim alpha trimming.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"outliers for functional dataset — Outliers.fdata","text":"outliers Indexes functional outlier. dep.Depth value functional outlier. dep.Iteration  functional outlier detected. quantile Threshold outlier detection. dep Depth value functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"outliers for functional dataset — Outliers.fdata","text":"Outlier detection functional data likelihood ratio test (outliers.lrt). threshold outlier detection given   outliers.thres.lrt.  Outlier detection functional data depth measures:  outliers.depth.pond: function weights data according depth. outliers.depth.trim: function uses trimmed data. quantile_outliers_pond quantile_outliers_trim functions provides   quantiles bootstrap samples functional outlier detection ,   respectively, weigthed trimmed procedures. Bootstrap smoothing function   (fdata.bootstrap nb resamples) applied   weighted trimmed data. smo=0 smoothed bootstrap performed.   function returns vector size 1xnb bootstrap replicas quantile.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"outliers for functional dataset — Outliers.fdata","text":"Cuevas , Febrero M, Fraiman R. 2006.  use bootstrap estimating functions functional data. Computational Statistics Data Analysis 51: 1063-1074. Febrero-Bande, M., Galeano, P., Gonzalez-Manteiga, W. (2008). Outlier detection functional data depth measures application identify abnormal NOx levels. Environmetrics 19, 4, 331–345. Febrero-Bande, M., Galeano, P. Gonzalez-Manteiga, W.\t (2007). functional analysis NOx levels: location scale estimation outlier detection. Computational Statistics 22, 3, 411-427. Febrero-Bande,  M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"outliers for functional dataset — Outliers.fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Outliers.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"outliers for functional dataset — Outliers.fdata","text":"","code":"if (FALSE) { # \\dontrun{ data(aemet) nb=20 # Time consuming out.trim<-outliers.depth.trim(aemet$temp,dfunc=depth.FM,nb=nb) plot(aemet$temp,col=1,lty=1) lines(aemet$temp[out.trim[[1]]],col=2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":null,"dir":"Reference","previous_headings":"","what":"Penalty matrix for higher order differences — P.penalty","title":"Penalty matrix for higher order differences — P.penalty","text":"function computes matrix penalizes higher order differences.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Penalty matrix for higher order differences — P.penalty","text":"","code":"P.penalty(tt, P = c(0, 0, 1))"},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Penalty matrix for higher order differences — P.penalty","text":"tt vector n discretization points argvals. P vector coefficients order differences. Default value P=c(0,0,1) penalizes second order difference.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Penalty matrix for higher order differences — P.penalty","text":"penalty matrix size sum(n) x sum(n)","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Penalty matrix for higher order differences — P.penalty","text":"example, P=c(0,1,2), function return penalty matrix second order difference vector \\(tt\\). $$v^T P_j tt= \\sum_{=3} ^{n} (\\Delta tt_i) ^2$$ $$\\Delta tt_i= tt_i -2 tt_{-1} + tt_{-2}$$ second order difference. details can found Kraemer, Boulesteix, Tutz (2008).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Penalty matrix for higher order differences — P.penalty","text":"discretization points can equidistant .","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Penalty matrix for higher order differences — P.penalty","text":"N. Kraemer, .-L. Boulsteix, G. Tutz (2008). Penalized Partial Least Squares Applications B-Spline Transformations Functional Data. Chemometrics Intelligent Laboratory Systems, 94, 60 - 69. doi:10.1016/j.chemolab.2008.06.009","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Penalty matrix for higher order differences — P.penalty","text":"version created Manuel Oviedo de la Fuente modified original version created Nicole Kramer ppls package.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/P.penalty.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Penalty matrix for higher order differences — P.penalty","text":"","code":"P.penalty((1:10)/10,P=c(0,0,1)) #>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] #>  [1,]    1   -2    1    0    0    0    0    0    0     0 #>  [2,]   -2    5   -4    1    0    0    0    0    0     0 #>  [3,]    1   -4    6   -4    1    0    0    0    0     0 #>  [4,]    0    1   -4    6   -4    1    0    0    0     0 #>  [5,]    0    0    1   -4    6   -4    1    0    0     0 #>  [6,]    0    0    0    1   -4    6   -4    1    0     0 #>  [7,]    0    0    0    0    1   -4    6   -4    1     0 #>  [8,]    0    0    0    0    0    1   -4    6   -4     1 #>  [9,]    0    0    0    0    0    0    1   -4    5    -2 #> [10,]    0    0    0    0    0    0    0    1   -2     1 # a more detailed example can be found under script file"},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":null,"dir":"Reference","previous_headings":"","what":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"Projected Cramer-von Mises statistic (PCvM) Functional Linear Model scalar response (FLM): \\(Y=\\big<X,\\beta\\big>+\\varepsilon\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"","code":"Adot(X, inpr)  PCvM.statistic(X, residuals, p, Adot.vec)"},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"X Functional covariate FLM. object must either class fdata class fd. used compute matrix inner products. inpr Matrix inner products X. Computed given. residuals Residuals estimated FLM. p Number elements functional basis functional covariate represented. Adot.vec Output Adot function (see Details). Computed given.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"PCvM.statistic, value statistic. Adot, suitable output used argument Adot.vec.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"order optimize computation statistic, critical parts two functions coded FORTRAN. hardest part corresponds function Adot, involves computation symmetric matrix dimension \\(n\\times n\\) entry sum \\(n\\) elements. matrix symmetric, order method can reduced \\(O(n^3)\\) \\(O\\big(\\frac{n^3-n^2}{2}\\big)\\). memory requirement can also reduced \\(O\\big(\\frac{n^2-n+2}{2}\\big)\\). value Adot vector length \\(\\frac{n^2-n+2}{2}\\) first element common diagonal element rest lower triangle entries matrix, sorted rows (see Examples).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"NA's allowed functional covariate.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"Escanciano, J. C. (2006). consistent diagnostic test regression models using projections. Econometric  Theory, 22, 1030-1051. doi:10.1017/S0266466606060506 Garcia-Portugues, E., Gonzalez-Manteiga, W. Febrero-Bande, M. (2014). goodness––fit test functional linear model scalar response. Journal Computational Graphical Statistics, 23(3), 761-778. doi:10.1080/10618600.2013.812519","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"Eduardo Garcia-Portugues. Please, report bugs suggestions eduardo.garcia.portugues@uc3m.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/PCvM.statistic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PCvM statistic for the Functional Linear Model with scalar response — PCvM.statistic","text":"","code":"# Functional process X=rproc2fdata(n=10,t=seq(0,1,l=101)) # Adot Adot.vec=Adot(X)  # Obtain the entire matrix Adot Ad=diag(rep(Adot.vec[1],dim(X$data)[1])) Ad[upper.tri(Ad,diag=FALSE)]=Adot.vec[-1] Ad=t(Ad) Ad=Ad+t(Ad)-diag(diag(Ad)) Ad #>           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8] #>  [1,] 34.55752 22.56919 23.42445 22.48372 21.52212 22.14313 22.24761 23.16975 #>  [2,] 22.56919 34.55752 23.11677 23.22390 22.88832 23.43477 23.72314 22.61706 #>  [3,] 23.42445 23.11677 34.55752 22.27545 23.64458 23.07480 23.11521 22.74769 #>  [4,] 22.48372 23.22390 22.27545 34.55752 22.87413 23.14084 22.75209 23.15580 #>  [5,] 21.52212 22.88832 23.64458 22.87413 34.55752 23.21242 24.01934 22.70983 #>  [6,] 22.14313 23.43477 23.07480 23.14084 23.21242 34.55752 23.14678 22.84749 #>  [7,] 22.24761 23.72314 23.11521 22.75209 24.01934 23.14678 34.55752 22.38071 #>  [8,] 23.16975 22.61706 22.74769 23.15580 22.70983 22.84749 22.38071 34.55752 #>  [9,] 23.19679 22.08812 23.39765 22.85707 23.26055 22.92071 22.78013 22.67189 #> [10,] 23.56713 24.23112 23.34407 23.32780 23.06404 23.78524 24.01663 23.20940 #>           [,9]    [,10] #>  [1,] 23.19679 23.56713 #>  [2,] 22.08812 24.23112 #>  [3,] 23.39765 23.34407 #>  [4,] 22.85707 23.32780 #>  [5,] 23.26055 23.06404 #>  [6,] 22.92071 23.78524 #>  [7,] 22.78013 24.01663 #>  [8,] 22.67189 23.20940 #>  [9,] 34.55752 23.34617 #> [10,] 23.34617 34.55752 # Statistic PCvM.statistic(X,residuals=rnorm(10),p=5) #> [1] 4.21528"},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":null,"dir":"Reference","previous_headings":"","what":"phoneme data — phoneme","title":"phoneme data — phoneme","text":"Phoneme curves","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"phoneme data — phoneme","text":"Elements phoneme:..$learn: learning sample curves. fdata class object : .- \"data\": Matrix class fdata 250 curves (rows) discretized 150 points argvals (columns)., ii.- \"argvals\", iii.- \"rangeval\": range(\"argvals\"), iv.- \"names\" list : main overall title \"Phoneme learn\", xlab title x axis \"frequencies\" ylab title y axis \"log-periodograms\"...$test: testing sample curves. fdata class object : .- \"data\": Matrix class fdata 250 curves (rows) discretized 150 points argvals (columns)., ii.- \"argvals\", iii.- \"rangeval\": range(\"argvals\"), iv.- \"names\" list : main overall title \"Phoneme learn\", xlab title x axis \"frequencies\" ylab title y axis \"log-periodograms\"...$classlearn:learning class numbers (factor). Factor levels: \"sh\" 1, \"iy\" 2, \"dcl\" 3, \"aa\" 4 \"ao\" 5...$classtest: testing class numbers (factor). Factor levels: \"sh\" 1, \"iy\" 2, \"dcl\" 3, \"aa\" 4 \"ao\" 5.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"phoneme data — phoneme","text":"https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/npfda-datasets.html","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"phoneme data — phoneme","text":"following instructions used file: https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/npfda-phondiscRS.txt Phoneme dataset file.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"phoneme data — phoneme","text":"Ferraty, F. Vieu, P. (2006). NPFDA practice. Free access line https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"phoneme data — phoneme","text":"Manuel Febrero-Bande Manuel Oviedo de la Fuente <manuel.oviedo@udc.es>","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/phoneme.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"phoneme data — phoneme","text":"","code":"data(phoneme) names(phoneme) #> [1] \"learn\"      \"test\"       \"classlearn\" \"classtest\"  names(phoneme$learn) #> [1] \"data\"     \"argvals\"  \"rangeval\" \"names\"    class(phoneme$learn) #> [1] \"fdata\" dim(phoneme$learn) #> [1] 250 150 table(phoneme$classlearn) #>  #>  1  2  3  4  5  #> 50 50 50 50 50"},{"path":"https://moviedo5.github.io/fda.usc/reference/plot.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot functional data: fdata class object — plot.fdata","title":"Plot functional data: fdata class object — plot.fdata","text":"Plot object class fdata.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/plot.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot functional data: fdata class object — plot.fdata","text":"","code":"# S3 method for class 'fdata' plot(x, type, main, xlab, ylab, lty = 1, mfrow = c(1, 1), time = 1, ...)  # S3 method for class 'fdata' lines(x, ...)  title.fdata(x, main = NULL, xlab = NULL, ylab = NULL, rownames = NULL)  # S3 method for class 'mdepth' plot(x, trim, levgray = 0.9, ...)  # S3 method for class 'depth' plot(x, trim, levgray = 0.9, ...)  # S3 method for class 'bifd' plot(x, argvals.s, argvals.t, ...)  # S3 method for class 'lfdata' plot(x, ask = FALSE, col, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/plot.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot functional data: fdata class object — plot.fdata","text":"x fdata class object : \"data\":  fdata class object curve (1d), \"data\" matrix (default), data.frame array set cases dimension (n x m), n number curves m points observed curve x–axe. fdata2d class object surface (2d). \"data\" array set cases dimension (n x m1 x m2), n number functional data m1 m2 points observed x–y plane. \"argvals\": vector list vectors discretizations points values. \"rangeval\": vector list vectors range discretizations points values, default range(argvals). \"names\": (optional) list main overall title, xlab title x axis ylab title y axis. two-argument functional data object, see bifd. type 1-character string giving type plot desired. following values possible fdata class object: \"l\" lines (default),\"p\" points, , \"o\" overplotted points lines, \"b\", \"c\" (empty \"c\") points joined lines, \"s\" \"S\" stair steps \"h\" histogram-like vertical lines. Finally, \"n\" produce points lines. following values possible fdata2d class object: \"image.contour\" (default) display three-dimensional data add contour lines, \"image\" display three-dimensional data, \"contour\" display contour plot, \"persp\" display perspective plots surface x-y plane \"filled.contour\" display contour plot areas contours filled solid color. main overall title plot: see title. xlab xlab title x axis, plot. ylab ylab title y axis, plot. lty vector line types, see par. mfrow vector form c(nr, nc). Subsequent figures drawn nr--nc array device rows (mfrow). time time interval suspend plot execution , seconds, see Sys.sleep. ... arguments passed matplot function (fdata class) image, contour, persp filled.contour (fdata2d class). rownames Row names. trim alpha trimming. levgray vector desired gray levels 0 1; zero indicates \"black\" one indicates \"white\". argvals.s vector argument values first argument s functional data object evaluated. argvals.t vector argument values second argument t functional data object evaluated. ask Logical. TRUE, prompts user interaction current graphics device. col colors curves, lines points.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/plot.fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot functional data: fdata class object — plot.fdata","text":"Manuel Febrero Bande Manuel Oviedo de la Fuente <manuel.oviedo@udc.es>","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/plot.fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot functional data: fdata class object — plot.fdata","text":"","code":"if (FALSE) { # \\dontrun{ # Example for fdata class of 1 dimension (curve) a1<-seq(0,1,by=.01) a2=rnorm(length(a1),sd=0.2) f1<-(sin(2*pi*a1))+rnorm(length(a1),sd=0.2) nc<-10 np<-length(f1) tt=seq(0,1,len=101) mdata<-matrix(NA,ncol=np,nrow=nc) for (i in 1:nc) mdata[i,]<- (sin(2*pi*a1))+rnorm(length(a1),sd=0.2) fdataobj<-fdata(mdata,tt) res=plot.fdata(fdataobj,type=\"l\",col=gray(1:nrow(mdata)/nrow(mdata))) lines(func.mean(fdataobj),col=3,lwd=2) #original curve  # example for fdata2d class of 2 dimension (surface) t1 <- seq(0, 1, length= 51) t2 <- seq(0, 1, length= 31) z<-array(NA,dim=c(4,51,31)) for (i in 1:4) z[i,,] <- outer(t1, t2, function(a, b) (i*a)*(b)^i) z.fdata<-fdata(z,list(t1,t2)) plot(z.fdata,time=2) plot(z.fdata,mfrow=c(2,2),type=\"persp\",theta=30) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":null,"dir":"Reference","previous_headings":"","what":"poblenou data — poblenou","title":"poblenou data — poblenou","text":"NOx levels measured every hour control station Poblenou Barcelona (Spain).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"poblenou data — poblenou","text":"format :..$nox: fdata class object :  .- \"data\": Matrix 115 curves (rows) discretized 24 points argvals (columns). ii.- \"argvals\": 0:23 iii.- \"rangeval\"=(0,23): range(\"argvals\"),  iv.- \"names\" list : main overall title \"NOx data set\", xlab title x axis \"Hours\" ylab title y axis \"NOx (mglm^3)\"...$df: Data Frame (115x3) dimension.   \"date\" first column. Second column (\"day.week\").  Factor levels: \"Monday\" 1, \"Tuesday\" 2, \"Wednesday\" 3, \"Thursday\" 4, \"Friday\" 5, \"Saturday\" 6 \"Sunday\" 7. Third column \"day.festive\".  Factor levels: \"non festive day\" 0 \"festive day\" 1.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"poblenou data — poblenou","text":"https://mediambient.gencat.cat/ca/05_ambits_dactuacio/","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"poblenou data — poblenou","text":"dataset starts 23 February ends 26 June, 2005. split whole sample hourly measures dataset functional trajectories 24 h observations (curve represents evolution levels 1 day). Twelve curves contained missing data eliminated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"poblenou data — poblenou","text":"Febrero-Bande, M., Galeano, P., Gonzalez-Manteiga, W. (2008).  Outlier detection functional data depth measures application identify abnormal NOx levels. Environmetrics 19, 4, 331-345.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"poblenou data — poblenou","text":"Febrero-Bande, M Oviedo de la Fuente, Manuel","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/poblenou.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"poblenou data — poblenou","text":"","code":"data(poblenou) names(poblenou) #> [1] \"nox\" \"df\"  names(poblenou$nox)  #> [1] \"data\"     \"argvals\"  \"rangeval\" \"names\"    nox<-poblenou$nox class(nox) #> [1] \"fdata\" ind.weekend<-as.integer(poblenou$df[,\"day.week\"])>5 plot(nox,col=ind.weekend+1)"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":null,"dir":"Reference","previous_headings":"","what":"Predicts from a fitted classif.DD object. — predict.classif.DD","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"Classifier functional (multivariate) data DD–classifier.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"","code":"# S3 method for class 'classif.DD' predict(object, new.fdataobj = NULL, type = \"class\", ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"object Object object estimated classif.DD. new.fdataobj default, new p functional explanatory dataset new mulitvariate data data.frame class type !=”predictive”, row data shows probability group membership. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"group.pred:Vector groups classes predicted prob.group: functional data shows probability group membership.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"Returns groups classes predicted using previously trained model.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"Li, J., P.C., Cuesta-Albertos, J.. Liu, R. DD–Classifier: Nonparametric Classification Procedure Based DD-plot.  Journal American Statistical Association (2012), Vol. 107, 737–753.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"Febrero-Bande, M., Oviedo de la Fuente, M.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.DD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predicts from a fitted classif.DD object. — predict.classif.DD","text":"","code":"if (FALSE) { # \\dontrun{ # DD-classif for multivariate data  data(iris) iris<-iris[1:100,] ii<-sample(1:100,80) group.train<-factor(iris[ii,5]) x.train<-iris[ii,1:4] out1=classif.DD(group.train,x.train,depth=\"MhD\",classif=\"lda\") out2=classif.DD(group.train,x.train,depth=\"MhD\",classif=\"glm\") summary(out1) summary(out2) x.test<-iris[-ii,1:4] pred1=predict(out1,x.test) pred2=predict(out2,x.test) group.test<-iris[-ii,5] table(pred1,group.test) table(pred2,group.test)  # DD-classif for Functional data data(phoneme) mlearn<-phoneme[[\"learn\"]] glearn<-phoneme[[\"classlearn\"]]  #  ESTIMATION  out1=classif.DD(glearn,mlearn,depth=\"FM\",classif=\"glm\") summary(out1) #  PREDICTION  mtest<-phoneme[[\"test\"]] gtest<-phoneme[[\"classtest\"]] pred1=predict(out1,mtest) table(pred1,gtest) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":null,"dir":"Reference","previous_headings":"","what":"Predicts from a fitted classif object. — predict.classif","title":"Predicts from a fitted classif object. — predict.classif","text":"Classifier functional data kernel method using functional data object class classif.  Returns predicted classes using previously trained model.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predicts from a fitted classif object. — predict.classif","text":"","code":"# S3 method for class 'classif' predict(object, new.fdataobj = NULL, type = \"class\", ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predicts from a fitted classif object. — predict.classif","text":"object Object object estimated : k nearest neighbors method classif.knn, kernel method classif.kernel. new.fdataobj New functional explanatory data fdata class. type Type prediction (\"class probability group membership\"). ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predicts from a fitted classif object. — predict.classif","text":"type=\"class\", produces vector predictions. type=\"probs\", list following components returned: group.pred vector predictions. prob.group matrix predicted probability factor level.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predicts from a fitted classif object. — predict.classif","text":"Ferraty, F. Vieu, P. (2006). Nonparametricc functional data analysis. Springer Series Statistics, New York. Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predicts from a fitted classif object. — predict.classif","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.classif.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predicts from a fitted classif object. — predict.classif","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) mlearn <- phoneme[[\"learn\"]][1:100] glearn <- phoneme[[\"classlearn\"]][1:100]  #  ESTIMATION knn out1 <- classif.knn(glearn, mlearn, knn = 3) summary(out1)  #  PREDICTION knn mtest <- phoneme[[\"test\"]][1:100] gtest <- phoneme[[\"classtest\"]][1:100] pred1 <- predict(out1, mtest) table(pred1, gtest)   #  ESTIMATION kernel  h <- 2^(0:5) # using metric distances computed in classif.knn out2 <- classif.kernel(glearn, mlearn, h = h, metric = out1$mdist) summary(out2) #  PREDICTION kernel pred2 <- predict(out2,mtest) table(pred2,gtest) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"Computes predictions regression functional explanatory variables scalar response using: basis representation, Principal Components Analysis, Partial least squares nonparametric kernel estimation. Predicts fitted fregre.basis object,see fregre.basis fregre.basis.cv Predicts fitted fregre.pc object,see fregre.pc fregre.pc.cv Predicts fitted fregre.pls object,see fregre.pls fregre.pls.cv Predicts fitted fregre.np object, see fregre.np fregre.np.cv.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"","code":"# S3 method for class 'fregre.fd' predict(   object,   new.fdataobj = NULL,   se.fit = FALSE,   scale = NULL,   df = df,   interval = \"none\",   level = 0.95,   weights = 1,   pred.var = res.var/weights,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"object fregre.fd object. new.fdataobj New functional explanatory data fdata class. se.fit =TRUE (default) standard error estimates returned prediction. scale Scale parameter std.err. calculation. df Degrees freedom scale. interval Type interval calculation. level Tolerance/confidence level. weights variance weights prediction. can numeric vector one-sided model formula. latter case, interpreted expression evaluated newdata pred.var variance(s) future observations assumed prediction intervals. See link{predict.lm} details. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"se.fit = FALSE, vector predictions scalar response returned matrix predictions bounds column names fit, lwr, upr interval set. se.fit =TRUE list following components returned: fit: vector predictions matrix predictions bounds . se.fit: Associated standard error estimates predictions. residual.scale: Residual standard deviations. df: Degrees freedom residual.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"Cai TT, Hall P. 2006. Prediction functional linear regression. Annals Statistics 34: 2159-2179. Cardot H, Ferraty F, Sarda P. 1999. Functional linear model. Statistics Probability Letters 45: 11-22. Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Hall P, Hosseini-Nasab M. 2006. properties functional principal components analysis. Journal Royal Statistical Society B 68: 109-126. Hardle, W. Applied Nonparametric Regression. Cambridge University Press, 1994. Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York. Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for functional linear model (fregre.fd class) — predict.fregre.fd","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) absorp=tecator$absorp.fdata ind=1:129 x=absorp[ind,] y=tecator$y$Fat[ind] newx=absorp[-ind,] newy=matrix(tecator$y$Fat[-ind],ncol=1) ## Functional PC regression res.pc=fregre.pc(x,y,1:6) pred.pc=predict(res.pc,newx) # Functional PLS regression res.pls=fregre.pls(x,y,1:6) pred.pls=predict(res.pls,newx) # Functional nonparametric regression res.np=fregre.np(x,y,Ker=AKer.tri,metric=semimetric.deriv) pred.np=predict(res.np,newx) # Functional regression with basis representation res.basis=fregre.basis.cv(x,y) pred.basis=predict(res.basis[[1]],newx)   dev.new() plot(pred.pc-newy) points(pred.pls-newy,col=2,pch=2) points(pred.np-newy,col=3,pch=3) points(pred.basis-newy,col=4,pch=4) sum((pred.pc-newy)^2,na.rm=TRUE)/sum((newy-mean(newy))^2,na.rm=TRUE) sum((pred.pls-newy)^2,na.rm=TRUE)/sum((newy-mean(newy))^2,na.rm=TRUE) sum((pred.np-newy)^2,na.rm=TRUE)/sum((newy-mean(newy))^2,na.rm=TRUE) sum((pred.basis-newy)^2,na.rm=TRUE)/sum((newy-mean(newy))^2,na.rm=TRUE) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for functional response model — predict.fregre.fr","title":"Predict method for functional response model — predict.fregre.fr","text":"Computes predictions regression functional explanatory variables functional response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for functional response model — predict.fregre.fr","text":"","code":"# S3 method for class 'fregre.fr' predict(object, new.fdataobj = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for functional response model — predict.fregre.fr","text":"object fregre.fr object. new.fdataobj New functional explanatory data fdata class. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for functional response model — predict.fregre.fr","text":"Return predicted functional data.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for functional response model — predict.fregre.fr","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.fr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for functional response model — predict.fregre.fr","text":"","code":"if (FALSE) { # \\dontrun{  # CV prediction for CandianWeather data rtt<-c(0, 365) basiss  <- create.bspline.basis(rtt,7) basist  <- create.bspline.basis(rtt,9) nam<-dimnames(CanadianWeather$dailyAv)[[2]]  # fdata class (raw data) tt<-1:365 tempfdata<-fdata(t(CanadianWeather$dailyAv[,,1]),tt,rtt) log10precfdata<-fdata(t(CanadianWeather$dailyAv[,,3]),tt,rtt) rng<-range(log10precfdata)  for (ind in 1:35){  res1<-  fregre.basis.fr(tempfdata[-ind], log10precfdata[-ind],  basis.s=basiss,basis.t=basist)  pred1<-predict(res1,tempfdata[ind])  plot( log10precfdata[ind],col=1,ylim=rng,main=nam[ind])  lines(pred1,lty=2,col=2)  Sys.sleep(1) }  # fd class  (smooth data) basis.alpha  <- create.constant.basis(rtt) basisx  <- create.bspline.basis(rtt,65)  dayfd<-Data2fd(day.5,CanadianWeather$dailyAv,basisx) tempfd<-dayfd[,1] log10precfd<-dayfd[,3] for (ind in 1:35){  res2 <-  fregre.basis.fr(tempfd[-ind], log10precfd[-ind],  basis.s=basiss,basis.t=basist)  pred2<-predict(res2,tempfd[ind])  plot(log10precfd[ind],col=1,ylim=range(log10precfd$coef),main=nam[ind])   lines(pred2,lty=2,col=2)  Sys.sleep(.5) } } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":null,"dir":"Reference","previous_headings":"","what":"Predictions from a functional gls object — predict.fregre.gls","title":"Predictions from a functional gls object — predict.fregre.gls","text":"predictions functional generalized least squares fitted linear model represented object obtained covariate values defined newx.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predictions from a functional gls object — predict.fregre.gls","text":"","code":"# S3 method for class 'fregre.gls' predict(   object,   newx = NULL,   type = \"response\",   se.fit = FALSE,   scale = NULL,   df,   interval = \"none\",   ... )  # S3 method for class 'fregre.igls' predict(   object,   newx = NULL,   data,   df = df,   weights = 1,   pred.var,   n.ahead = 1L,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predictions from a functional gls object — predict.fregre.gls","text":"object fregre.gls object. newx optional data list look variables predict. omitted, fitted values used. List new explanatory data. type Type prediction (response model term). se.fit =TRUE (default) standard error estimates returned prediction. scale Scale parameter std.err. calculation. df Degrees freedom scale. interval Type interval calculation. ... arguments passed methods. data Data frame time spatinal index weights variance weights prediction. can numeric vector one-sided model formula. latter case, interpreted expression evaluated newdata pred.var variance(s) future observations assumed prediction intervals. See link{predict.lm} details. n.ahead number steps ahead predict.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predictions from a functional gls object — predict.fregre.gls","text":"vector predicted values.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predictions from a functional gls object — predict.fregre.gls","text":"Oviedo de la Fuente, M., Febrero-Bande, M., Pilar Munoz, Dominguez, . Predicting seasonal influenza transmission using Functional Regression Models Temporal Dependence. https://arxiv.org/abs/1610.08718","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predictions from a functional gls object — predict.fregre.gls","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.gls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predictions from a functional gls object — predict.fregre.gls","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) ind<-1:190 x <-fdata.deriv(tecator$absorp.fdata,nderiv=1) dataf=as.data.frame(tecator$y) dataf$itime <- 1:nrow(x) ldat=list(\"df\"=dataf[ind,],\"x\"=x[ind]) newldat=list(\"df\"=dataf[-ind,],\"x\"=x[-ind]) newy <- tecator$y$Fat[-ind] ff <- Fat ~ x res.lm <- fregre.lm(ff,data=ldat) summary(res.lm) res.gls <- fregre.gls(ff,data=ldat, correlation=corAR1()) summary(res.gls) par.cor <- list(\"cor.ARMA\"=list(\"p\"=1)) par.cor <- list(\"cor.ARMA\"=list(\"index\"=c(\"itime\"),\"p\"=1)) res.igls <- fregre.igls(ff,data=ldat,correlation=par.cor)  pred.lm <- predict(res.lm,newldat) pred.gls <- predict(res.gls,newldat) pred.igls <- predict(res.igls,newldat) mean((pred.lm-newldat$df$Fat)^2) mean((pred.gls-newldat$df$Fat)^2) mean((pred.igls-newldat$df$Fat)^2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for functional linear model — predict.fregre.gkam","title":"Predict method for functional linear model — predict.fregre.gkam","text":"Computes predictions regression functional (non functional) explanatory variables scalar response. predict.fregre.lm, Predict method functional linear model fregre.lm fits object using basis principal component representation. predict.fregre.plm, Predict method semi-functional linear regression fregre.plm fits object using using asymmetric kernel estimation. predict.fregre.glm, Predict method functional generalized linear model fregre.glm fits object using basis principal component representation. predict.fregre.gsam, Predict method functional generalized spectral additive model fregre.gsam fits object using basis principal component representation. predict.fregre.gkam, Predict method functional generalized kernel additive model fregre.gkam fits object using backfitting algorithm. functions use model fitting function lm, glm gam properties. using functional data derived, recommended use number bases represent beta lower number bases used represent functional data.  first item data list newx argument called \"df\" data frame response non functional explanatory variables, lm, glm gam. Functional variables (fdata fd class) introduced following items data list newx argument.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for functional linear model — predict.fregre.gkam","text":"","code":"# S3 method for class 'fregre.gkam' predict(object, newx = NULL, type = \"response\", ...)  # S3 method for class 'fregre.glm' predict(object, newx = NULL, type = \"response\", ...)  # S3 method for class 'fregre.gsam' predict(object, newx = NULL, type = \"response\", ...)  # S3 method for class 'fregre.lm' predict(   object,   newx = NULL,   type = \"response\",   se.fit = FALSE,   scale = NULL,   df = df,   interval = \"none\",   level = 0.95,   weights = 1,   pred.var = res.var/weights,   ... )  # S3 method for class 'fregre.plm' predict(object, newx = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for functional linear model — predict.fregre.gkam","text":"object fregre.lm, fregre.plm, fregre.glm, fregre.gsam fregre.gkam object. newx optional data list look variables predict. omitted, fitted values used. List new explanatory data. type character vector, Type prediction: (response, terms model terms effects  model terms partial effects summarized functional variable. ... arguments passed methods. se.fit =TRUE (default) standard error estimates returned prediction. scale Scale parameter std.err. calculation. df Degrees freedom scale. interval Type interval calculation. level Tolerance/confidence level. weights variance weights prediction. can numeric vector one-sided model formula. latter case, interpreted expression evaluated newdata pred.var variance(s) future observations assumed prediction intervals. See link{predict.lm} details.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for functional linear model — predict.fregre.gkam","text":"Return predicted values optionally: predict.lm,predict.glm,predict.gam: produces vector predictions matrix predictions bounds column names fit, lwr, upr interval set. se.fit TRUE, list following components returned: fit vector matrix . se.fit: standard error predicted means. residual.scale: residual standard deviations. df: degrees freedom residual.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predict method for functional linear model — predict.fregre.gkam","text":"Febrero-Bande, M., Oviedo de la Fuente, M. (2012). Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28. https://www.jstatsoft.org/v51/i04/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict method for functional linear model — predict.fregre.gkam","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/predict.fregre.lm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for functional linear model — predict.fregre.gkam","text":"","code":"if (FALSE) { # \\dontrun{ data(tecator) ind <- 1:129 x <- tecator$absorp.fdata x.d2 <- fdata.deriv(x,nderiv=2) tt <- x[[\"argvals\"]] dataf <- as.data.frame(tecator$y) ldat <- ldata(\"df\" = dataf[ind,], \"x.d2\" = x.d2[ind]) basis.x <- list(\"x.d2\" = create.pc.basis(ldat$x.d2)) res <- fregre.gsam(Fat ~  s(x.d2,k=3),                    data=ldat, family = gaussian(),                    basis.x = basis.x) newldat <- ldata(\"df\" = dataf[-ind,], \"x.d2\" = x.d2[-ind]) pred <- predict(res, newldat) plot(pred,tecator$y$Fat[-ind]) res.glm <- fregre.glm(Fat  ~  x.d2, data = ldat,                   family = gaussian(),basis.x = basis.x) pred.glm <- predict(res.glm, newldat) newy <- tecator$y$Fat[-ind] points(pred.glm,tecator$y$Fat[-ind],col=2)  # Time-consuming  res.gkam <- fregre.gkam(Fat ~ x.d2, data = ldat) pred.gkam <- predict(res.gkam, newldat) points(pred.gkam,tecator$y$Fat[-ind],col = 4)  ((1/length(newy)) * sum((drop(newy)-pred)^2)) / var(newy) ((1/length(newy)) * sum((newy-pred.glm)^2)) / var(newy)     ((1/length(newy)) * sum((newy-pred.gkam)^2)) / var(newy)     } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":null,"dir":"Reference","previous_headings":"","what":"Ornstein-Uhlenbeck process — r.ou","title":"Ornstein-Uhlenbeck process — r.ou","text":"Sampling paths Ornstein-Uhlenbeck process.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ornstein-Uhlenbeck process — r.ou","text":"","code":"r.ou(   n,   t = seq(0, 1, len = 201),   mu = 0,   alpha = 1,   sigma = 1,   x0 = rnorm(n, mean = mu, sd = sigma/sqrt(2 * alpha)) )"},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ornstein-Uhlenbeck process — r.ou","text":"n number curves. t discretization points. mu mean process. alpha strength drift. sigma diffusion coefficient. x0 number vector length n giving initial value(s) Ornstein-Uhlenbeck process. default, n points sampled stationary distribution.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ornstein-Uhlenbeck process — r.ou","text":"Functional sample, fdata object length n.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ornstein-Uhlenbeck process — r.ou","text":"Eduardo Garcia-Portugues (edgarcia@est-econ.uc3m.es).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/r.ou.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ornstein-Uhlenbeck process — r.ou","text":"","code":"plot(r.ou(n = 100))  plot(r.ou(n = 100, alpha = 2, sigma = 4, x0 = 1:100))"},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Utils for generate functional data — rcombfdata","title":"Utils for generate functional data — rcombfdata","text":"gridfdata generates n curves lineal combination original curves fdataobj plus functional trend mu.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utils for generate functional data — rcombfdata","text":"","code":"rcombfdata(n = 10, fdataobj, mu, sdarg = rep(1, nrow(fdataobj)), norm = 1)  gridfdata(coef, fdataobj, mu)"},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utils for generate functional data — rcombfdata","text":"n Number curves generated fdataobj fdata class object. mu Functional trend, default mu=\\(\\mu(t)=0\\). object class fdata.  mu fdata class object, t\\(=\\)argvals(mu). sdarg Standard deviation coefficients. norm Norm coefficients. norm adjusted transformation sdarg performed. coef Coefficients combination. matrix number columns equal number curves fdataobj","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utils for generate functional data — rcombfdata","text":"Return functional trajectories fdata class object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Utils for generate functional data — rcombfdata","text":"rcombfdata generates n random linear combinations fdataobj curves plus functional trend mu. coefficients combinations follows normal distribution zero mean standard deviation sdarg.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Utils for generate functional data — rcombfdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rcombfdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utils for generate functional data — rcombfdata","text":"","code":"if (FALSE) { # \\dontrun{ tt=seq(0,1,len=51) fou3=create.fourier.basis(c(0,1),nbasis=3) fdataobj=fdata(t(eval.basis(tt,fou3)),argvals=tt)  coef=expand.grid(0,seq(-1,1,len=11),seq(-1,1,len=11)) grid=gridfdata(coef,fdataobj) plot(grid,lty=1)  rcomb=rcombfdata(n=51,fdataobj,mu=fdata(30*tt*(1-tt),tt)) plot(rcomb,lty=1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":null,"dir":"Reference","previous_headings":"","what":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"Generation random directions based principal components \\(\\hat e_1,\\ldots,\\hat e_k\\) sample functional data \\(X_1,\\ldots,X_n\\). random directions sampled $$h=\\sum_{j=1}^kh_j\\hat e_j,$$ \\(h_j\\sim\\mathcal{N}(0, \\sigma_j^2)\\), \\(j=1,\\ldots,k\\). Useful sampling non-orthogonal random directions \\(h\\) non-orthogonal random sample.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"","code":"rdir.pc(   n,   X.fdata,   ncomp = 0.95,   fdata2pc.obj = fdata2pc(X.fdata, ncomp = min(length(X.fdata$argvals), nrow(X.fdata))),   sd = 0,   zero.mean = TRUE,   norm = FALSE )"},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"n number curves generated. X.fdata fdata object used compute functional principal components. ncomp integer vector provided, index principal components considered. threshold 0 1 given, number components \\(k\\) determined automatically minimum number explains least ncomp proportion total variance X.fdata. fdata2pc.obj output fdata2pc containing many components ones selected ncomp. Otherwise, computed internally. sd 0, standard deviations \\(\\sigma_j\\) estimated standard deviations scores \\(e_j\\). , \\(\\sigma_j\\)'s set sd. zero.mean whether projections zero mean. , mean set mean X.fdata. norm whether samples L2-normalized .","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"fdata object sampled directions.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"Eduardo Garcia-Portugues (edgarcia@est-econ.uc3m.es) Manuel Febrero-Bande (manuel.febrero@usc.es).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rdir.pc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Data-driven sampling of random directions guided by sample of functional data — rdir.pc","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate some data set.seed(345673) X.fdata <- r.ou(n = 200, mu = 0, alpha = 1, sigma = 2, t = seq(0, 1, l = 201),                  x0 = rep(0, 200)) pc <- fdata2pc(X.fdata, ncomp = 20)  # Samples set.seed(34567) rdir.pc(n = 5, X.fdata = X.fdata, zero.mean = FALSE)$data[, 1:5] set.seed(34567) rdir.pc(n = 5, X.fdata = X.fdata, fdata2pc.obj = pc)$data[, 1:5]  # Comparison for the variance type set.seed(456732) n.proj <- 100 set.seed(456732) samp1 <- rdir.pc(n = n.proj, X.fdata = X.fdata, sd = 1, norm = FALSE, ncomp = 0.99) set.seed(456732) samp2 <- rdir.pc(n = n.proj, X.fdata = X.fdata, sd = 0, norm = FALSE, ncomp = 0.99) set.seed(456732) samp3 <- rdir.pc(n = n.proj, X.fdata = X.fdata, sd = 1, norm = TRUE, ncomp = 0.99) set.seed(456732) samp4 <- rdir.pc(n = n.proj, X.fdata = X.fdata, sd = 0, norm = TRUE, ncomp = 0.99) par(mfrow = c(1, 2)) plot(X.fdata, col = gray(0.85), lty = 1) lines(samp1[1:10], col = 2, lty = 1) lines(samp2[1:10], col = 4, lty = 1) legend(\"topleft\", legend = c(\"Data\", \"Different variances\", \"Equal variances\"),         col = c(gray(0.85), 2, 4), lwd = 2) plot(X.fdata, col = gray(0.85), lty = 1) lines(samp3[1:10], col = 5, lty = 1) lines(samp4[1:10], col = 6, lty = 1) legend(\"topleft\", legend = c(\"Data\", \"Different variances, normalized\",         \"Equal variances, normalized\"), col = c(gray(0.85), 5:6), lwd = 2)  # Correlations (stronger with different variances and unnormalized;  # stronger with lower ncomp) ind <- lower.tri(matrix(nrow = n.proj, ncol = n.proj)) median(abs(cor(sapply(1:n.proj, function(i) inprod.fdata(X.fdata, samp1[i]))))[ind]) median(abs(cor(sapply(1:n.proj, function(i) inprod.fdata(X.fdata, samp2[i]))))[ind]) median(abs(cor(sapply(1:n.proj, function(i) inprod.fdata(X.fdata, samp3[i]))))[ind]) median(abs(cor(sapply(1:n.proj, function(i) inprod.fdata(X.fdata, samp4[i]))))[ind])  # Comparison for the threshold samp1 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.25, fdata2pc.obj = pc) samp2 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.50, fdata2pc.obj = pc) samp3 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.90, fdata2pc.obj = pc) samp4 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.95, fdata2pc.obj = pc) samp5 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.99, fdata2pc.obj = pc) cols <- rainbow(5, alpha = 0.25) par(mfrow = c(3, 2)) plot(X.fdata, col = gray(0.75), lty = 1, main = \"Data\") plot(samp1, col = cols[1], lty = 1, main = \"Threshold = 0.25\") plot(samp2, col = cols[2], lty = 1, main = \"Threshold = 0.50\") plot(samp3, col = cols[3], lty = 1, main = \"Threshold = 0.90\") plot(samp4, col = cols[4], lty = 1, main = \"Threshold = 0.95\") plot(samp5, col = cols[5], lty = 1, main = \"Threshold = 0.99\")  # Normalizing samp1 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.50, fdata2pc.obj = pc,                  norm = TRUE) samp2 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.90, fdata2pc.obj = pc,                  norm = TRUE) samp3 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.95, fdata2pc.obj = pc,                  norm = TRUE) samp4 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.99, fdata2pc.obj = pc,                  norm = TRUE) samp5 <- rdir.pc(n = 100, X.fdata = X.fdata, ncomp = 0.999, fdata2pc.obj = pc,                  norm = TRUE) cols <- rainbow(5, alpha = 0.25) par(mfrow = c(3, 2)) plot(X.fdata, col = gray(0.75), lty = 1, main = \"Data\") plot(samp1, col = cols[1], lty = 1, main = \"Threshold = 0.50\") plot(samp2, col = cols[2], lty = 1, main = \"Threshold = 0.90\") plot(samp3, col = cols[3], lty = 1, main = \"Threshold = 0.95\") plot(samp4, col = cols[4], lty = 1, main = \"Threshold = 0.99\") plot(samp5, col = cols[5], lty = 1, main = \"Threshold = 0.999\") } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"Computes Cramer-von Mises (CvM) Kolmogorv-Smirnov (kS) statistics projected process $$T_{n,h}(u)=\\frac{1}{n}\\sum_{=1}^n (Y_i-\\langle X_i,\\hat \\beta\\rangle)1_{\\{\\langle X_i, h\\rangle\\leq u\\}},$$ designed test goodness--fit functional linear model scalar response. NA's allowed neither functional covariate scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"","code":"rp.flm.statistic(proj.X, residuals, proj.X.ord = NULL, F.code = TRUE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"proj.X matrix size c(n, n.proj) containing, column, projections functional data \\(X_1,\\ldots,X_n\\) random direction \\(h\\). required proj.X.ord provided. residuals residuals fitted funtional linear model, \\(Y_i-\\langle X_i,\\hat \\beta\\rangle\\). Either vector length n (residuals projections) matrix size c(n.proj, n) (projection associated set residuals). proj.X.ord matrix containing row permutations proj.X rearranges increasingly, column. , example proj.X[proj.X.ord[, 1], 1] equals sort(proj.X[, 1]). provided, computed internally. F.code whether use faster FORTRAN code R code.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"list containing: list(\"statistic\"): matrix size c(n.proj, 2) CvM (first column) KS (second) statistics, n.proj different projections. list(\"proj.X.ord\"): computed row permutations proj.X, useful recycling subsequent calls rp.flm.statistic projections different residuals.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"Cuesta-Albertos, J.., Garcia-Portugues, E., Febrero-Bande, M. Gonzalez-Manteiga, W. (2017). Goodness--fit tests functional linear model based randomly projected empirical processes. arXiv:1701.08363. https://arxiv.org/abs/1701.08363","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"Eduardo Garcia-Portugues (edgarcia@est-econ.uc3m.es) Manuel Febrero-Bande (manuel.febrero@usc.es).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.statistic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistics for testing the functional linear model using random projections — rp.flm.statistic","text":"","code":"if (FALSE) { # \\dontrun{ # Simulated example set.seed(345678) t <- seq(0, 1, l = 101) n <- 100 X <- r.ou(n = n, t = t) beta0 <- fdata(mdata = cos(2 * pi * t) - (t - 0.5)^2, argvals = t,                rangeval = c(0,1)) Y <- inprod.fdata(X, beta0) + rnorm(n, sd = 0.1)  # Linear model mod <- fregre.pc(fdataobj = X, y = Y, l = 1:3)  # Projections proj.X1 <- inprod.fdata(X, r.ou(n = 1, t = t)) proj.X2 <- inprod.fdata(X, r.ou(n = 1, t = t)) proj.X12 <- cbind(proj.X1, proj.X2)  # Statistics t1 <- rp.flm.statistic(proj.X = proj.X1, residuals = mod$residuals) t2 <- rp.flm.statistic(proj.X = proj.X2, residuals = mod$residuals) t12 <- rp.flm.statistic(proj.X = proj.X12, residuals = mod$residuals) t1$statistic t2$statistic t12$statistic  # Recycling proj.X.ord rp.flm.statistic(proj.X.ord = t1$proj.X.ord, residuals = mod$residuals)$statistic t1$statistic  # Sort in the columns cbind(proj.X12[t12$proj.X.ord[, 1], 1], proj.X12[t12$proj.X.ord[, 2], 2]) - apply(proj.X12, 2, sort)  # FORTRAN and R code rp.flm.statistic(proj.X = proj.X1, residuals = mod$residuals)$statistic - rp.flm.statistic(proj.X = proj.X1, residuals = mod$residuals,                   F.code = FALSE)$statistic  # Matrix and vector residuals rp.flm.statistic(proj.X = proj.X12, residuals = mod$residuals)$statistic rp.flm.statistic(proj.X = proj.X12,                   residuals = rbind(mod$residuals, mod$residuals * 2))$statistic } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"Tests composite null hypothesis Functional Linear Model scalar response (FLM), $$H_0:\\,Y=\\langle X,\\beta\\rangle+\\epsilon\\quad\\mathrm{vs}\\quad H_1:\\,Y\\neq\\langle X,\\beta\\rangle+\\epsilon.$$ \\(\\beta=\\beta_0\\) provided, simple hypothesis \\(H_0:\\,Y=\\langle X,\\beta_0\\rangle+\\epsilon\\) tested. way testing null hypothesis via norm (Cramer-von Mises Kolmogorov-Smirnov) empirical process indexed projections. NA's allowed neither functional covariate scalar response.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"","code":"rp.flm.test(   X.fdata,   Y,   beta0.fdata = NULL,   B = 1000,   n.proj = 10,   est.method = \"pc\",   p = NULL,   p.criterion = \"SICc\",   pmax = 20,   type.basis = \"bspline\",   projs = 0.95,   verbose = TRUE,   same.rwild = FALSE,   seed = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"X.fdata functional observations class fdata. Y scalar responses FLM. Must vector number elements functions X.fdata. beta0.fdata functional parameter simple null hypothesis, fdata class. argvals rangeval arguments beta0.fdata must X.fdata. beta0.fdata=NULL (default), function test composite null hypothesis. B number bootstrap replicates calibrate distribution test statistic. n.proj vector number projections consider. est.method Estimation method \\(\\beta\\), used composite case. three methods: \"pc\": p given, \\(\\beta\\) estimated fregre.pc. Otherwise, p chosen using fregre.pc.cv p.criterion criterion. \"pls\": p given, \\(\\beta\\) estimated fregre.pls. Otherwise, p chosen using fregre.pls.cv p.criterion criterion. \"basis\": p given, \\(\\beta\\) estimated fregre.basis. Otherwise, p chosen using fregre.basis.cv p.criterion criterion. fregre.basis fregre.basis.cv, basis basis.x basis.b considered. p number elements basis representation beta0.fdata X.fdata est.method (composite hypothesis). supplied, estimated data. p.criterion est.method equal \"pc\" \"pls\", either \"SIC\", \"SICc\" one criterions described fregre.pc.cv. \"basis\" value type.CV fregre.basis.cv GCV.S. pmax maximum size basis expansion consider using p.criterion. type.basis type basis est.method = \"basis\". projs fdata object containing random directions employed project X.fdata. numeric, convenient value ncomp rdir.pc. verbose whether show information testing progress. .rwild wether employ wild bootstrap residuals different projections . seed seed employed set.seed initializing random projections. ... arguments passed create.basis (rangeval taken rangeval X.fdata).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"object class \"htest\" whose underlying structure list containing following components: p.values.fdr: matrix size c(n.proj, 2), containing row FDR p-values CvM KS tests projection. proj.statistics: matrix size c(max(n.proj), 2) value test statistic projection. boot.proj.statistics: array size c(max(n.proj), 2, B) values bootstrap test statistics projection. proj.p.values: matrix size c(max(n.proj), 2). method: information test performed kind estimation performed. B: number bootstrap replicates used. n.proj: number projections specified. projs: random directions employed project X.fdata. type.basis: type basis est.method = \"basis\". beta.est: estimated functional parameter \\(\\hat \\beta\\) composite hypothesis. simple hypothesis, beta0.fdata. p: number basis elements considered estimation \\(\\beta\\). p.criterion: criterion employed selecting p. data.name: character string \"Y = <X, b> + e\".","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"Cuesta-Albertos, J.., Garcia-Portugues, E., Febrero-Bande, M. Gonzalez-Manteiga, W. (2017). Goodness--fit tests functional linear model based randomly projected empirical processes. arXiv:1701.08363. https://arxiv.org/abs/1701.08363 Garcia-Portugues, E., Gonzalez-Manteiga, W. Febrero-Bande, M. (2014). goodness--fit test functional linear model scalar response. Journal Computational Graphical Statistics, 23(3), 761–778. doi:10.1080/10618600.2013.812519","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"Eduardo Garcia-Portugues (edgarcia@est-econ.uc3m.es) Manuel Febrero-Bande (manuel.febrero@usc.es).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rp.flm.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Goodness-of fit test for the functional linear model using random projections — rp.flm.test","text":"","code":"if (FALSE) { # \\dontrun{ # Simulated example  set.seed(345678) t <- seq(0, 1, l = 101) n <- 100 X <- r.ou(n = n, t = t, alpha = 2, sigma = 0.5) beta0 <- fdata(mdata = cos(2 * pi * t) - (t - 0.5)^2, argvals = t,                rangeval = c(0,1)) Y <- inprod.fdata(X, beta0) + rnorm(n, sd = 0.1)  # Test all cases rp.flm.test(X.fdata = X, Y = Y, est.method = \"pc\") rp.flm.test(X.fdata = X, Y = Y, est.method = \"pls\") rp.flm.test(X.fdata = X, Y = Y, est.method = \"basis\",              p.criterion = fda.usc.devel::GCV.S) rp.flm.test(X.fdata = X, Y = Y, est.method = \"pc\", p = 5) rp.flm.test(X.fdata = X, Y = Y, est.method = \"pls\", p = 5) rp.flm.test(X.fdata = X, Y = Y, est.method = \"basis\", p = 5) rp.flm.test(X.fdata = X, Y = Y, beta0.fdata = beta0)  # Composite hypothesis: do not reject FLM rp.test <- rp.flm.test(X.fdata = X, Y = Y, est.method = \"pc\") rp.test$p.values.fdr pcvm.test <- flm.test(X.fdata = X, Y = Y, est.method = \"pc\", B = 1e3,                       plot.it = FALSE) pcvm.test  # Estimation of beta par(mfrow = c(1, 3)) plot(X, main = \"X\") plot(beta0, main = \"beta\") lines(rp.test$beta.est, col = 2) lines(pcvm.test$beta.est, col = 3) plot(density(Y), main = \"Density of Y\", xlab = \"Y\", ylab = \"Density\") rug(Y)  # Simple hypothesis: do not reject beta = beta0 rp.flm.test(X.fdata = X, Y = Y, beta0.fdata = beta0)$p.values.fdr flm.test(X.fdata = X, Y = Y, beta0.fdata = beta0, B = 1e3, plot.it = FALSE)  # Simple hypothesis: reject beta = beta0^2 rp.flm.test(X.fdata = X, Y = Y, beta0.fdata = beta0^2)$p.values.fdr flm.test(X.fdata = X, Y = Y, beta0.fdata = beta0^2, B = 1e3, plot.it = FALSE)  # Tecator dataset  # Load data data(tecator) absorp <- tecator$absorp.fdata ind <- 1:129 # or ind <- 1:215 x <- absorp[ind, ] y <- tecator$y$Fat[ind]  # Composite hypothesis rp.tecat <- rp.flm.test(X.fdata = x, Y = y, est.method = \"pc\") pcvm.tecat <- flm.test(X.fdata = x, Y = y, est.method = \"pc\", B = 1e3,                        plot.it = FALSE) rp.tecat$p.values.fdr[c(5, 10), ] pcvm.tecat  # Simple hypothesis zero <- fdata(mdata = rep(0, length(x$argvals)), argvals = x$argvals,               rangeval = x$rangeval) rp.flm.test(X.fdata = x, Y = y, beta0.fdata = zero) flm.test(X.fdata = x, Y = y, beta0.fdata = zero, B = 1e3)  # With derivatives rp.tecat <- rp.flm.test(X.fdata = fdata.deriv(x, 1), Y = y, est.method = \"pc\") rp.tecat$p.values.fdr rp.tecat <- rp.flm.test(X.fdata = fdata.deriv(x, 2), Y = y, est.method = \"pc\") rp.tecat$p.values.fdr  # AEMET dataset  # Load data data(aemet) wind.speed <- apply(aemet$wind.speed$data, 1, mean) temp <- aemet$temp  # Remove the 5% of the curves with less depth (i.e. 4 curves) par(mfrow = c(1, 1)) res.FM <- depth.FM(temp, draw = TRUE) qu <- quantile(res.FM$dep, prob = 0.05) l <- which(res.FM$dep <= qu) lines(aemet$temp[l], col = 3)  # Data without outliers wind.speed <- wind.speed[-l] temp <- temp[-l]  # Composite hypothesis rp.aemet <- rp.flm.test(X.fdata = temp, Y = wind.speed, est.method = \"pc\") pcvm.aemet <- flm.test(X.fdata = temp, Y = wind.speed, B = 1e3,                        est.method = \"pc\", plot.it = FALSE) rp.aemet$p.values.fdr apply(rp.aemet$p.values.fdr, 2, range) pcvm.aemet  # Simple hypothesis zero <- fdata(mdata = rep(0, length(temp$argvals)), argvals = temp$argvals,               rangeval = temp$rangeval) flm.test(X.fdata = temp, Y = wind.speed, beta0.fdata = zero, B = 1e3,          plot.it = FALSE) rp.flm.test(X.fdata = temp, Y = wind.speed, beta0.fdata = zero) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate several random processes. — rproc2fdata","title":"Simulate several random processes. — rproc2fdata","text":"Simulate Functional Data different processes: Ornstein Uhlenbeck, Brownian, Fractional Brownian, Gaussian Exponential variogram.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate several random processes. — rproc2fdata","text":"","code":"rproc2fdata(   n,   t = NULL,   mu = rep(0, length(t)),   sigma = 1,   par.list = list(scale = 1, theta = 0.2 * diff(rtt), H = 0.5),   norm = FALSE,   verbose = FALSE,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate several random processes. — rproc2fdata","text":"n Number functional curves generated. t Discretization points. mu vector specifies trend values discretization points, default mu=\\(\\mu(t)=0\\).  mu fdata class object, t\\(=\\)argvals(mu). sigma positive-definite symmetric matrix, \\(\\Sigma_{s,t}\\), specifying covariance matrix among grid points.  sigma scalar, creates random Gaussian process \\(\\Sigma_{s,t}=\\)sigmaI (default sigma=1). sigma vector, creates random Gaussian process \\(\\Sigma_{s,t}=\\)diag(sigma). sigma character: create random process using covariance matrix \\(\\Sigma_{s,t}\\) indicated argument, \"OU\" \"OrnsteinUhlenbeck\", creates random Ornstein Uhlenbeck process \\(\\Sigma_{s,t}=\\frac{\\sigma^2}{2\\theta}e^{-\\theta\\left(s+t\\right)} \\left(e^{2\\theta\\left(s+t\\right)}-1\\right)\\), default \\(\\theta=1/(3range(t))\\), \\(\\sigma^2={1}\\). \"brownian\" \"wiener\", creates random Wiener process \\(\\Sigma_{s,t}=\\sigma^2 min(s,t)\\), default \\(\\sigma^2=1\\). \"fbrownian\", creates random fractional brownian process \\(\\Sigma_{s,t}=\\sigma^{2H}/2{|s|^{2H}+|t|^{2H}-|s-t|^{2H}}\\), default \\(\\sigma^2=1\\) \\(H=0.5\\) (brownian process). \"vexponential\", creates random gaussian process exponential variogram \\(\\Sigma_{s,t}=\\sigma^2 e^{\\left(-\\frac{\\left|s-t\\right|}{\\theta}\\right)}\\), default \\(\\theta={0.2 range(t)}\\), \\(\\sigma^2={1}\\). par.list List parameter process, default \"scale\" \\(\\sigma^2=1\\), \"theta\" \\(\\theta=0.2 range(t)\\) \"H\"=0.5. norm TRUE norm random projection 1. Default FALSE verbose TRUE, information procedure printed. Default FALSE. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate several random processes. — rproc2fdata","text":"Return functional random processes fdata class object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate several random processes. — rproc2fdata","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate several random processes. — rproc2fdata","text":"","code":"if (FALSE) { # \\dontrun{ par(mfrow=c(3,2)) lent<-30 tt<-seq(0,1,len=lent) mu<-fdata(rep(0,lent),tt) plot(rproc2fdata(200,t=tt,sigma=\"OU\",par.list=list(\"scale\"=1))) plot(rproc2fdata(200,mu=mu,sigma=\"OU\",par.list=list(\"scale\"=1))) plot(rproc2fdata(200,t=tt,sigma=\"vexponential\")) plot(rproc2fdata(200,t=tt,sigma=1:lent)) plot(rproc2fdata(200,t=tt,sigma=\"brownian\")) plot(rproc2fdata(200,t=tt,sigma=\"wiener\")) #plot(rproc2fdata(200,seq(0,1,len=30),sigma=\"oo\")) # this is an error  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":null,"dir":"Reference","previous_headings":"","what":"Wild bootstrap residuals — rwild","title":"Wild bootstrap residuals — rwild","text":"wild bootstrap residuals computed \\(residuals*V\\), \\(V\\) sampling random variable (see details section).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wild bootstrap residuals — rwild","text":"","code":"rwild(residuals, type = \"golden\")"},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wild bootstrap residuals — rwild","text":"residuals residuals type Type distribution V.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wild bootstrap residuals — rwild","text":"wild bootstrap residuals computed using sample random variable \\(V\\).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wild bootstrap residuals — rwild","text":"construction wild bootstrap residuals, sampling random variable \\(V\\) \\(E[V^2]=0\\) \\(E[V]=0\\) needed.  simple suitable \\(V\\) obtained discrete variable form: “golden”, Sampling golden section bootstrap values suggested Mammen (1993).  $$P\\Bigg\\{ V=\\frac{1-\\sqrt{5}}{2} \\Bigg\\} = \\frac{5+\\sqrt{5}}{10} \\, \\, P\\Bigg\\{ V=\\frac{1+\\sqrt{5}}{2} \\Bigg\\} = \\frac{5-\\sqrt{5}}{10},$$  leads golden section bootstrap. “Rademacher”, Sampling Rademacher distribution values  \\(\\big\\{-1,\\,1\\big\\}\\) probabilities \\(\\big\\{\\frac{1}{2},\\,\\frac{1}{2}\\big\\}\\), respectively. “normal”, Sampling standard normal distribution.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wild bootstrap residuals — rwild","text":"Mammen, E. (1993). Bootstrap wild bootstrap high dimensional linear models.     Annals Statistics 21, 255 285.       Davidson, R. E. Flachaire (2001). wild bootstrap, tamed last. working paper IER1000, Queens University.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wild bootstrap residuals — rwild","text":"Eduardo Garcia-Portugues, Manuel Febrero-Bande  Manuel Oviedo de la Fuente manuel.oviedo@udc.es.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/rwild.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wild bootstrap residuals — rwild","text":"","code":"n<-100 # For golden wild bootstrap variable e.boot0=rwild(rep(1,len=n),\"golden\") # Construction of wild bootstrap residuals e=rnorm(n) e.boot1=rwild(e,\"golden\") e.boot2=rwild(e,\"Rademacher\") e.boot3=rwild(e,\"normal\") summary(e.boot1) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -1.711798 -0.524346 -0.088747 -0.004498  0.549868  4.453846  summary(e.boot2) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #> -2.08055 -0.78368 -0.06944 -0.02464  0.63849  2.75263  summary(e.boot3) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #> -3.12437 -0.43165 -0.01705 -0.01081  0.31982  4.41472"},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Smoothing matrix with roughness penalties by basis representation. — S.basis","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"Provides smoothing matrix S roughness penalties.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"","code":"S.basis(tt, basis, lambda = 0, Lfdobj = vec2Lfd(c(0, 0)), w = NULL, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"tt Discretization points. basis Basis use. See create.basis. lambda roughness penalty. default, penalty lambda=0. Lfdobj See eval.penalty. w Optional case weights. ... arguments passed methods. Arguments passed default create.basis","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"Return smoothing matrix S.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"Provides smoothing matrix S discretization points tt bbasis roughness penalties. lambda=0 used penalty, else basis roughness penalty matrix caluclated using getbasispenalty.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"Ramsay, James O. Silverman, Bernard W. (2006).  Functional Data Analysis, 2nd ed., Springer, New York. Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smoothing matrix with roughness penalties by basis representation. — S.basis","text":"","code":"if (FALSE) { # \\dontrun{ np=101 tt=seq(0,1,len=np)  nbasis=11 base1 <- create.bspline.basis(c(0, np), nbasis) base2 <- create.fourier.basis(c(0, np), nbasis)  S1<-S.basis(tt,basis=base1,lambda=3) image(S1)  S2<-S.basis(tt,basis=base2,lambda=3) image(S2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":null,"dir":"Reference","previous_headings":"","what":"Smoothing matrix by nonparametric methods — S.np","title":"Smoothing matrix by nonparametric methods — S.np","text":"Provides smoothing matrix S discretization points tt","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smoothing matrix by nonparametric methods — S.np","text":"","code":"S.LLR(tt, h, Ker = Ker.norm, w = NULL, cv = FALSE)  S.LPR(tt, h, p = 1, Ker = Ker.norm, w = NULL, cv = FALSE)  S.LCR(tt, h, Ker = Ker.norm, w = NULL, cv = FALSE)  S.KNN(tt, h = NULL, Ker = Ker.unif, w = NULL, cv = FALSE)  S.NW(tt, h = NULL, Ker = Ker.norm, w = NULL, cv = FALSE)"},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smoothing matrix by nonparametric methods — S.np","text":"tt Vector discretization points distance matrix mdist h Smoothing parameter bandwidth. S.KNN, number k-nearest neighbors. Ker Type kernel used, default normal kernel. w Optional case weights. cv TRUE, cross-validation done. p Polynomial degree. passed default create.basis","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smoothing matrix by nonparametric methods — S.np","text":"Return smoothing matrix S. S.LLR: Local Linear Smoothing. S.NW:  Nadaraya-Watson kernel estimator. S.KNN: k nearest neighbors estimator. S.LPR: Local Polynomial Regression Estimator. S.LCR: Cubic Polynomial Regression.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smoothing matrix by nonparametric methods — S.np","text":"Options: S.NW: Nadaraya-Watson kernel estimator bandwidth parameter h. S.LLR: Local Linear Smoothing bandwidth parameter h. S.KNN: K nearest neighbors estimator parameter knn. S.LPR: Polynomial Local Regression Estimator parameter polynomial p kernel Ker. S.LCR: Local Cubic Regression Estimator kernel Ker.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Smoothing matrix by nonparametric methods — S.np","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Wasserman, L. Nonparametric Statistics. Springer Texts Statistics, 2006. Opsomer, J. D., Ruppert, D. (1997). Fitting bivariate additive model local polynomial regression. Annals Statistics, 25(1), 186-211.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smoothing matrix by nonparametric methods — S.np","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/S.np.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smoothing matrix by nonparametric methods — S.np","text":"","code":"if (FALSE) { # \\dontrun{   tt <- 1:101   S <- S.LLR(tt,h=5)   S2 <- S.LLR(tt,h=10,Ker=Ker.tri)   S3 <- S.NW(tt,h=10,Ker=Ker.tri)   S4 <- S.KNN(tt,h=5,Ker=Ker.tri)   par(mfrow=c(2,3))   image(S)   image(S2)   image(S3)   image(S4)   S5 <- S.LPR(tt,h=10,p=1, Ker=Ker.tri)   S6 <- S.LCR(tt,h=10,Ker=Ker.tri)   image(S5)   image(S6) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":null,"dir":"Reference","previous_headings":"","what":"Proximities between functional data — semimetric.basis","title":"Proximities between functional data — semimetric.basis","text":"Approximates semi-metric distances functional data class fdata fd.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proximities between functional data — semimetric.basis","text":"","code":"semimetric.basis(   fdata1,   fdata2 = fdata1,   nderiv = 0,   type.basis1 = NULL,   nbasis1 = NULL,   type.basis2 = type.basis1,   nbasis2 = NULL,   ... )"},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proximities between functional data — semimetric.basis","text":"fdata1 Functional data 1 curve 1. fdata2 Functional data 2 curve 2. nderiv Order derivation, used deriv.fd type.basis1 Type Basis fdata1. nbasis1 Number Basis fdata1. type.basis2 Type Basis fdata2. nbasis2 Number Basis fdata2. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Proximities between functional data — semimetric.basis","text":"Returns proximities matrix functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Proximities between functional data — semimetric.basis","text":"Approximates semi-metric distances functional data two fd class objects.  functional data functional fd class, semimetric.basis function creates basis represent functional data, default used create.bspline.basis fdata class object converted fd class using Data2fd. function calculates distances derivative order nderiv curves using deriv.fd function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Proximities between functional data — semimetric.basis","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.basis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Proximities between functional data — semimetric.basis","text":"","code":"if (FALSE) { # \\dontrun{ data(phoneme) DATA1<-phoneme$learn[c(30:50,210:230)] DATA2<-phoneme$test[231:250] a1=semimetric.basis(DATA1,DATA2) a2=semimetric.basis(DATA1,DATA2,type.basis1=\"fourier\", nbasis1=11, type.basis2=\"fourier\",nbasis2=11) fd1 <- fdata2fd(DATA1) fd2 <- fdata2fd(DATA2) a3=semimetric.basis(fd1,fd2) a4=semimetric.basis(fd1,fd2,nderiv=1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":null,"dir":"Reference","previous_headings":"","what":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"Computes semi-metric distances functional data based Ferraty F Vieu, P. (2006).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"","code":"semimetric.deriv(   fdata1,   fdata2 = fdata1,   nderiv = 1,   nknot = ifelse(floor(ncol(DATA1)/3) > floor((ncol(DATA1) - nderiv - 4)/2),     floor((ncol(DATA1) - nderiv - 4)/2), floor(ncol(DATA1)/3)),   ... )  semimetric.fourier(   fdata1,   fdata2 = fdata1,   nderiv = 0,   nbasis = ifelse(floor(ncol(DATA1)/3) > floor((ncol(DATA1) - nderiv - 4)/2),     floor((ncol(DATA1) - nderiv - 4)/2), floor(ncol(DATA1)/3)),   period = NULL,   ... )  semimetric.hshift(fdata1, fdata2 = fdata1, t = 1:ncol(DATA1), ...)  semimetric.mplsr(fdata1, fdata2 = fdata1, q = 2, class1, ...)  semimetric.pca(fdata1, fdata2 = fdata1, q = 1, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"fdata1 Functional data 1 curve 1. DATA1 dimension (n1 x m), n1 number curves m points observed curve. fdata2 Functional data 2 curve 2. DATA1 dimension (n2 x m), n2 number curves m points observed curve. nderiv Order derivation, used semimetric.deriv semimetric.fourier nknot semimetric.deriv argument: number interior knots (needed defining B-spline basis). ... arguments passed methods. nbasis semimetric.fourier: size basis. period semimetric.fourier:allows select period fourier expansion. t semimetric.hshift: vector defines t (one can choose 1,2,...,nbt nbt number points discretization) q semimetric.pca: retained number principal components. semimetric.mplsr: retained number factors. class1 semimetric.mplsr: vector containing categorical response corresponds class number units stored DATA1.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"Returns proximities matrix two functional datasets.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"semimetric.deriv: approximates \\(L_2\\) metric derivatives curves based ther B-spline representation. derivatives set argument nderiv.semimetric.fourier: approximates \\(L_2\\) metric curves based ther B-spline representation. derivatives set argument nderiv.semimetric.hshift: computes distance curves taking account horizontal shift effect.semimetric.mplsr: computes distance curves based partial least squares method.semimetric.pca: computes distance curves based functional principal components analysis method. next semi-metric functions functional data \\(X\\) approximated \\(k_n\\) elements Fourier, B–spline, PC PLS basis using, \\(\\hat{X_i} =\\sum_{k=1}^{k_n}\\nu_{k,}\\xi_k\\), \\(\\nu_k\\) coefficient expansion basis function \\(\\left\\{\\xi_k\\right\\}_{k=1}^{\\infty}\\). distances q-order derivatives two curves \\(X_{1}\\) \\(X_2\\) , $$d_{2}^{(q)}\\left(X_1,X_2\\right)_{k_n}=\\sqrt{\\frac{1}{T}\\int_{T}\\left(X_{1}^{(q)}(t)-X_{2}^{(q)}(t)\\right)^2 dt}$$ \\(X_{}^{(q)}\\left(t\\right)\\) denot \\(q\\) derivative \\(X_i\\). semimetric.deriv semimetric.fourier function use B-spline Fourier approximation respectively curve derivatives directly computed differentiating several times analytic form, default q=1 q=0 respectively. semimetric.pca semimetric.mprls function compute proximities curves based functional principal components analysis (FPCA) functional partial least square analysis (FPLS), respectively. FPC FPLS reduce functional data reduced dimensional space (q components). semimetric.mprls function requires scalar response. $$d_{2}^{(q)}\\left(X_1,X_2\\right)_{k_n}\\approx\\sqrt{\\sum_{k=1}^{k_n}\\left(\\nu_{k,1}-\\nu_{k,2}\\right)^2\\left\\|\\xi_k^{(q)}\\right\\|dt}$$ semimetric.hshift computes proximities curves taking account horizontal shift effect. $$d_{hshift}\\left(X_1,X_2\\right)=\\min_{h\\\\left[-mh,mh\\right]}d_2(X_1(t),X_2(t+h))$$ \\(mh\\) maximum horizontal shifted allowed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"Ferraty, F. Vieu, P. (2006). Nonparametric functional data analysis. Springer Series Statistics, New York. Ferraty, F. Vieu, P. (2006). NPFDA practice.  Free access line https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/semimetric.NPFDA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Proximities between functional data (semi-metrics) — semimetric.NPFDA","text":"","code":"if (FALSE) { # \\dontrun{  #  INFERENCE PHONDAT data(phoneme) ind=1:100 # 2 groups mlearn<-phoneme$learn[ind,] mtest<-phoneme$test[ind,] n=nrow(mlearn[[\"data\"]]) np=ncol(mlearn[[\"data\"]]) mdist1=semimetric.pca(mlearn,mtest) mdist2=semimetric.pca(mlearn,mtest,q=2) mdist3=semimetric.deriv(mlearn,mtest,nderiv=0) mdist4=semimetric.fourier(mlearn,mtest,nderiv=2,nbasis=21) #uses hshift function #mdist5=semimetric.hshift(mlearn,mtest) #takes a lot glearn<-phoneme$classlearn[ind] #uses mplsr function mdist6=semimetric.mplsr(mlearn,mtest,5,glearn) mdist0=metric.lp(mlearn,mtest) b=as.dist(mdist6) c2=hclust(b) plot(c2) memb <- cutree(c2, k = 2) table(memb,phoneme$classlearn[ind])  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/subset.fdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsetting — subset.fdata","title":"Subsetting — subset.fdata","text":"Return subsets fdata meet conditions.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/subset.fdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsetting — subset.fdata","text":"","code":"# S3 method for class 'fdata' subset(x, subset, select, drop = TRUE, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/subset.fdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsetting — subset.fdata","text":"x object subsetted (fdata class). subset logical expression indicating elements rows keep. select logical expression indicating points columns keep. drop passed [ indexing operator. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/subset.fdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsetting — subset.fdata","text":"object similar x contain just selected elements.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizes information from kernel classification methods. — summary.classif","title":"Summarizes information from kernel classification methods. — summary.classif","text":"Summary function classif.knn classif.kernel.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizes information from kernel classification methods. — summary.classif","text":"","code":"# S3 method for class 'classif' summary(object, ...)  # S3 method for class 'classif' print(x, digits = max(3, getOption(\"digits\") - 3), ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizes information from kernel classification methods. — summary.classif","text":"object Estimated kernel classification. ... arguments passed methods. x Estimated kernel classification. digits many significant digits used numeric complex x.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarizes information from kernel classification methods. — summary.classif","text":"Shows: -Probability correct classification group prob.classification. -Confusion matrix theoretical groups estimated groups. -Highest probability correct classification max.prob. object returned function classif.knn -Vector probability correct classification number neighbors knn. -Optimal number neighbors: knn.opt. object returned function: classif.kernel -Vector probability correct classification banwidth h. -Functional measure closeness (optimal distance, h.opt).","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarizes information from kernel classification methods. — summary.classif","text":"object classif.knn classif.kernel","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarizes information from kernel classification methods. — summary.classif","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.classif.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizes information from kernel classification methods. — summary.classif","text":"","code":"if (FALSE) { # \\dontrun{  data(phoneme) mlearn<-phoneme[[\"learn\"]] glearn<-phoneme[[\"classlearn\"]] out=classif.knn(glearn,mlearn,knn=c(3,5,7)) summary(out) out2=classif.kernel(glearn,mlearn,h=2^(0:5)) summary(out2) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":null,"dir":"Reference","previous_headings":"","what":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"Summary functional principal components","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"","code":"# S3 method for class 'fdata.comp' summary(object, biplot = TRUE, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"object fdata.comp class object calculated : fdata2pc, fdata2pls, fregre.pc fregre.pls. biplot =TRUE draw biplot PC (PLS) components. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"corplot=TRUE, displaying biplot PC (PLS) components.  ask=TRUE, draw graph window, waiting confirm change page click mouse pressing ENTER.  ask=FALSE draw graphs one window.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"Becker, R. ., Chambers, J. M. Wilks, . R. (1988). New S Language. Wadsworth & Brooks/Cole. Venables, W. N. B. D. Ripley (2002). Modern Applied Statistics S. Springer-Verlag.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"Manuel Febrero-Bande Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fdata.comp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correlation for functional data by Principal Component Analysis — summary.fdata.comp","text":"","code":"if (FALSE) { # \\dontrun{ library(fda.usc) n <- 200 tt <- seq(0,1,len=101) x0 <- rproc2fdata(n,tt,sigma=\"wiener\") x1 <- rproc2fdata(n,tt,sigma=0.1) x <- x0*3+x1 beta <- tt*sin(2*pi*tt)^2 fbeta <- fdata(beta,tt) pc1 <- fdata2pc(x,3) summary.fdata.comp(pc1) y <- inprod.fdata(x,fbeta) #+ rnorm(n,sd=0.1) pls1 <- fdata2pls(x,y,2) summary(pls1) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizes information from fregre.fd objects. — summary.fregre.fd","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"Summary function fregre.pc, fregre.basis, fregre.pls, fregre.np fregre.plm functions. Shows: fregre.fd object comes fregre.pc shows: draw=TRUE plot: ask=FALSE draw graphs one window, default. ask=TRUE, draw graph window, waiting confirm.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"","code":"# S3 method for class 'fregre.fd' summary(object, times.influ = 3, times.sigma = 3, draw = TRUE, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"object Estimated functional regression, fregre.fd object. times.influ Limit detect possible infuence curves. times.sigma Limit detect possible oultiers atypical curves. draw =TRUE draw estimation residuals graphics. ... arguments passed methods.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"Influence: Vector influence measures. .influence: Index possible influence curves. .atypical: Index possible atypical curves possible outliers.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"Manuel Febrero-Bande Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizes information from fregre.fd objects. — summary.fregre.fd","text":"","code":"if (FALSE) { # \\dontrun{ # Ex 1. Simulated data n= 200;tt= seq(0,1,len=101) x0<-rproc2fdata(n,tt,sigma=\"wiener\") x1<-rproc2fdata(n,tt,sigma=0.1) x<-x0*3+x1 beta = tt*sin(2*pi*tt)^2 fbeta = fdata(beta,tt) y<-inprod.fdata(x,fbeta)+rnorm(n,sd=0.1)  # Functional regression res=fregre.pc(x,y,l=c(1:5)) summary(res,3,ask=TRUE)  res2=fregre.pls(x,y,l=c(1:4)) summary(res2)  res3=fregre.pls(x,y) summary(res3) } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.gkam.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","title":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","text":"Summary function fregre.gkam function. Produces list summary information fitted fregre.np object functional covariate. draw=TRUE plot: ask=FALSE draw graphs one window, default. ask=TRUE, draw graph window, waiting confirm.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.gkam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","text":"","code":"# S3 method for class 'fregre.gkam' summary(object, draw = TRUE, selec = NULL, times.influ = 3, ...)"},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.gkam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","text":"object Estimated functional regression, fregre.fd object. draw =TRUE draw estimation residuals graphics. selec Allows plot single model term selected printing. e.g. just want plot second smooth term set selec=2.  . times.influ Limit detect possible infuence curves. ... arguments passed methods.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.gkam.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","text":"Manuel Febrero-Bande Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/summary.fregre.gkam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizes information from fregre.gkam objects. — summary.fregre.gkam","text":"","code":"if (FALSE) { # \\dontrun{ # Time consuming data(tecator) ind<-1:129 ab=tecator$absorp.fdata[ind] ab2=fdata.deriv(ab,2) yfat=as.integer(cut(tecator$y[ind,\"Fat\"],c(0,15,100)))-1 xlist=list(\"df\"=data.frame(yfat),\"ab2\"=ab2,\"ab\"=ab) f<-yfat~ab+ab2 res=fregre.gkam(f, data = xlist, family = binomial(\"logit\"),                 control = list(maxit = 2)) summary(res)  } # }"},{"path":"https://moviedo5.github.io/fda.usc/reference/tecator.html","id":null,"dir":"Reference","previous_headings":"","what":"tecator data — tecator","title":"tecator data — tecator","text":"Water, Fat Protein content meat samples","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/tecator.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"tecator data — tecator","text":"format : ..$absorp.fdata: absorbance data. fdata class object : \"data\": Matrix class fdata 215 curves (rows) discretized 100 points argvals (columns). \"argvals\": 100 discretization points 850 1050nm \"rangeval\"=(850,1050): range(\"argvals\") \"names\" list : main overall title \"Tecator data set\", xlab title x axis \"Wavelength (nm)\" ylab title y axis \"Absorbances\". ..$y: percentages Fat, Water Protein.  three contents determined analytic chemistry.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/tecator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"tecator data — tecator","text":"absorp.fdata absorbance data 215 samples. first 129 originally used training set endpoints percentages Fat, Water Protein. details see tecator package","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/tecator.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tecator data — tecator","text":"Manuel Febrero-Bande Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/tecator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"tecator data — tecator","text":"","code":"data(tecator) names(tecator) #> [1] \"absorp.fdata\" \"y\"            names(tecator$absorp.fdata) #> [1] \"data\"     \"argvals\"  \"rangeval\" \"names\"    names(tecator$y) #> [1] \"Fat\"     \"Water\"   \"Protein\" names(tecator$y) #> [1] \"Fat\"     \"Water\"   \"Protein\" class(tecator$absorp.fdata) #> [1] \"fdata\" class(tecator$y) #> [1] \"data.frame\" dim(tecator$absorp.fdata) #> [1] 215 100 dim(tecator$y) #> [1] 215   3"},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling Variance estimates — Var.y","title":"Sampling Variance estimates — Var.y","text":"Sampling variance error variance estimates regression estimates.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling Variance estimates — Var.y","text":"","code":"Var.y(y, S, Var.e = NULL)"},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling Variance estimates — Var.y","text":"y fdata class object. S Smoothing matrix calculated S.basis S.NW functions. Var.e Error Variance Estimates. Var.e=NULL, Var.e calculated.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling Variance estimates — Var.y","text":"Var.y: returns sampling variance functional data. Var.e: returns sampling error variance functional data.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sampling Variance estimates — Var.y","text":"Ramsay, James O., Silverman, Bernard W. (2006),  Functional Data Analysis, 2nd ed., Springer, New York.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sampling Variance estimates — Var.y","text":"Manuel Febrero-Bande, Manuel Oviedo de la Fuente manuel.oviedo@udc.es","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/Var.y.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling Variance estimates — Var.y","text":"","code":"a1<-seq(0,1,by=.01) a2=rnorm(length(a1),sd=0.2) f1<-(sin(2*pi*a1))+rnorm(length(a1),sd=0.2) nc<-50 np<-length(f1) tt=1:101 mdata<-matrix(NA,ncol=np,nrow=nc) for (i in 1:nc) mdata[i,]<- (sin(2*pi*a1))+rnorm(length(a1),sd=0.2) mdata<-fdata(mdata,tt) S=S.NW(tt,h=0.15) var.e<-Var.e(mdata,S) var.y<-Var.y(mdata,S) var.y2<-Var.y(mdata,S,var.e) #the same"},{"path":"https://moviedo5.github.io/fda.usc/reference/weights4class.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighting tools — weights4class","title":"Weighting tools — weights4class","text":"computes inverse probability weighting.","code":""},{"path":"https://moviedo5.github.io/fda.usc/reference/weights4class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighting tools — weights4class","text":"","code":"weights4class(x, type = c(\"equal\", \"inverse\"))"},{"path":"https://moviedo5.github.io/fda.usc/reference/weights4class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighting tools — weights4class","text":"x vector labels, true class observed response. Can numeric, character, factor type Type weights.","code":""},{"path":[]},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-220","dir":"Changelog","previous_headings":"","what":"fda.usc 2.2.0","title":"fda.usc 2.2.0","text":"Modification several Rd fiels: Lost braces itemize. classif.DD.aux.r, solve.ab renamed solve_ab. classif.kfold.R, .vars1 renamed all_vars1. kmeans.fd.dist.R, predict.kmeans.fd renamed predict_kmeans.fd. kmeans.fd.R, kmeans.assig.groups renamed kmeans_assig_groups. kmeans.fd.R, kmeans.centers.update renamed kmeans_centers_update. kmeans.assig.groups.R, kmeans.assig.groups renamed kmeans_assig_groups. kmeans.assig.groups.R, kmeans.assig.groups renamed kmeans_assig_groups. plot.fdata.R, image.scale renamed image_scale. predict.gls.nlme.r, predict.gls renamed predict_gls. predict.gls.nlme.r, predict.mregre renamed predict_._mregre. predict.mfregre.r, predict.gls renamed predict_gls. quantile.outliers.pond.r, quantile_outliers.pond renamed quantile_outliers_pond. quantile.outliers.trim.r, quantile_outliers.trim renamed quantile_outliers_trim. export plot.lfdata function","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-210","dir":"Changelog","previous_headings":"","what":"fda.usc 2.1.0","title":"fda.usc 2.1.0","text":"fda.usc 2.1.0 major release several new feature fixed bugs. fdata2basis() always return centred fdataobj mean. mean computed using basis. New funtions: fEqMoments.test(), fmean.test.fdata(), cov.test.fdata() checking equality means /covariance two populations gaussianity. New funtions: fEqDistrib.test(), XYRP.test(), MMD.test(), MMDA.test(), fEqDistrib.test() checking equality distributions two functional populations. wavelength units Tecator dataset labeled nm dataset description, nm original description. (bug detected vnmabus)","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-203","dir":"Changelog","previous_headings":"","what":"fda.usc 2.0.3","title":"fda.usc 2.0.3","text":"Several changes summary.fdata.comp() Now, uses data.matrix (instead .matrix) convert data.table matrix class object, option recommended data.frame contains characters. classif.cv.glmnet() classif.gbm(), functional basis classsification using cv.glmnet(), require glmnet package, gbm(), require gbm package. h.default(), new argument ‘Ker’ mfdata(), new class object multivariate functional data fregre.basis.cv(), fregre.basis.cv() fregre.pc() return df.residual object Bug corrected S.LPR() S.LLR() classif.gsam.vs, new function variable selection additive classifier fdata2basis() used fregre.lm() predict.fregre.lm() summary fdata2basis()","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-202","dir":"Changelog","previous_headings":"","what":"fda.usc 2.0.2","title":"fda.usc 2.0.2","text":"fdata.bootstrap() fregre.bootstrap() functions addapted parallel backend. Corrected bug kmeans.fd() function. Bug corrected predict.fregre.glm(), predict.fregre.lm() predict.gsam(), now works type=“effects”. “main”, “xlab” “ylab” arguments can used plot.bifd() function. plot.ldata() draws curve according factor indicated argument “var.name”. Minor changes ldata(), “na.rm = T” removed sweep function. documentation argument ‘…’ included “usage” deleted. Modification internal function wmestadis() used fanova.onefactor(), now replicates statistic defined Cuevas, 2004. Deleted arguments “y” “corplot” summary.fdata.comp() function. Deleted dev.new() code summary.fdata.comp() function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-201","dir":"Changelog","previous_headings":"","what":"fda.usc 2.0.1","title":"fda.usc 2.0.1","text":"Modification fdata() function avoid class()== class()!= instead use (), kmeans.fd() function: “par.ini” argument depreciated, user can use “method” argument. “cluster.size” argument added. New internal function predict.kmeans.fd. Bug corrected internal function pred2glm2boost(), used predictions classiff.DD() outputs New functions: Ops.ldata(), Math.ldata(), Summary.ldata(), mean.ldata() mean.fdata() (deprecated ldata.mean(), mfdata.mean()) Modifications ldata.cen() bug S.LPR() fixed. bug internal function wmestadis() used fanova.onefactor() fixed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-200","dir":"Changelog","previous_headings":"","what":"fda.usc 2.0.0","title":"fda.usc 2.0.0","text":"Version 2.0.0 major release several new features, including: inprod.fdata() metric.lp funcitons addapted parallel backend. zzz.R file includes .onAttach() function (welcome package message) ops.fda.usc.R file includes ops.fda.usc() function control general parameters packages ncores argument. par.fda.usc.R file deleted: par.fda.usc now internal object created modified ops.fda.usc() New function metric.DTW() computes distances functional data using dynamic time warping (DTW) metric.WDTW() metric.TWED() extended version (parallelized yet, pending completed Rd document) New functions S.LPR() S.LCR() computing smoothing matrix S nonparametric method. functions anova.hetero(), anova.onefactor(), anova.RPm(), influence.fdata(), influence.quan(), min.basis(), min.np() unlist.fdata() renamed fanova.hetero(), fanova.onefactor(), fanova.RPm(), influence.fregre.fd(), influence_quan(), optim.basis(), optim.np() unlist_fdata() optim.np() (deprecated min.np()) allows Local polynomial regression correlated errors using new parameter (correl=TRUE) Kernel.correlated() new functions New class: “ldata”: ldata() class definition. Redefined metric.ldata(), computes distance ldata object: list m functional data mfdata() univariate data included data frame called “df” New function metric.mfdata(): compute distance mfdata class object: list m functional data plot.ldata(): plots ldata object, allows drawing using color bar. plot.mfdata(): plot formfdata object (internal function, pending completed Rd document) depth.modep(), depth.mode() call metric.lp() metric.ldata() propperly New functions: subset.ldata(), .lfdata(), [.lfdata(), [.ldata, .ldata(), names.ldata() c.ldata() classic.tree() replaced classic.rpart() (requires rpart library installed). internal function classif.tree2boost() dependency rpart package also removed New functions utilities accuracy.r file. New functions related Machine Learning procedures (rdepend packages included “fda.usc”): classif.svm() classif.naiveBayes() (e1071 pkg), classif.ksvm() (personalized pkg), classif.rpart() (rpart pkg), classif.nnet() (nnet pkg), classif.multinom() (nnet pkg), classif.randomForest() (randomForest) clasiff.univariante() used classif.DD allow multiclass labels classif.kfold() selects parameters using k-fold cross-validation Minor changes classif.gkam() fregre.gkam() Settings fregre.np(), fregre.np.cv() type.S = S.KNN New script file: FDA_REviewClasif_V2 classification example Bug corrected h.default() (specially using k-nearest neighbors smoothing, type.S=“S.KNN”) “type.CV” “par.CV()” arguments removed classif.np(), classif.kernel() classif.knn() dcor.xy.r/.Rd includes Rdnames fdata2model.R shortcut use classif fregre method","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-150","dir":"Changelog","previous_headings":"","what":"fda.usc 1.5.0","title":"fda.usc 1.5.0","text":"version released Jan. 2019 accompany Manuel Oviedo de la Fuente PhD Thesis, see Minerva (University Santiago de Compostela) repository. New function implemented: fregre.gsam.vs() accompany paper: Febrero-Bande, M., Gonz'{}lez-Manteiga, W. Oviedo de la Fuente, M. Variable selection functional additive regression models, (2018). Computational Statistics, 1-19. DOI: 10.1007/s00180-018-0844-5 current function fregre.basis.cv() returns object called fregre.basis (output fregre.basis() function used) uses selected parameters according indicated criteria (see example ). previous function version (version 1.5.0) renamed function “fregre.basis.cv.old”. marked deprecated current version deleted next version package, thanks Beatriz Bueno. New functions: plot.fregre.lm summary.fregre.lm() solve errors summary fregre.lm() function, thanks Prof. Andros Kourtellos. bug fregre.pc() fixed (thanks Prof. Eduardo Garcia-Portugues).","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-140","dir":"Changelog","previous_headings":"","what":"fda.usc 1.4.0","title":"fda.usc 1.4.0","text":"published December 2017 accompany document: Ordonez, C., Oviedo de la Fuente, M., Roca-Pardinas, J., Rodriguez-Perez, J. R. (2017). Determining optimum wavelengths leaf water content estimation reflectance: distance correlation approach. , (2018) 173,41-50 DOI: 10.1016/j.chemolab.2017.12.001. New functions implemented: LMDC.select() LMDC.regression(). Oviedo de la Fuente M, Febrero-Bande M, Muñoz MP, Domínguez À (2018) Predicting seasonal influenza transmission using functional regression models temporal dependence. PLoS ONE 13(4): e0194250. DOI: 10.1371/journal.pone.0194250 functions fregre.gls fregre.igls implement functional linear model dependent errors (functional GLs functional iterative GLS respectively). “fda.usc/inst/script/” folder contains code reproduces results paper (see scripts whose prefix “PLOS”). package version also companion paper: “Goodness--fit tests functional linear model based randomly projected empirical processes” Cuesta-Albertos et al., 2017). package implements goodness--fit tests functional linear model scalar response. bug functional derivative raw derivation (function fdata.deriv() method=“diff”) fixed, thanks Marcos Matabuena. bug classif.knn() predict.classif() fixed, thanks Ricardo Recarey. bug CV.S() function fixed, thanks Miquel Carbajo. bug anova.hetero() fixed, thanks Beatriz Bueno.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-130","dir":"Changelog","previous_headings":"","what":"fda.usc 1.3.0","title":"fda.usc 1.3.0","text":"Beta version functions Fit Functional Linear Model Using Generalized Least Squares: fregre.gls(), fregre.igls(), GCCV.S(), predict.fregre.gls() predict.fregre.igls(). Internal function “auxiliar”, “corSigma()”, “corStruct()”. functionality functions “+.fdata()”, “-.fdata()”, “*.fdata()” “/.fdata” improved. S3 functions fdata class calculations: .na.fdata() anyNA.fdata. Function “count.na.fdata()” returns vector number “NA” curve. Internal function “count.na” deprecated. fdata function converts “xtab” “ftable” class object “fdata” class object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-123","dir":"Changelog","previous_headings":"","what":"fda.usc 1.2.3","title":"fda.usc 1.2.3","text":"Modification classif.DD() function DDk classifier. New functions length.fdata(), NROW.fdata(), NCOL.fdata(), gridfdata() rcombfdata(). depth.KFSD() function implements depth measure based Kernelized Functional Spatial Depth.depth.FSD() function implements depth measure based Functional Spatial Depth. bug fregre.pc() function fixed. bug depth.RPD() function fixed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-122","dir":"Changelog","previous_headings":"","what":"fda.usc 1.2.2","title":"fda.usc 1.2.2","text":"Warning message fregre.basis.cv(), fregre.pc.cv() fregre.pls.cv(), fregre.basis(), fregre.pc() fregre.pls() functions system computationally singular. bug predict.classif() function using fitted object classif.knn() fixed. argument “trim” modified 0.1 0.25 function quantile.outliers.trim internal distance functions: euclidean, manhattan, minkowski maximum allow vector weights. classif.DD() function, polynomial classifier (“DD1”, “DD2” “DD3”) uses original procedure proposed Li et al. (2012), rotating DD-plot (exchange abscise ordinate). procedure extend multi-class problems incorporating method majority voting case polynomial classifier method One vs Rest logistic case (“glm” “gam”). fregre.gkam() function considers functional covariates (implemented non-functional covariates). depth.FM() function renamed argument “dfunc” “dfunc2”. subset.fdata() wrapper function subset function.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-121","dir":"Changelog","previous_headings":"","what":"fda.usc 1.2.1","title":"fda.usc 1.2.1","text":"functions dcor.xy, dcor.test(), bcdcor.dist() dcor.dist() (wrapper function energy package) added. fregre.gsam() function can used without smoothed vairables. bug “selec” argument summary.fregre.gkam() fixed. bug “h” argument fregre.plm() fixed. bug sigma=“vexponential” rproc2fdata() fixed. default values depth.RPp, depth.RP rproc2fdata() modified. classif.DD() function uses bandwidth “h” k groups modal depth projections “proj” k groups RP depth. bug predict.fregre.gsam() PLS previously estimated using norm=TRUE fixed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-120","dir":"Changelog","previous_headings":"","what":"fda.usc 1.2.0","title":"fda.usc 1.2.0","text":"New functions: classif.DD(), fits Nonparametric Classification Procedure Based DD-plot (depth-versus-depth plot) G groups. depth.FMp(), depth.modep depth.RPp() functions provide depth measure list p–functional data objects. metric.ldata(), computes distance list p–functional data objects. metric.hausdorff(), computes hausdorff distance. Multivariate depth functions renamed: “depth.” “mdepth.”.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-110","dir":"Changelog","previous_headings":"","what":"fda.usc 1.1.0","title":"fda.usc 1.1.0","text":"New functions: fregre.basis.fr() fits functional response model. metric.kl() computes Kullback–Leibler distance. anova.onefactor(): tests one–way anova model functional data. split.fdata(), unlist.fdata(): wrapper functions split unlist function functional data. func.mean.formula() computes mean curve level grouping variable. New dataset: Mithochondiral calcium overload (MCO) data set. New utilities: fdata() converts arrays 3 dimension functional data 2 dimension plot.fdata() allows functional data 2 dimension. functions fdata2ppc(), fdata2ppls(), fregre.ppc(), fregre.ppls(), fregre.ppc.cv(), fregre.ppls.cv() deprecated favor fdata2pc(), fdata2pls(), fregre.pc(), fregre.pc.cv(), fregre.pls(), fregre.pls.cv(). latter functions include penalty arguments.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-105","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.5","title":"fda.usc 1.0.5","text":"“pls” package dependency removed. bug outlier.ltr() function fixed case rownames (fdata) can converted numeric values. bug fregre.lm() function fixed case one covariates factor penalization argument required (rn lambda greater zero). new argument “lambda” fregre.lm() penalizes derivative second order functional data. New arguments predict.fregre.fd() predict.fregre.lm() produce confidence prediction intervals specified level mimicking predict.lm(). New argument “verbose” min.basis(), min.np() rproc2fdata(). argument “mu” rproc2fdata() allows vector also fdata class object.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-104","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.4","title":"fda.usc 1.0.4","text":"bug fregre.pls() function fixed case FPLS basis created argument norm TRUE (curves centred scaled). bug outliers.depth.trim() function fixed case procedure requires one iteration step.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-103","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.3","title":"fda.usc 1.0.3","text":"version introduces new function classif.depth() fits nonparametric classification procedure based maximum depth measure. Penalized FPC FPLS basis computed create.pc.basis() create.pls.basis() new arguments “lambda” “P”. bug predict.fregre.fd() function fixed (case “object” fitted using funtional partial least square basis).","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-102","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.2","title":"fda.usc 1.0.2","text":"Release 1.0.2 introduces new functions: New argument “se.fit” predict.fregre.fd() predict.fregre.lm() function. bug CV.S() function “y” argument fdata object fixed. “bug” involved min.np() function. metric.lp() function NA values returned, fdata NA’s values. metric.lp() function supremum distance computed, “lp” argument 0.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-101","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.1","title":"fda.usc 1.0.1","text":"New functions: New depth functions corresponding shortcut functions (see help(Descriptive) form details): depth.SD() provides simplicial depth measure bivariate data. depth.PD() provides depth measure using random projections multivariate data. depth.MhD() provides Mahalanobis depth measure multivariate data. depth.HD() provides half-space depth measure multivariate data. introduces new functions functional PC PLS regression: fregre.ppc, fregre.ppls, fregre.ppc.cv, fregre.ppls.cv, auxiliary functions: fdata2ppc, fdata2ppls, P.penalty. function rber.gold() renamed rwild() function. ow, rwild() contructs Wild bootstrap residuals. order.fdata() wrapper function order function. New arguments options: New arguments “wild” “type.wild” fregre.bootstrap().  fregre.glm(), fregre.gsam(), classif.glm2boost(), classif.gsam2boost() “fdataobj” argument allows multivariate data functional data. * fregre.lm() allows penalization “rn” parameter (ridge regression). * fregre.pc() fregre.basis() allow weighted least squares “weights” argument. Correction bugs: bug “draw” argument fdata.bootstrap() fixed. bug predict.classif() function ussing fitted object classif.knn() fixed. bug create.pc.basis() function “l” argument length 1 fixed. “bug” involved following functions: fregre.lm(), fregre.glm() fregre.gsam().","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-100","dir":"Changelog","previous_headings":"","what":"fda.usc 1.0.0","title":"fda.usc 1.0.0","text":"Release 1.0.0 released Oct. 2012 working version accompany ’Febrero-Bande, M. Oviedo de la Fuente, M. (2012). ’Statistical Computing Functional Data Analysis: R Package fda.usc. Journal Statistical Software, 51(4), 1-28., URL https://www.jstatsoft.org/article/view/v051i04 New functions added: depth.RT() implements random Tukey depth (RT) corresponding shortcut functions. metric.dist() methods wrappers dist(), New arguments depth.FM(), depth.RP(), depth.mode() fdata(). functions: fregre.glm(), fregre.gsam(), fregre.gkam(), classif.np(), classif.glm(), classi.glm() allow functional multivariate analysis.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-0981","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.8.1","title":"fda.usc 0.9.8.1","text":"Release 0.9.8.1 introduces new functions flm.Ftest() dfv.test(). first performs functional F-test second implements test Delsol, Ferraty Vieu (2010). Function flm.test() now better computational performance function Aijr() replaced Adot(). New argument “lambda” fdata2fd() function. New argument “rn” create.pc.basis() function. fregre.kgam() renamed fregre.gkam().","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-098","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.8","title":"fda.usc 0.9.8","text":"Release 0.9.8 introduces new function flm.test() allows test Functional Linear Model scalar response given dataset. based new functions PCvM.statistic(), Aijr() rber.gold(). bug fregre.kgam() fixed.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-097","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.7","title":"fda.usc 0.9.7","text":"New functions: fregre.kgam(), classif.kgam(), dev.S(), predict.fregre.kgam(), print.fregre.kgam(), summary.fregre.kgam(), fregre.gsam(), classif.np(), classif.kgam(), classif.gsam(). New argument “par.S” : fregre.np(), fregre.np.cv(), fregre.plm(), S.NW(), S.KNN(), S.LLR(). New attributes : metric.lp(), semimetric.basis() semimetric.NPFDA()","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-096","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.6","title":"fda.usc 0.9.6","text":"Release 0.9.6 renames functions: pc.fdata()–>fdata2pc() pls.fdata()–>fdata2pls() pc.cor()–>summary.fdata.comp() pc.fdata()–>summary.fdata.comp() added create.pls.basis(), Math.fdata(), Ops.fdata(), Summary.fdata() dis.cos.cor() function. New argument par.S : fregre.np(), fregre.np.cv(), fregre.plm(), New argument cv : S.NW(), S.KNN(), S.LLR() metric.lp() argument p now called lp.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-095","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.5","title":"fda.usc 0.9.5","text":"Release 0.9.5 improves fdata.bootstrap() function (better computational efficiency). introduces new functions: Partial Linear Square (pls.fdata(), fregre.pls() fregre.pls.cv()) Simpson integration (int.simpson() int.simpson2()). modifies functions metric.lp(), inprod.fdata(), summary.fregre.fd() predict.fregre.fd().","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-094","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9.4","title":"fda.usc 0.9.4","text":"Release 0.9.4 added 3 script files: Outliers_fdata.R, flm_beta_estimation_brownian_data.R Classif_phoneme.R. introduced functions fregre.glm() predict.fregre.glm() allow fit predict respectively Functional Generalized Linear Models. introduced functions create.pc.basis create.fdata.basis() allow create basis objects functional data class “fdata”.","code":""},{"path":"https://moviedo5.github.io/fda.usc/news/index.html","id":"fdausc-09","dir":"Changelog","previous_headings":"","what":"fda.usc 0.9","title":"fda.usc 0.9","text":"Release 0.9 introduces new function h.default() simplifies calculation bandwidth parameter “h” functions: fregre.np(), fregre.np.cv() fregre.plm(). functions added stop control dataset missing data (NA’s). adds attribute “call” distance matrix calculated metric.lp(), semimetric.basis() semimetric.NPFDA() functions.","code":""}]
